!function(t){function webpackJsonpCallback(r){for(var a,u,l=r[0],c=r[1],h=r[2],p=0,d=[];p<l.length;p++)u=l[p],Object.prototype.hasOwnProperty.call(i,u)&&i[u]&&d.push(i[u][0]),i[u]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);for(_&&_(r);d.length;)d.shift()();return o.push.apply(o,h||[]),checkDeferredModules()}function checkDeferredModules(){for(var t,r=0;r<o.length;r++){for(var a=o[r],u=!0,l=1;l<a.length;l++){var _=a[l];0!==i[_]&&(u=!1)}u&&(o.splice(r--,1),t=__webpack_require__(__webpack_require__.s=a[0]))}return t}var r={},i={1:0},o=[];function __webpack_require__(i){if(r[i])return r[i].exports;var o=r[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,__webpack_require__),o.l=!0,o.exports}__webpack_require__.m=t,__webpack_require__.c=r,__webpack_require__.d=function(t,r,i){__webpack_require__.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:i})},__webpack_require__.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__.t=function(t,r){if(1&r&&(t=__webpack_require__(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(__webpack_require__.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var o in t)__webpack_require__.d(i,o,function(r){return t[r]}.bind(null,o));return i},__webpack_require__.n=function(t){var r=t&&t.__esModule?function getDefault(){return t.default}:function getModuleExports(){return t};return __webpack_require__.d(r,"a",r),r},__webpack_require__.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},__webpack_require__.p="";var a=window.webpackJsonp=window.webpackJsonp||[],u=a.push.bind(a);a.push=webpackJsonpCallback,a=a.slice();for(var l=0;l<a.length;l++)webpackJsonpCallback(a[l]);var _=u;o.push([0,3]),checkDeferredModules()}({"./src/app.js":function(t,r,i){"use strict";i.r(r);i("./src/scss/osweb.scss"),i("./node_modules/core-js/modules/es.array.concat.js"),i("./node_modules/core-js/modules/es.array.slice.js"),i("./node_modules/core-js/modules/es.regexp.constructor.js"),i("./node_modules/core-js/modules/es.regexp.exec.js"),i("./node_modules/core-js/modules/es.regexp.to-string.js"),i("./node_modules/core-js/modules/es.string.replace.js"),i("./node_modules/core-js/modules/es.function.name.js");var o=i("./node_modules/@babel/runtime/regenerator/index.js"),a=i.n(o),u=(i("./node_modules/regenerator-runtime/runtime.js"),i("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),l=i.n(u),_=i("./node_modules/@babel/runtime/helpers/classCallCheck.js"),c=i.n(_),h=i("./node_modules/@babel/runtime/helpers/createClass.js"),p=i.n(h),d=i("./node_modules/pixi.js/lib/pixi.es.js"),m=(i("./node_modules/core-js/modules/es.symbol.js"),i("./node_modules/core-js/modules/es.symbol.description.js"),i("./node_modules/core-js/modules/es.array.includes.js"),i("./node_modules/core-js/modules/es.array.iterator.js"),i("./node_modules/core-js/modules/es.array.map.js"),i("./node_modules/core-js/modules/es.array.reduce.js"),i("./node_modules/core-js/modules/es.array.splice.js"),i("./node_modules/core-js/modules/es.number.constructor.js"),i("./node_modules/core-js/modules/es.object.to-string.js"),i("./node_modules/core-js/modules/es.reflect.construct.js"),i("./node_modules/core-js/modules/es.string.ends-with.js"),i("./node_modules/core-js/modules/es.string.repeat.js"),i("./node_modules/core-js/modules/es.string.split.js"),i("./node_modules/core-js/modules/web.dom-collections.iterator.js"),i("./node_modules/@babel/runtime/helpers/slicedToArray.js")),v=i.n(m),y=i("./node_modules/@babel/runtime/helpers/typeof.js"),g=i.n(y),b=i("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),k=i.n(b),x=i("./node_modules/@babel/runtime/helpers/toArray.js"),w=i.n(x),S=i("./node_modules/@babel/runtime/helpers/get.js"),E=i.n(S),R=i("./node_modules/@babel/runtime/helpers/inherits.js"),j=i.n(R),T=i("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),C=i.n(T),I=i("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),O=i.n(I),A=i("./node_modules/lodash/sortBy.js"),M=i.n(A),P=i("./node_modules/lodash/shuffle.js"),D=i.n(P),L=i("./node_modules/lodash/isArray.js"),N=i.n(L),U=i("./node_modules/lodash/isNumber.js"),H=i.n(U);i("./node_modules/core-js/modules/es.string.trim.js"),i("./node_modules/core-js/modules/es.symbol.iterator.js"),i("./node_modules/core-js/modules/es.array.from.js"),i("./node_modules/core-js/modules/es.string.includes.js"),i("./node_modules/core-js/modules/es.string.iterator.js");function _createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function _unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return _arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _arrayLikeToArray(t,r)}(t))){var r=0,i=function F(){};return{s:i,n:function n(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,u=!0,l=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return u=t.done,t},e:function e(t){l=!0,a=t},f:function f(){try{u||null==o.return||o.return()}finally{if(l)throw a}}}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var B=function(){function VarStore(t,r){c()(this,VarStore),this._item=t,this._parent=r,this._ignored_properties=["_item","_parent","_bypass_proxy","_ignored_properties"]}return p()(VarStore,[{key:"get",value:function get(t,r,i,o,a){r=void 0===r?null:r,i=void 0===i||i,o=void 0===o?null:o;var u=null;return t in this&&(this._bypass_proxy=!0,u="string"==typeof this[t]&&!0===i?this._item.syntax.eval_text(this[t],null,a):this[t],this._bypass_proxy=!1),null==u&&this._parent&&t in this._parent&&(this._parent._bypass_proxy=!0,u="string"==typeof this._parent[t]&&!0===i?this._item.syntax.eval_text(this._parent[t],null,a):this._parent[t],this._parent._bypass_proxy=!1),u}},{key:"has",value:function has(t){return this.inspect().includes(t)}},{key:"inspect",value:function inspect(){var t=[];for(var r in this)this._ignored_properties.includes(r)||t.push(r);return t}},{key:"items",value:function items(){var t,r={},i=_createForOfIteratorHelper(this.inspect());try{for(i.s();!(t=i.n()).done;){var o=t.value;r[o]=this[o]}}catch(t){i.e(t)}finally{i.f()}return r}},{key:"set",value:function set(t,r){this[t]=r}},{key:"unset",value:function unset(t){!0===this.has(t)&&delete this[t]}},{key:"vars",value:function vars(){return this.inspect()}},{key:"clear",value:function clear(t){t=void 0===t?[]:t;var r,i=_createForOfIteratorHelper(this.inspect());try{for(i.s();!(r=i.n()).done;){var o=r.value;t.includes(o)||this.unset(o)}}catch(t){i.e(t)}finally{i.f()}}}]),VarStore}(),z=function(){function Clock(t){c()(this,Clock),this._experiment=t,this._startTime=-1}return p()(Clock,[{key:"_initialize",value:function _initialize(){this._startTime=this._now()}},{key:"_now",value:function _now(){return window.performance.now?Math.round(window.performance.now()):window.performance.webkitNow?Math.round(window.performance.webkitNow()):(new Date).getTime()}},{key:"sleep",value:function sleep(t){null!==this._experiment&&this._experiment._runner._events._run(t,Xe.RESPONSE_DURATION,null)}},{key:"time",value:function time(){return-1!==this._startTime?this._now()-this._startTime:0}}]),Clock}(),K=function(){function Item(t,r,i){c()(this,Item),this._parent=null,this._runner="Runner"===t.constructor.name?t:t._runner,this._status=Xe.STATUS_NONE,this.clock="Runner"===t.constructor.name?new z(this):t.clock,this.count=0,this.experiment="Runner"===t.constructor.name?this:t,this.name=r,this.python_workspace=this._runner._pythonWorkspace,this.response_store=this._runner._responseStore,this.syntax=this._runner._syntax,this.vars=new B(this,"Runner"===t.constructor.name?null:this.experiment.vars)}return p()(Item,[{key:"_complete",value:function _complete(){this._status=Xe.STATUS_FINALIZE,null!==this._parent&&this._runner._events._currentItem&&(this._runner._events._currentItem=this._parent,this._runner._events._currentItem.run())}},{key:"_prepare_complete",value:function _prepare_complete(){}},{key:"_update",value:function _update(t){}},{key:"sleep",value:function sleep(t){this.clock.sleep(t)}},{key:"time",value:function time(){return this.clock.time()}},{key:"parse_comment",value:function parse_comment(t){return(t=t.trim()).length>0&&"#"===t.charAt(0)?(this.comments.push(t.slice(1)),!0):t.length>1&&"/"===t.charAt(0)&&(this.comments.push(t.slice(2)),!0)}},{key:"parse_keyword",value:function parse_keyword(t,r,i){}},{key:"parse_line",value:function parse_line(t){}},{key:"parse_variable",value:function parse_variable(t){if(this.parse_comment(t))return!0;var r=this._runner._syntax.parse_cmd(t),i=v()(r,3),o=i[0],a=i[1];i[2];return"set"===o&&(2===a.length?(this.vars.set(a[0],a[1]),!0):void this._runner._debugger.addError("Failed to parse definition: "+t))}},{key:"parse_multiline_vars",value:function parse_multiline_vars(t){var r=this.syntax.parse_multiline_vars(t);for(var i in r)this.vars.set(i,r[i])}},{key:"from_string",value:function from_string(t){if(this.variables={},this.comments=[],this.reset(),null!==t){this.parse_multiline_vars(t);for(var r=t.split("\n"),i=0;i<r.length;i++)""!==r[i]&&!1===this.parse_variable(r[i])&&this.parse_line(r[i])}}},{key:"reset",value:function reset(){}},{key:"prepare",value:function prepare(){this.experiment.vars.set("count_"+this.name,this.count),this.count++,this._status=Xe.STATUS_INITIALIZE,this._runner._debugger.addMessage("prepare "+this.name),"sequence"===this.type&&"sequence"===this._parent.type||null!==this._parent&&"feedback"!==this.type&&this._parent._prepare_complete()}},{key:"set_item_onset",value:function set_item_onset(t){t=void 0===t?this.clock.time():t,this.experiment.vars.set("time_"+this.name,t)}},{key:"run",value:function run(){this._runner._debugger.addMessage("run "+this.name)}}]),Item}(),W=(i("./node_modules/core-js/modules/es.array.filter.js"),i("./node_modules/core-js/modules/es.array.for-each.js"),i("./node_modules/core-js/modules/es.array.sort.js"),i("./node_modules/core-js/modules/es.object.entries.js"),i("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),i("./node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),i("./node_modules/core-js/modules/es.object.keys.js"),i("./node_modules/core-js/modules/es.object.values.js"),i("./node_modules/core-js/modules/web.dom-collections.for-each.js"),i("./node_modules/@babel/runtime/helpers/defineProperty.js")),q=i.n(W),V=i("./node_modules/lodash/reverse.js"),Y=i.n(V),G=i("./node_modules/lodash/pick.js"),$=i.n(G),J=i("./node_modules/lodash/fromPairs.js"),Z=i.n(J),X=i("./node_modules/lodash/zipObject.js"),Q=i.n(X),ee=i("./node_modules/lodash/zip.js"),te=i.n(ee),re=i("./node_modules/lodash/isEmpty.js"),ne=i.n(re),se=i("./node_modules/lodash/isString.js"),ie=i.n(se),oe=i("./node_modules/lodash/isPlainObject.js"),ae=i.n(oe),ue=i("./node_modules/lodash/isInteger.js"),le=i.n(ue),_e=i("./node_modules/combos/lib/index.js"),ce=i.n(_e);function ownKeys(t,r){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),i.push.apply(i,o)}return i}function _objectSpread(t){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(i),!0).forEach((function(r){q()(t,r,i[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ownKeys(Object(i)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))}))}return t}function unstack(t){if(!N()(t))throw new TypeError("srcMatrix should be an array");return Object.values(t).reduce((function(t,r){for(var i=0,o=Object.entries(r);i<o.length;i++){var a=v()(o[i],2),u=a[0],l=a[1];u in t?t[u].push(l):t[u]=[l]}return t}),{})}function stack(t){if(!ae()(t))throw new TypeError("srcMatrix should be an object");var r=Object.keys(t);return te.a.apply(void 0,k()(Object.values(t))).map((function(t){return Q()(r,t)}))}function fullfactorial(t){return ce()(unstack(t))}function shuffleVert(t,r){if(!N()(t))throw new TypeError("matrix should be of type array");if(void 0===r||N()(r)&&0===r.length)return D()(t);if(N()(r)){var i=unstack(t),o=$()(i,r);return o=Object.entries(o).reduce((function(t,r){var i=v()(r,2),o=i[0],a=i[1];return t[o]=D()(a),t}),{}),stack(_objectSpread(_objectSpread({},i),o))}throw new TypeError("Invalid argument for columns passed to shuffleVert. Expects an array containing column names")}function shuffleHoriz(t,r){if(!N()(t))throw new TypeError("matrix should be of type array");if(void 0===r&&(r=[]),!N()(r))throw new TypeError("Invalid argument specified to shuffleHoriz. Expects an array that optionally contains column names to shuffle");return Object.values(t).map((function(t){var i=0===r.length?t:$()(t,r),o=Object.keys(i),a=Object.values(i);a=D()(a);var u=Z()(te()(o,a));return _objectSpread(_objectSpread({},t),u)}))}function sortCol(t,r){if(!N()(t))throw new TypeError("matrix should be of type array");if(!ie()(r)||""===r)throw new Error("Invalid argument specified to sortCol. Expects a column name");var i=unstack(t);return i[r].sort(),stack(i)}function reverseRows(t,r){if(!N()(t))throw new TypeError("matrix should be of type array");if(void 0===r&&(r=[]),!N()(r))throw new TypeError("Invalid argument specified to reverseRows. Expects an array containing a column name");if(0===r.length)return Y()(t);var i=unstack(t),o=$()(i,r);if(ne()(o))throw new ReferenceError("one or more of ".concat(r," were not found in the matrix"));return o=Object.entries(o).reduce((function(t,r){var i=v()(r,2),o=i[0],a=i[1];return t[o]=Y()(a),t}),{}),stack(_objectSpread(_objectSpread({},i),o))}function roll(t,r,i){if(!N()(t))throw new TypeError("matrix should be of type array");if(t=k()(t),r=parseInt(r),!le()(r))throw new TypeError("amount needs to be an integer, was ".concat(r));if(!i)return rollN(t,r);if(ie()(i)){var o=unstack(t);if(!Object.prototype.hasOwnProperty.call(o,i))throw new ReferenceError("Could not find column ".concat(i," in matrix"));return o[i]=rollN(o[i],r),stack(o)}throw new TypeError("column expects a string, was ".concat(i))}function rollN(t,r){if(r>0)for(var i=0;i<r;i++)t.unshift(t.pop());else for(var o=0;o>r;o--)t.push(t.shift());return t}function matrix_weight(t,r){if(!N()(t))throw new TypeError("matrix should be of type array");if(!ie()(r))throw new TypeError("Invalid argument passed to weight. Expects a column name");if(!Object.prototype.hasOwnProperty.call(t[0],r))throw new ReferenceError("Column '".concat(r,"' not found in matrix"));return t.reduce((function(t,i){var o=parseInt(i[r]);if(!le()(o))throw new TypeError("Specified weight value is not an integer");for(var a=0;a<o;a++)t.push(i);return t}),[])}var he=i("./node_modules/csv-parse/lib/sync.js"),pe=i.n(he);function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var de=function(t){j()(Loop,t);var r=_createSuper(Loop);function Loop(t,i,o){var a;return c()(this,Loop),(a=r.call(this,t,i,o)).description="Repeatedly runs another item",a.matrix=null,a._break_if="",a._cycles=[],a._index=0,a._keyboard=null,a._operations=[],a._initialized=!1,a.from_string(o),a}return p()(Loop,[{key:"_complete",value:function _complete(){this._status=Xe.STATUS_FINALIZE,E()(O()(Loop.prototype),"_complete",this).call(this)}},{key:"_eval_args",value:function _eval_args(t){var r=this;return N()(t)?t.map((function(t){return N()(t)?r._eval_args(t):r._runner._syntax.remove_quotes(r._runner._syntax.eval_text(t))})):t}},{key:"reset",value:function reset(){this.orig_matrix=[],this.vars.cycles=1,this.vars.repeat=1,this.vars.skip=0,this.vars.offset="no",this.vars.order="random",this.vars.item="",this.vars.break_if="never",this.vars.source="table",this.vars.source_file="",this._index=0,this._operations=[],this._initialized=!1}},{key:"from_string",value:function from_string(t){if(this.comments=[],this.variables={},this.reset(),null!=t)for(var r=t.split("\n"),i=0;i<r.length;i++)if(""!==r[i]&&!1===this.parse_variable(r[i])){var o=this.syntax.split(r[i]),a=w()(o),u=a[0],l=a.slice(1),_=void 0,c=void 0,h=void 0;switch(u){case"run":l.length>0&&(this.vars.item=l[0]);break;case"setcycle":if(l.length<=2){this._runner._debugger.addError("Incorrect setcycle command in item ".concat(this.name));break}_=l[0],c=l[1],h=this.syntax.remove_quotes(l[2]),"="===(h=H()(h)?Number(h):h)[0]&&null!==(h=this._runner._pythonParser._prepare(h.slice(1)))&&(h=h.body[0]),void 0===this.orig_matrix[_]&&(this.orig_matrix[_]={}),this.orig_matrix[_][c]=h;break;case"fullfactorial":this._operations.push([fullfactorial,[]]);break;case"shuffle":this._operations.push([shuffleVert,[l]]);break;case"shuffle_horiz":this._operations.push([shuffleHoriz,[l]]);break;case"slice":this._operations.push([function(t,r){return t.slice.apply(t,k()(r))},[l]]);break;case"sort":this._operations.push([sortCol,k()(l)]);break;case"sortby":this._operations.push([M.a,[l]]);break;case"reverse":this._operations.push([reverseRows,[l]]);break;case"roll":this._operations.push([roll,k()(l)]);break;case"weight":this._operations.push([matrix_weight,k()(l)])}}}},{key:"apply_cycle",value:function apply_cycle(t){if(t in this.matrix)for(var r in this.matrix[t]){var i=this.matrix[t][r];if("object"===g()(i))try{i=this._runner._pythonParser._runstatement(i)}catch(t){this._runner._debugger.addError("Failed to evaluate expression in in loop item: "+this.name+" ("+i+")")}else i=this._runner._syntax.eval_text(i);this.experiment.vars.set(r,i)}}},{key:"prepare",value:function prepare(){"undefined"===this.experiment.items._items[this.vars.item]&&this._runner._debugger.addError("Could not find an item which is called by loop item: "+this.name+" ("+this.vars.item+")"),"file"===this.vars.get("source")&&this.parseFileSource(),this._initialized=!1,E()(O()(Loop.prototype),"prepare",this).call(this),this.set_item_onset()}},{key:"parseFileSource",value:function parseFileSource(){var t=this.vars.get("source_file");if(!t.toLowerCase().endsWith(".csv"))throw"Only csv files are supported as source files by loop items";if(void 0===this._runner._pool[t])throw"Loop item refers to non-existing source file: "+t;this.orig_matrix=pe()(this._runner._pool[t].data,{columns:!0,skip_empty_lines:!0})}},{key:"run",value:function run(){var t=this;if(E()(O()(Loop.prototype),"run",this).call(this),!this._initialized){for(var r=[],i=Math.floor(this.vars.get("repeat")),o=0;o<i;o++)for(var a in this.orig_matrix)r.push(a);var u=this.vars.get("repeat")-i;if(u>0){var l=k()(Array(this.orig_matrix.length).keys());"random"===this.vars.order&&(l=D()(l));var _=Math.floor(this.orig_matrix.length*u);r=[].concat(k()(r),k()(l.splice(0,_)))}for(var c in"random"===this.vars.order&&(r=D()(r)),this.matrix=[],r)this.matrix.push(this.orig_matrix[r[c]]);this.matrix=this._operations.reduce((function(r,i){var o=v()(i,2),a=o[0],u=o[1];return a.apply(void 0,[r].concat(k()(t._eval_args(u))))}),this.matrix),this._cycles=k()(this.matrix.keys()),this._initialized=!0,this._index=null}if(1===this.experiment.vars.repeat_cycle&&null!==this._index&&(this._runner._debugger.msg("Repeating cycle: "+this._index),this._cycles.push(this._index),"random"===this.vars.get("order")&&(this._cycles=D()(this._cycles))),0!=this._cycles.length){this._index=this._cycles.shift(),this.apply_cycle(this._index),this.experiment.vars.repeat_cycle=0;var h=this.vars.get("break_if",void 0,!1);if(this._break_if=["never",""].includes(h)?null:this.syntax.compile_cond(h),null!==this._break_if&&(this.python_workspace.this=this,!0===this.python_workspace._eval(this._break_if)))return this._complete(),void(this._initialized=!1);"sequence"===this._runner._itemStore._items[this.vars.item].type?this._runner._itemStore.prepare(this.vars.item,this):this._runner._itemStore.execute(this.vars.item,this)}else this._complete()}}]),Loop}(K);function response_device_createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function response_device_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return response_device_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return response_device_arrayLikeToArray(t,r)}(t))){var r=0,i=function F(){};return{s:i,n:function n(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,u=!0,l=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return u=t.done,t},e:function e(t){l=!0,a=t},f:function f(){try{u||null==o.return||o.return()}finally{if(l)throw a}}}}function response_device_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var fe=function(){function ResponseDevice(){c()(this,ResponseDevice),this._SYNONYM_MAP=[]}return p()(ResponseDevice,[{key:"_get_default_from_synonym",value:function _get_default_from_synonym(t){var r,i,o=[],a=response_device_createForOfIteratorHelper(t);try{for(a.s();!(i=a.n()).done;){var u=i.value;if(null===(r=this._synonyms(u)))throw new ReferenceError("Unknown key '".concat(u,"'"));o.push(r[0])}}catch(t){a.e(t)}finally{a.f()}return o}},{key:"_synonyms",value:function _synonyms(t){if(void 0===t)return null;var r,i=response_device_createForOfIteratorHelper(this._SYNONYM_MAP);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(o.includes(t)||o.includes(t.toLowerCase()))return o}}catch(t){i.e(t)}finally{i.f()}return[t]}},{key:"flush",value:function flush(){return!1}}]),ResponseDevice}();function keyboard_createSuper(t){var r=function keyboard_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var me=function(t){j()(Keyboard,t);var r=keyboard_createSuper(Keyboard);function Keyboard(t,i,o){var a;return c()(this,Keyboard),(a=r.call(this))._experiment=t,a._keyList=void 0===o?[]:o,a._timeOut=void 0===i?null:i,a._SYNONYM_MAP=[["None","none"],["space"," ","SPACE"],['"',"quotedbl","QUOTEDBL"],["!","exclaim","EXCLAIM"],["#","hash","HASH"],["$","dollar","DOLLAR"],["&","ampersand","AMPERSAND"],["'","quote","QUOTE"],["(","leftbracket","leftparen","LEFTBRACKET","LEFTPAREN"],[")","rightbracket","rightparen","RIGHTBRACKET","RIGHTPAREN"],["*","asteriks","ASTERISK"],["+","plus","PLUS"],[",","comma","COMMA"],["-","minus","MINUS"],[".","period","PERIOD"],["/","slash","SLASH"],["1"],["2"],["3"],["4"],["5"],["6"],["7"],["8"],["9"],["0"],["=","equals","EQUALS"],[":","colon","COLON"],[";","semicolon","SEMICOLON"],["<","less","LESS"],[">","greater","GREATER"],["?","question","QUESTION"],["@","at","AT"],["a","A"],["b","B"],["c","C"],["d","D"],["e","E"],["f","F"],["g","G"],["h","H"],["i","I"],["j","J"],["k","K"],["l","L"],["m","M"],["n","N"],["o","O"],["p","P"],["q","Q"],["r","R"],["s","S"],["t","T"],["u","U"],["v","V"],["w","W"],["x","X"],["y","Y"],["z","Z"],["kp0","KP0"],["kp1","KP1"],["kp2","KP2"],["kp3","KP3"],["kp4","KP4"],["kp5","KP5"],["kp6","KP6"],["kp7","KP7"],["kp8","KP8"],["kp9","KP9"],["kp_divide","KP_DIVIDE"],["kp_enter","KP_ENTER"],["kp_equals","KP_EQUALS"],["kp_minus","KP_MINUS"],["kp_multiply","KP_MULTIPLY"],["kp_period","KP_PERIOD"],["kp_plus","KP_PLUS"],["\\","backslash","BACKSLASH"],["^","power","caret","POWER","CARET"],["_","underscore","UNDERSCORE"],["`","backquote","BACKQUOTE"],["f1","F1","help","HELP"],["f2","F2"],["f3","F3"],["f4","F4"],["f5","F5"],["f6","F6"],["f7","F7"],["f8","F8"],["f9","F9"],["f10","F10"],["f11","F11"],["f12","F12"],["f13","F13"],["f14","F14"],["f15","F15"],["up","UP"],["down","DOWN"],["left","LEFT"],["right","RIGHT"],["menu","MENU"],["lshift","left shift","LSHIFT","LEFT SHIFT"],["lctrl","left ctrl","LCTRL","LEFT CTRL"],["lalt","left alt","LALT","LEFT ALT"],["rshift","right shift","RSHIFT","RIGHT SHIFT"],["rctrl","right ctrl","RCTRL","RIGHT CTRL"],["ralt","right alt","alt gr","RALT","RIGHT ALT","ALT GR"],["page up","pageup","PAGE UP","PAGEUP"],["page down","pagedown","PAGE DOWN","PAGEDOWN"],["pause","PAUSE"],["scroll lock","scrollock","SCROLL LOCK","SCROLLOCK"],["caps lock","capslock","CAPS LOCK","CAPSLOCK"],["nummlock","NUMMLOCK"],["clear","CLEAR"],["enter","ENTER","return","RETURN"],["tab","TAB"],["backspace","BACKSPACE"],["end","END"],["home","HOME"],["insert","INSERT"],["delete","DELETE"],["sysreq","sys req","SYSREQ","SYS REQ"],["break","BREAK"],["escape","ESCAPE"],["print","PRINT"],["print screen","PRINT SCREEN"],["lmeta","left meta","LMETA","LEFT META","lsuper","LSUPER","left super","LEFT SUPER"],["rmeta","right meta","RMETA","RIGHT META","rsuper","right super","RSUPER","RIGHT SUPER"],["euro","EURO"],["first","FIRST"],["last","LAST"],["kp enter","KP ENTER"],["kp equals","KP EQUALS"],["mode","MODE"],["unknown","UNKNOWN"],["unknown key","UNKNOWN KEY"]],a}return p()(Keyboard,[{key:"_set_config",value:function _set_config(t,r){this._keyList=r,this._timeOut=t}},{key:"get_key",value:function get_key(t,r){this._keyList=void 0===r?this._keyList:r,this._timeOut=void 0===t?this._timeOut:t,null!==this._experiment&&this._experiment._runner._events._run(this._timeOut,Xe.RESPONSE_KEYBOARD,this._keyList)}},{key:"get_mods",value:function get_mods(){var t=[];return null!==this._experiment._runner._events.keyDownEvent&&(!0===this._experiment._runner._events.keyDownEvent.event.shiftKey&&t.push("shift"),!0===this._experiment._runner._events.keyDownEvent.event.ctrlKey&&t.push("ctrl"),!0===this._experiment._runner._events.keyDownEvent.event.altKey&&t.push("alt")),t}},{key:"show_virtual_keyboard",value:function show_virtual_keyboard(t){if(!0===t)this._experiment._runner._renderer.view.focus();else{var r=document.createElement("input");document.body.appendChild(r),r.focus(),document.body.removeChild(r)}}}]),Keyboard}(fe);function sequence_createSuper(t){var r=function sequence_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var ve=function(t){j()(Sequence,t);var r=sequence_createSuper(Sequence);function Sequence(t,i,o){var a;return c()(this,Sequence),(a=r.call(this,t,i,o))._index=-1,a._items=null,a._keyboard=null,a.description="Runs a number of items in sequence",a.flush_keyboard="yes",a.items=null,a.from_string(o),a}return p()(Sequence,[{key:"_complete",value:function _complete(){this._status=Xe.STATUS_FINALIZE,E()(O()(Sequence.prototype),"_complete",this).call(this)}},{key:"_prepare_complete",value:function _prepare_complete(){this._index<this.items.length?this.items[this._index].item in this._runner._itemStore._items==!1?this._runner._debugger.addError("Could not find a child item which is called by sequence item: "+this.name+" ("+this.items[this._index].item.name+")"):(this._index++,this._items.push({item:this.items[this._index-1].item,cond:this.syntax.compile_cond(this.items[this._index-1].cond)}),this._runner._itemStore.prepare(this.items[this._index-1].item,this)):(this._index=0,this._runner._itemStack.pop(),"sequence"===this._parent.type?this._parent._prepare_complete():this._runner._itemStore.run(this.name,this._parent))}},{key:"reset",value:function reset(){this.items=[],this.vars.flush_keyboard="yes"}},{key:"from_string",value:function from_string(t){if(this.variables={},this.comments=[],this.reset(),null!==t)for(var r=t.split("\n"),i=0;i<r.length;i++)if(""!==r[i]&&!1===this.parse_variable(r[i])){var o=this.syntax.split(r[i]);if(o.length>0&&"run"===o[0]){var a=o[1],u="always";o.length>2&&(u=this.syntax.strip_slashes(this.syntax.remove_quotes(o[2]))),this.items.push({item:a,cond:u})}}}},{key:"prepare",value:function prepare(){E()(O()(Sequence.prototype),"prepare",this).call(this),"yes"===this.vars.flush_keyboard?this._keyboard=new me(this.experiment):this._keyboard=null,this._index=0,this._items=[],this._prepare_complete()}},{key:"run",value:function run(){if(E()(O()(Sequence.prototype),"run",this).call(this),this._index<this._items.length){0===this._index&&"yes"===this.vars.flush_keyboard&&this._keyboard.flush(),this._index++;var t=this._items[this._index-1];this._runner._pythonWorkspace.self=this,!0===this._runner._pythonWorkspace._eval(t.cond)?this._runner._itemStore.run(t.item,this):this.run()}else this._complete()}}]),Sequence}(K),ye=i("./node_modules/lodash/isFunction.js"),ge=i.n(ye);function coroutines_createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function coroutines_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return coroutines_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return coroutines_arrayLikeToArray(t,r)}(t))){var r=0,i=function F(){};return{s:i,n:function n(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,u=!0,l=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return u=t.done,t},e:function e(t){l=!0,a=t},f:function f(){try{u||null==o.return||o.return()}finally{if(l)throw a}}}}function coroutines_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function coroutines_createSuper(t){var r=function coroutines_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var be=function(t){j()(Coroutines,t);var r=coroutines_createSuper(Coroutines);function Coroutines(t,i,o){var a;return c()(this,Coroutines),(a=r.call(this,t,i,o)).description="Repeatedly runs another item",a.tasks=[],a.schedule=[],a.from_string(o),a}return p()(Coroutines,[{key:"from_string",value:function from_string(t){if(null!==t){var r,i=coroutines_createForOfIteratorHelper(t.split("\n"));try{for(i.s();!(r=i.n()).done;){var o=r.value,a=this.experiment.syntax.parse_cmd(o),u=v()(a,3),l=u[0],_=u[1],c=u[2];if("set"===l){var h=v()(_,2),p=h[0],d=h[1];this.vars[p]=d}if("run"===l&&_.length){var m={item_name:_.shift(),start_time:c.start||0,end_time:c.end||0,run_if:c.runif||"always"};this.tasks.push(m)}}}catch(t){i.e(t)}finally{i.f()}}}},{key:"prepare",value:function prepare(){var t=this;this._runner._debugger.addMessage("Preparing coroutines item '".concat(this.name,"'")),this.schedule=this.tasks.reduce((function(r,i){var o=t._runner._syntax.eval_text(i.item_name,t.vars),a=t._runner._itemStore._items[o];if(!a){var u="Coroutines '".concat(t.name,"' - could not find item: ").concat(o);throw t._runner._debugger.addError(u),new Error(u)}t._runner._pythonWorkspace.self=t;var l=t._runner._syntax.compile_cond(i.run_if);if(!0===t._runner._pythonWorkspace._eval(l)){var _=t._runner._syntax.eval_text(i.start_time,t.vars),c=t._runner._syntax.eval_text(i.end_time,t.vars);r.push(new ke(a,o,_,c,i.item_name===t.vars.get("end_after_item")))}return r}),[]),E()(O()(Coroutines.prototype),"prepare",this).call(this)}},{key:"run",value:function run(){this._runner._debugger.addMessage("Running coroutines item '".concat(this.name,"'")),E()(O()(Coroutines.prototype),"run",this).call(this);var t,r=coroutines_createForOfIteratorHelper(this.schedule);try{for(r.s();!(t=r.n()).done;){var i=t.value;this._runner._itemStore.prepare(i.item_name,this)}}catch(t){r.e(t)}finally{r.f()}this.schedule=M()(this.schedule,"start_time");var o,a=coroutines_createForOfIteratorHelper(this.schedule);try{for(a.s();!(o=a.n()).done;){var u=o.value;this._runner._debugger.addMessage("Launching task '".concat(u.item_name,"'")),u.launch()}}catch(t){a.e(t)}finally{a.f()}this.active=[],this.dt=0,this.t0=performance.now(),this.running=!0,this._loop()}},{key:"_loop",value:function _loop(){for(;this.schedule.length>0&&this.schedule[0].started(this.dt);)this.active.push(this.schedule.shift());this.active=M()(this.active,"end_time");var t,r=[],i=coroutines_createForOfIteratorHelper(this.active);try{for(i.s();!(t=i.n()).done;){var o=t.value,a=o.step();a!==o.RUNNING?a===o.ABORTED&&(this.running=!1):r.push(o)}}catch(t){i.e(t)}finally{i.f()}for(this.active=r;this.active.length>0&&this.active[0].stopped(this.dt);)this.active.shift();if(this.dt=performance.now()-this.t0,this.running&&this.dt<this.vars.get("duration")&&![Xe.TIMER_BREAK,Xe.TIMER_EXIT,Xe.TIMER_ERROR].includes(this._runner._events._state))setTimeout(this._loop.bind(this),0);else{var u,l=coroutines_createForOfIteratorHelper(this.active);try{for(l.s();!(u=l.n()).done;){var _=u.value;this._runner._debugger.addMessage("Killing task '".concat(_.item_name,"'")),_.kill()}}catch(t){l.e(t)}finally{l.f()}this._complete()}}}]),Coroutines}(K),ke=function(){function Task(t,r,i,o,a){c()(this,Task),q()(this,"UNINITIALISED",0),q()(this,"RUNNING",1),q()(this,"FINISHED",2),q()(this,"ABORTED",-1),this.item=t,this.item_name=r,this.start_time=i,this.end_time=o,this.abort_on_end=a,this.state=this.UNINITIALISED,this._coroutine=null,this.step=function(){throw new Error("Task has not been initialized")}}return p()(Task,[{key:"launch",value:function launch(){var t=this;if(!ge()(this.item.coroutine))throw new Error("Item ".concat(this.item_name," does not have correct coroutine implementation"));this._coroutine=this.item.coroutine(),this._coroutine.next(),this.step=function(){var r,i=t._coroutine.next(!0),o=i.value,a=i.done;return!1===o?(t.state=t.ABORTED,t.ABORTED):!0===a?(r=t.abort_on_end?t.ABORTED:t.FINISHED,t.state=r,t.state):t.state},this.state=this.RUNNING}},{key:"started",value:function started(t){return t>=this.start_time}},{key:"stopped",value:function stopped(t){return!(t<this.end_time)&&this.kill()}},{key:"kill",value:function kill(){return!0===this._coroutine.next(!1).done&&(this.state=this.FINISHED,!0)}}]),Task}();function mouse_createSuper(t){var r=function mouse_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var xe=function(t){j()(Mouse,t);var r=mouse_createSuper(Mouse);function Mouse(t,i,o,a){var u;return c()(this,Mouse),(u=r.call(this))._experiment=t,u._timeOut=void 0===i?null:i,u._buttonList=void 0===o?null:o,u._visible=void 0!==a&&a,u._SYNONYM_MAP=[["None","none"],["1","left_button","left"],["2","middle_button","middle"],["3","right_button","right"],["4","scroll_up"],["5","scroll_down"]],u}return p()(Mouse,[{key:"_set_config",value:function _set_config(t,r,i){this._timeOut=t,this._buttonList=r,this._visible=i}},{key:"get_click",value:function get_click(t,r,i){this._timeOut=void 0===t?this._timeOut:t,this._buttonList=void 0===r?this._buttonList:r,this._visible=void 0===i?this._visible:i,null!==this._experiment&&(this.show_cursor(this._visible),this._experiment._runner._events._run(this._timeOut,Xe.RESPONSE_MOUSE,this._buttonList))}},{key:"get_pos",value:function get_pos(){return null!==this._experiment._runner._events._mouseMoveEvent?{rtTime:this._experiment._runner._events._mouseMoveEvent.rtTime,x:this._experiment._runner._events._mouseMoveEvent.event.clientX,y:this._experiment._runner._events._mouseMoveEvent.event.clientY}:{rtTime:-1,x:-1,y:-1}}},{key:"get_pressed",value:function get_pressed(){return null!==this._experiment._runner.events._mouse_press?{buttons:[0===this._experiment._runner._events._mouseDownEvent.event.button,1===this._experiment._runner._events._mouseDownEvent.event.button,2===this._experiment._runner._events._mouseDownEvent.event.button]}:{buttons:[null,null,null]}}},{key:"set_pos",value:function set_pos(t){}},{key:"show_cursor",value:function show_cursor(t){this._visible=t,this._experiment._runner._renderer.view.style.cursor=!0===t?"default":"none"}}]),Mouse}(fe);function generic_response_createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function generic_response_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return generic_response_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return generic_response_arrayLikeToArray(t,r)}(t))){var r=0,i=function F(){};return{s:i,n:function n(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,u=!0,l=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return u=t.done,t},e:function e(t){l=!0,a=t},f:function f(){try{u||null==o.return||o.return()}finally{if(l)throw a}}}}function generic_response_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function generic_response_createSuper(t){var r=function generic_response_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var we=function(t){j()(GenericResponse,t);var r=generic_response_createSuper(GenericResponse);function GenericResponse(t,i,o){var a;return c()(this,GenericResponse),(a=r.call(this,t,i,o))._allowed_responses=null,a._duration=0,a._duration_func=null,a._keyboard=null,a._mouse=null,a._responsetype=Xe.RESPONSE_NONE,a._timeout=-1,a.process_feedback=!1,a.synonyms=null,a}return p()(GenericResponse,[{key:"_complete",value:function _complete(){var t=this.vars.get("timeout");void 0!==t&&this.experiment._runner._events._timeStamp-this.experiment.vars.get("time_"+this.name)>t&&this.process_response_timeout(),E()(O()(GenericResponse.prototype),"_complete",this).call(this)}},{key:"_update",value:function _update(t){null!==t&&(this._responsetype===Xe.RESPONSE_KEYBOARD&&t.type===Xe.RESPONSE_KEYBOARD?this.process_response_keypress(t):this._responsetype===Xe.RESPONSE_MOUSE&&t.type===Xe.RESPONSE_MOUSE&&this.process_response_mouseclick(t))}},{key:"_prepare_responses",value:function _prepare_responses(t){if(null===t)return null;var r=String(t).split(";").map((function(t){return"string"==typeof t?t.replace(/^"(.*)"$/g,"$1").trim():t})).filter(Boolean);return 0===r.length?null:("keypress"===this.vars.duration?r=this._keyboard._get_default_from_synonym(r):"mouseclick"===this.vars.duration&&(r=this._mouse._get_default_from_synonym(r)),r)}},{key:"prepare_allowed_responses",value:function prepare_allowed_responses(){this._allowed_responses=this._prepare_responses(this.vars.get("allowed_responses")),null!==this._allowed_responses&&0===this._allowed_responses.length&&this.experiment._runner._debugger.addError("Defined responses are not valid in keyboard_response: "+this.name+" ("+this.vars.get("allowed_responses")+")")}},{key:"prepare_correct_responses",value:function prepare_correct_responses(){this._correct_responses=this._prepare_responses(this.vars.get("correct_response")),null!==this._correct_responses&&0===this._correct_responses.length&&this.experiment._runner._debugger.addError("Correct response is not valid in keyboard_response: "+this.name+" ("+this.vars.get("correct_response")+")")}},{key:"prepare_duration",value:function prepare_duration(){if(this._duration=this.syntax.remove_quotes(this.vars.get("duration")),null!==this._duration){if("keypress"===this._duration||"mouseclick"===this._duration||"sound"===this._duration||"video"===this._duration)return this._duration=-1,void("keypress"===this.vars.duration?(this.prepare_duration_keypress(),this._responsetype=Xe.RESPONSE_KEYBOARD):"mouseclick"===this.vars.duration?(this.prepare_duration_mouseclick(),this._responsetype=Xe.RESPONSE_MOUSE):"sound"===this.vars.duration?this._responsetype=Xe.RESPONSE_SOUND:"video"===this.vars.duration&&(this._responsetype=Xe.RESPONSE_VIDEO));this._duration=Number(this._duration),0===this._duration?this._responsetype=Xe.RESPONSE_NONE:this._responsetype=Xe.RESPONSE_DURATION}}},{key:"prepare_duration_keypress",value:function prepare_duration_keypress(){this._keyboard=new me(this.experiment),this._final_duration=-1!==this._timeout?this._timeout:this._duration}},{key:"prepare_duration_mouseclick",value:function prepare_duration_mouseclick(){this._mouse=new xe(this.experiment),this._final_duration=-1!==this._timeout?this._timeout:this._duration}},{key:"prepare_timeout",value:function prepare_timeout(){var t=this.vars.get("timeout");null!==t&&(this._timeout="number"==typeof t?t:-1)}},{key:"configure_response_objects",value:function configure_response_objects(){"keypress"===this.vars.duration?this._keyboard._set_config(this._final_duration,this._allowed_responses):"mouseclick"===this.vars.duration&&this._mouse._set_config(this._final_duration,this._allowed_responses,!1)}},{key:"process_response",value:function process_response(){switch(this._responsetype){case Xe.RESPONSE_NONE:this._status=Xe.STATUS_FINALIZE,this._complete();break;case Xe.RESPONSE_DURATION:this.sleep_for_duration();break;case Xe.RESPONSE_KEYBOARD:this._keyboard.get_key();break;case Xe.RESPONSE_MOUSE:this._mouse.get_click();break;case Xe.RESPONSE_SOUND:this._sampler.wait();break;case Xe.RESPONSE_VIDEO:this._video_player.wait()}}},{key:"set_mouse_coordinates",value:function set_mouse_coordinates(t,r){var i=this._runner._renderer.view.getBoundingClientRect(),o=Math.min((i.right-i.left)/this.experiment.vars.width,(i.bottom-i.top)/this.experiment.vars.height),a=o*this.experiment.vars.width/2,u=o*this.experiment.vars.height/2;this.experiment.vars.cursor_x=(t-a-i.left)/o,this.experiment.vars.cursor_y=(r-u-i.top)/o}},{key:"process_response_keypress",value:function process_response_keypress(t){this.experiment._start_response_interval=this.sri,this.experiment._end_response_interval=t.rtTime,this.experiment.vars.response=this.syntax.sanitize(t.resp),this.synonyms=this._keyboard._synonyms(this.experiment.vars.response),this.response_bookkeeping()}},{key:"process_response_mouseclick",value:function process_response_mouseclick(t){this.experiment._start_response_interval=this.sri,this.experiment._end_response_interval=t.rtTime,this.experiment.vars.response=t.resp,this.synonyms=this._mouse._synonyms(this.experiment.vars.response),this.set_mouse_coordinates(t.event.clientX,t.event.clientY),this.response_bookkeeping()}},{key:"process_response_timeout",value:function process_response_timeout(){this.experiment._start_response_interval=this.sri,this.experiment._end_response_interval=this.experiment._runner._events._timeStamp,this.experiment.vars.response="None",this.synonyms=["None","none"],this.response_bookkeeping()}},{key:"response_bookkeeping",value:function response_bookkeeping(){if(this.experiment.vars.set("response_time",this.experiment._end_response_interval-this.experiment._start_response_interval),this.experiment.vars.set("response_"+this.name,this.experiment.vars.get("response")),this.experiment.vars.set("response_time_"+this.name,this.experiment.vars.get("response_time")),this.experiment._start_response_interval=null,!0===this.process_feedback)if(null!==this._correct_responses){this.experiment.vars.correct=0;var t,r=generic_response_createForOfIteratorHelper(this._correct_responses);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(this.synonyms.includes(i)){this.experiment.vars.correct=1,this.experiment.vars.total_correct=this.experiment.vars.total_correct+1;break}}}catch(t){r.e(t)}finally{r.f()}this.experiment.vars.total_response_time=this.experiment.vars.total_response_time+this.experiment.vars.response_time,this.experiment.vars.total_responses=this.experiment.vars.total_responses+1,this.experiment.vars.accuracy=Math.round(100*this.experiment.vars.total_correct/this.experiment.vars.total_responses),this.experiment.vars.acc=this.experiment.vars.accuracy,this.experiment.vars.average_response_time=Math.round(this.experiment.vars.total_response_time/this.experiment.vars.total_responses),this.experiment.vars.avg_rt=this.experiment.vars.average_response_time,this.experiment.vars.set("correct_"+this.name,this.experiment.vars.correct)}else this.experiment.vars.correct="undefined"}},{key:"set_sri",value:function set_sri(t){!0===t&&(this.sri=self.vars.get("time_"+this.name),this.experiment._start_response_interval=this.vars.get("time_"+this.name)),this.experiment._start_response_interval?this.sri=this.experiment._start_response_interval:this.sri=this.experiment.vars.get("time_"+this.name)}},{key:"sleep_for_duration",value:function sleep_for_duration(){this.sleep(this._duration)}},{key:"prepare",value:function prepare(){this.prepare_timeout(),this.prepare_duration(),this.prepare_allowed_responses(),this.prepare_correct_responses(),this.configure_response_objects(),E()(O()(GenericResponse.prototype),"prepare",this).call(this)}}]),GenericResponse}(K),Se=i("./src/js/osweb/backends/canvas.js");function sketchpad_createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function sketchpad_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return sketchpad_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return sketchpad_arrayLikeToArray(t,r)}(t))){var r=0,i=function F(){};return{s:i,n:function n(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,u=!0,l=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return u=t.done,t},e:function e(t){l=!0,a=t},f:function f(){try{u||null==o.return||o.return()}finally{if(l)throw a}}}}function sketchpad_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function sketchpad_createSuper(t){var r=function sketchpad_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var Ee=function(t){j()(Sketchpad,t);var r=sketchpad_createSuper(Sketchpad);function Sketchpad(t,i,o){var a;return c()(this,Sketchpad),(a=r.call(this,t,i,o)).canvas=new Se.a(t,!1),a.elements=[],a.from_string(o),a}return p()(Sketchpad,[{key:"_compare",value:function _compare(t,r){return t.z_index()<r.z_index()?1:t.z_index()>r.z_index()?-1:0}},{key:"_complete",value:function _complete(){E()(O()(Sketchpad.prototype),"_complete",this).call(this)}},{key:"reset",value:function reset(){this.elements=[],this.vars.duration="keypress"}},{key:"process_response_timeout",value:function process_response_timeout(){}},{key:"from_string",value:function from_string(t){if(this.variables={},this.comments=[],this.reset(),null!==t){var r,i=sketchpad_createForOfIteratorHelper(t.split("\n"));try{for(i.s();!(r=i.n()).done;){var o=r.value;if(""!==o&&!1===this.parse_variable(o)){var a=this.syntax.split(o);if(a.length>0&&"draw"===a[0])if(!0===this.experiment.items._isClass(a[1])){var u=this.experiment.items._newElementClass(a[1],this,o);this.elements.push(u)}else this.experiment._runner._debugger.addError("Failed to parse definition: "+a[1])}}}catch(t){i.e(t)}finally{i.f()}this.elements.sort(this._compare)}}},{key:"_set_bg_color",value:function _set_bg_color(){var t=this.vars.get("background");t&&(this.canvas._styles.background_color=t)}},{key:"prepare",value:function prepare(){this.canvas.clear();for(var t=0;t<this.elements.length;t++)!0===this.elements[t].is_shown()&&this.elements[t].draw();E()(O()(Sketchpad.prototype),"prepare",this).call(this)}},{key:"run",value:function run(){E()(O()(Sketchpad.prototype),"run",this).call(this),this._set_bg_color(),this.set_item_onset(this.canvas.show()),this.set_sri(!1),this.process_response()}},{key:"coroutine",value:a.a.mark((function coroutine(){return a.a.wrap((function coroutine$(t){for(;;)switch(t.prev=t.next){case 0:return void(t.next=2);case 2:this._set_bg_color(),this.set_item_onset(this.canvas.show());case 4:case"end":return t.stop()}}),coroutine,this)}))}]),Sketchpad}(we);function feedback_createSuper(t){var r=function feedback_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var Re=function(t){j()(Feedback,t);var r=feedback_createSuper(Feedback);function Feedback(t,i,o){var a;return c()(this,Feedback),(a=r.call(this,t,i,o)).description="Provides feedback to the participant",a}return p()(Feedback,[{key:"_complete",value:function _complete(){E()(O()(Feedback.prototype),"_complete",this).call(this),"yes"===this.vars.reset_variables&&this.experiment.reset_feedback()}},{key:"reset",value:function reset(){E()(O()(Feedback.prototype),"reset",this).call(this),this.vars.reset_variables="yes"}},{key:"prepare",value:function prepare(){this._parent._prepare_complete()}},{key:"run",value:function run(){E()(O()(Feedback.prototype),"prepare",this).call(this),E()(O()(Feedback.prototype),"run",this).call(this)}}]),Feedback}(Ee);function inline_script_createSuper(t){var r=function inline_script_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var je=function(t){j()(InlineScript,t);var r=inline_script_createSuper(InlineScript);function InlineScript(t,i,o){var a;return c()(this,InlineScript),(a=r.call(this,t,i,o)).description="Executes Python code",a._prepare_run=!1,a._prepare_tree=null,a._run_tree=null,a.from_string(o),a}return p()(InlineScript,[{key:"_complete",value:function _complete(){1===this.experiment._runner._pythonParser._status?this.experiment._runner._pythonParser._process_nodes():!0===this._prepare_run?E()(O()(InlineScript.prototype),"prepare",this).call(this):E()(O()(InlineScript.prototype),"_complete",this).call(this)}},{key:"_complete_script",value:function _complete_script(){this._complete()}},{key:"reset",value:function reset(){this.vars._prepare="",this.vars._run=""}},{key:"prepare",value:function prepare(){this._prepare_tree=this.experiment._runner._pythonParser._parse(this.vars._prepare),this._run_tree=this.experiment._runner._pythonParser._parse(this.vars._run),null!==this._prepare_tree?(this.experiment._runner._events._currentItem=this,this._prepare_run=!0,this.set_item_onset(),this.experiment._runner._pythonParser._run(this,this._prepare_tree)):E()(O()(InlineScript.prototype),"prepare",this).call(this)}},{key:"run",value:function run(){E()(O()(InlineScript.prototype),"run",this).call(this),this._prepare_run=!1,this.set_item_onset(),null!==this._run_tree?this.experiment._runner._pythonParser._run(this,this._run_tree):(this.experiment._runner._pythonParser._status=0,this._complete())}}]),InlineScript}(K);function inline_javascript_createSuper(t){var r=function inline_javascript_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var Te=function(t){j()(InlineJavaScript,t);var r=inline_javascript_createSuper(InlineJavaScript);function InlineJavaScript(t,i,o){var a;return c()(this,InlineJavaScript),(a=r.call(this,t,i,o)).description="Executes JavaScript code (ECMA 5.1)",a.workspace=t._javascriptWorkspace,a.from_string(o),a}return p()(InlineJavaScript,[{key:"reset",value:function reset(){this.vars._prepare="",this.vars._run=""}},{key:"from_string",value:function from_string(t){if(this.reset(),null!==t)for(var r=!1,i=!1,o=t.split("\n"),a=0;a<o.length;a++){var u=this.syntax.split(o[a]);if(null!==u&&u.length>0)switch(u[0]){case"set":this.parse_variable(o[a]);break;case"__end__":r=!1,i=!1;break;case"___prepare__":i=!0;break;case"___run__":r=!0;break;default:!0===r?this.vars._run=this.vars._run+o[a]+"\n":!0===i&&(this.vars._prepare=this.vars._prepare+o[a]+"\n")}else!0===r?this.vars._run=this.vars._run+o[a]+"\n":!0===i&&(this.vars._prepare=this.vars._prepare+o[a]+"\n")}}},{key:"prepare",value:function prepare(){this.workspace._eval(this.vars._prepare),E()(O()(InlineJavaScript.prototype),"prepare",this).call(this)}},{key:"run",value:function run(){E()(O()(InlineJavaScript.prototype),"run",this).call(this),this.set_item_onset(),this.workspace._eval(this.vars._run),this._complete()}}]),InlineJavaScript}(K);function keyboard_response_createSuper(t){var r=function keyboard_response_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var Ce=function(t){j()(KeyboardResponse,t);var r=keyboard_response_createSuper(KeyboardResponse);function KeyboardResponse(t,i,o){var a;return c()(this,KeyboardResponse),(a=r.call(this,t,i,o)).description="Collects keyboard responses",a._flush="yes",a._keyboard=new me(a.experiment),a.from_string(o),a}return p()(KeyboardResponse,[{key:"reset",value:function reset(){this.process_feedback=!0,this.vars.allowed_responses=null,this.vars.correct_response=null,this.vars.duration="keypress",this.vars.flush="yes",this.vars.timeout="infinite"}},{key:"prepare",value:function prepare(){this._flush=this.vars.flush?this.vars.flush:"yes",E()(O()(KeyboardResponse.prototype),"prepare",this).call(this)}},{key:"run",value:function run(){E()(O()(KeyboardResponse.prototype),"run",this).call(this),this.set_item_onset(),"yes"===this._flush&&this._keyboard.flush(),this.set_sri(),this.process_response()}},{key:"coroutine",value:a.a.mark((function coroutine(){var t,r,i=this;return a.a.wrap((function coroutine$(o){for(;;)switch(o.prev=o.next){case 0:return t=function keyDownHandler(t){var r=i.experiment._runner._events._processKeyboardEvent(t,1),o="all";i.vars.get("allowed_responses")&&(o=i._keyboard._get_default_from_synonym(i.vars.get("allowed_responses").split(";").map((function(t){return t.trim()})))),("all"===o||o.includes(r.resp))&&(i.response=r)},window.addEventListener("keydown",t),void(o.next=4);case 4:this.set_item_onset(),this.set_sri(),r=!0,this.response=null;case 8:if(this.response||!r){o.next=14;break}return o.next=11,!0;case 11:r=o.sent,o.next=8;break;case 14:window.removeEventListener("keydown",t),this.response&&this.process_response_keypress(this.response);case 16:case"end":return o.stop()}}),coroutine,this)}))}]),KeyboardResponse}(we);function mouse_response_createSuper(t){var r=function mouse_response_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var Ie=function(t){j()(MouseResponse,t);var r=mouse_response_createSuper(MouseResponse);function MouseResponse(t,i,o){var a;return c()(this,MouseResponse),(a=r.call(this,t,i,o)).description="Collects mouse responses",a.resp_codes={},a._flush="yes",a.from_string(o),a}return p()(MouseResponse,[{key:"_complete",value:function _complete(){this._mouse.show_cursor(!1),E()(O()(MouseResponse.prototype),"_complete",this).call(this)}},{key:"reset",value:function reset(){this.process_feedback=!0,this.resp_codes={},this.resp_codes[0]="timeout",this.resp_codes[1]="left_button",this.resp_codes[2]="middle_button",this.resp_codes[3]="right_button",this.resp_codes[4]="scroll_up",this.resp_codes[5]="scroll_down",this.vars.allowed_responses=null,this.vars.correct_response=null,this.vars.duration="mouseclick",this.vars.flush="yes",this.vars.show_cursor="yes",this.vars.timeout="infinite"}},{key:"prepare",value:function prepare(){this._flush=this.vars.flush?this.vars.flush:"yes",E()(O()(MouseResponse.prototype),"prepare",this).call(this)}},{key:"run",value:function run(){E()(O()(MouseResponse.prototype),"run",this).call(this),this.set_item_onset(),"yes"===this.vars.show_cursor&&this._mouse.show_cursor(!0),"yes"===this._flush&&this._mouse.flush(),this.set_sri(),this.process_response()}},{key:"coroutine",value:a.a.mark((function coroutine(){var t,r,i,o=this;return a.a.wrap((function coroutine$(a){for(;;)switch(a.prev=a.next){case 0:return t=function mouseDownHandler(t){o.response=o.experiment._runner._events._processMouseEvent(t,1)},r=function touchHandler(t){t.button=0,t.clientX=t.changedTouches[0].clientX,t.clientY=t.changedTouches[0].clientY,o.response=o.experiment._runner._events._processMouseEvent(t,1)},window.addEventListener("mousedown",t),window.addEventListener("touchstart",r),void(a.next=6);case 6:"yes"===this.vars.show_cursor&&this._mouse.show_cursor(!0),this.set_item_onset(),this.set_sri(),i=!0,this.response=null;case 11:if(this.response||!i){a.next=17;break}return a.next=14,!0;case 14:i=a.sent,a.next=11;break;case 17:window.removeEventListener("mousedown",t),window.removeEventListener("touchstart",r),this.response&&this.process_response_mouseclick(this.response);case 20:case"end":return a.stop()}}),coroutine,this)}))}]),MouseResponse}(we);function logger_createSuper(t){var r=function logger_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var Oe=function(t){j()(Logger,t);var r=logger_createSuper(Logger);function Logger(t,i,o){var a;return c()(this,Logger),(a=r.call(this,t,i,o)).description="Logs experimental data",a.from_string(o),a}return p()(Logger,[{key:"_complete",value:function _complete(){E()(O()(Logger.prototype),"_complete",this).call(this)}},{key:"reset",value:function reset(){this.logvars=[],this.vars.auto_log="yes"}},{key:"from_string",value:function from_string(t){if(this.reset(),null!==t)for(var r=t.split("\n"),i=0;i<r.length;i++)if(""!==r[i]&&!1===this.parse_variable(r[i])){var o=this.syntax.split(r[i]);"log"===o[0]&&o.length>0&&this.logvars.push(o[1])}this.logvars.sort()}},{key:"run",value:function run(){E()(O()(Logger.prototype),"run",this).call(this),this._status!==Xe.STATUS_FINALIZE&&(this._status=Xe.STATUS_FINALIZE,this.set_item_onset(),this.experiment._log.write_vars("yes"===this.vars.get("auto_log")?this.logvars.concat(this.experiment.vars.inspect()).sort():this.logvars),this._complete())}}]),Logger}(K),Ae=null;try{Ae=new(window.AudioContext||window.webkitAudioContext)}catch(t){console.warn("Web Audio API is not supported in this browser")}var Me=function(){function SamplerBackend(t,r,i,o,a,u,l,_){var h=this;c()(this,SamplerBackend),this.block=void 0!==_&&_,this.duration=void 0===u?"sound":u,this.experiment=t,this.volume=void 0===i?1:i,this.fade=void 0===l?0:l,this.pan=void 0===a?0:a,this.pitch=void 0===o?1:o;try{this.sample=r.data}catch(t){throw console.error("Could not play sound:",r),t}this.sample.onended=function(){return h.experiment._runner._events._audioEnded(h)},Ae?(void 0===r.mediaElementSource&&(r.mediaElementSource=Ae.createMediaElementSource(this.sample)),this.source=r.mediaElementSource):this.source=this.sample}return p()(SamplerBackend,[{key:"play",value:function play(t,r,i,o,a,u){this.block=u||this.block,this.duration=void 0===o?this.duration:o,this.volume=void 0===t?this.volume:t,this.pitch=void 0===r?this.pitch:r,this.pan=void 0===i?this.pan:i,this.fade=void 0===a?this.fade:a,Ae?("suspended"===Ae.state&&Ae.resume(),this.source.connect(this.applyFilters())):this.source.volume=this.volume,this.sample.preservesPitch=!1,this.sample.playbackRate=this.pitch,this.sample.play()}},{key:"wait",value:function wait(){this.experiment._runner._events._run(this,-1,Xe.RESPONSE_SOUND,[])}},{key:"applyFilters",value:function applyFilters(){var t=[Ae.destination],r=new GainNode(Ae);if(r.gain.setValueAtTime(this.volume,Ae.currentTime),this.fade&&(r.gain.setValueAtTime(0,Ae.currentTime),r.gain.linearRampToValueAtTime(this.volume,Ae.currentTime+this.fade/1e3)),t.unshift(r),this.pan){var i;i="left"===this.pan?-1:"right"===this.pan?1:this.pan;try{t.unshift(new StereoPannerNode(Ae,{pan:i}))}catch(t){console.warn("Unable to apply panning",t)}}for(var o=0;o<t.length;o++)t[o]!==Ae.destination&&t[o].connect(t[o+1]);return t.shift(0)}}]),SamplerBackend}();function sampler_createSuper(t){var r=function sampler_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var Pe=function(t){j()(Sampler,t);var r=sampler_createSuper(Sampler);function Sampler(t,i,o){var a;return c()(this,Sampler),(a=r.call(this,t,i,o)).block=!1,a.description="Plays a sound file in .wav or .ogg format",a._sample=null,a._sampler=null,a.from_string(o),a}return p()(Sampler,[{key:"reset",value:function reset(){this.block=!1,this.vars.sample="",this.vars.pan=0,this.vars.pitch=1,this.vars.fade_in=0,this.vars.stop_after=0,this.vars.volume=1,this.vars.duration="sound"}},{key:"prepare",value:function prepare(){""!==this.vars.sample?(this._sample=this._runner._pool[this.syntax.eval_text(this.vars.sample,this.vars,!1)],void 0===this._sample&&this.experiment._runner._debugger.addError('"'.concat(this.vars.sample,'" does not exist in the file pool')),this._sampler=new Me(this.experiment,this._sample),this._sampler.volume=this.vars.get("volume"),this._sampler.duration=this.vars.get("duration"),this._sampler.fade=this.vars.get("fade_in"),this._sampler.pan=this.vars.get("pan"),this._sampler.pitch=this.vars.get("pitch")):this._runner._debugger.addError("No sample has been specified in sampler: "+this.vars.sample),E()(O()(Sampler.prototype),"prepare",this).call(this)}},{key:"run",value:function run(){this.set_item_onset(),this.set_sri(),this._sampler.play(),this.process_response()}}]),Sampler}(we);function synth_createSuper(t){var r=function synth_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var Fe=function(t){j()(Synth,t);var r=synth_createSuper(Synth);function Synth(t,i,o){var a;return c()(this,Synth),(a=r.call(this,t,i,o)).description="A basic sound synthesizer",a}return Synth}(Pe);function advanced_delay_createSuper(t){var r=function advanced_delay_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var De=function(t){j()(AdvancedDelay,t);var r=advanced_delay_createSuper(AdvancedDelay);function AdvancedDelay(t,i,o){var a;return c()(this,AdvancedDelay),(a=r.call(this,t,i,o)).description="Waits for a specified duration",a._duration=-1,a.from_string(o),a}return p()(AdvancedDelay,[{key:"_random_gauss",value:function _random_gauss(t,r){for(var i=0,o=0;0===i;)i=Math.random();for(;0===o;)o=Math.random();return Math.max(0,t+Math.sqrt(-2*Math.log(i))*Math.cos(2*Math.PI*o)*r)}},{key:"_random_uniform",value:function _random_uniform(t,r){return Math.max(0,Math.floor(t+Math.random()*r-r/2))}},{key:"reset",value:function reset(){this.vars.duration=1e3,this.vars.jitter=0,this.vars.jitter_mode="Uniform"}},{key:"prepare",value:function prepare(){var t=this.vars.get("duration"),r=this.vars.get("jitter"),i=this.vars.get("jitter_mode");(!H()(t)||t<0)&&this._runner._debugger.addError("Duration should be a positive numeric value in advanced_delay "+this.name),"Uniform"===i?this._duration=this._random_uniform(t,r):"Std. Dev."===i?this._duration=this._random_gauss(t,r):this._runner._debugger.addError("Unknown jitter mode in advanced_delay "+this.name),this._duration<0&&(this._duration=0),this._duration=Number(this._duration),this.experiment.vars.set("delay_"+this.name,this._duration),this._runner._debugger.addMessage("delay for "+this._duration+" ms."),E()(O()(AdvancedDelay.prototype),"prepare",this).call(this)}},{key:"run",value:function run(){E()(O()(AdvancedDelay.prototype),"run",this).call(this),this.set_item_onset(this.time()),this._duration>0?this.sleep(this._duration):this._complete()}}]),AdvancedDelay}(K);i("./node_modules/core-js/modules/es.array.join.js");function form_html_createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function form_html_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return form_html_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return form_html_arrayLikeToArray(t,r)}(t))){var r=0,i=function F(){};return{s:i,n:function n(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,u=!0,l=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return u=t.done,t},e:function e(t){l=!0,a=t},f:function f(){try{u||null==o.return||o.return()}finally{if(l)throw a}}}}function form_html_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function form_html_createSuper(t){var r=function form_html_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var Le=function(t){j()(FormHTML,t);var r=form_html_createSuper(FormHTML);function FormHTML(t,i,o){var a;return c()(this,FormHTML),(a=r.call(this,t,i,o))._widgets=[],a.from_string(o),a}return p()(FormHTML,[{key:"reset",value:function reset(){E()(O()(FormHTML.prototype),"reset",this).call(this),this.vars.margins="50;50;50;50"}},{key:"formElements",value:function formElements(){return[]}},{key:"formHTML",value:function formHTML(){return null}},{key:"resumeOSWeb",value:function resumeOSWeb(){this._formContainer.remove(),this._osweb.style.display="flex",window.addEventListener("keydown",runner._events._keyDownHandler),window.addEventListener("keyup",runner._events._keyUpHandler),this._complete()}},{key:"_runScripts",value:function _runScripts(){var t,r=form_html_createForOfIteratorHelper(this._customForm.getElementsByTagName("script"));try{for(r.s();!(t=r.n()).done;){var i=t.value;this.experiment._javascriptWorkspace._eval(i.textContent)}}catch(t){r.e(t)}finally{r.f()}}},{key:"applyTheme",value:function applyTheme(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"gray"===this.vars.get("_theme")&&(r&&(t.style.backgroundColor="#888a85"),t.style.borderTop="solid 1px #babdb6",t.style.borderLeft="solid 1px #555753",t.style.borderRight="solid 1px #555753",t.style.borderBottom="solid 1px #555753")}},{key:"element",value:function element(t,r,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],element=document.createElement(t);return null!=r&&(element.innerHTML=r.replace(/\n/g,"<br>")),void 0!==i&&(element.style.height=this._paddedHeight*i-40+"px"),void 0!==o&&(element.style.width=this._paddedWidth*o-40+"px"),element.style.padding="10px",element.style.margin="10px",a&&(element.style.fontFamily="inherit",element.style.fontSize="inherit",element.style.fontWeight="inherit",element.style.textDecoration="inherit",element.style.color="inherit",element.style.backgroundColor="inherit"),element}},{key:"checkbox",value:function checkbox(t,r,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],u=this.element("input",null,null,null);u.type=t,u.value=r;var l=this.element("label",r,null,null),_=this.element("div",null,i,o,a);return _.style.textAlign="left",_.append(u),_.append(l),[_,u]}},{key:"run",value:function run(){this._customForm=document.createElement("div"),this._customForm.style.color=this.vars.get("foreground"),this._customForm.style.backgroundColor=this.vars.get("background"),this._customForm.style.fontSize=this.vars.get("font_size")+"px",this._customForm.style.fontFamily=this._fontFamily,"yes"===this.vars.get("font_bold")&&(this._customForm.style.fontWeight="bold"),"yes"===this.vars.get("font_italic")&&(this._customForm.style.fontStyle="italic"),"yes"===this.vars.get("font_underline")&&(this._customForm.style.textDecoration="underline"),this._customForm.style.padding=this._padding.join("px ")+"px",this._customForm.style.width=this._paddedWidth+"px",this._customForm.style.height=this._paddedHeight+"px",this._customForm.style.textAlign="center";var t,r=form_html_createForOfIteratorHelper(this.formElements());try{for(r.s();!(t=r.n()).done;){var i=t.value;this._customForm.append(i)}}catch(t){r.e(t)}finally{r.f()}var o=this.formHTML();null!==o&&(this._customForm.innerHTML=o),this._formContainer=document.createElement("div"),this._formContainer.style.justifyContent="center",this._formContainer.style.alignItems="center",this._formContainer.style.display="flex",this._formContainer.style.height="100%",this._formContainer.append(this._customForm),this._osweb=document.getElementsByClassName("justify-content-center")[0],document.body.append(this._formContainer),this._osweb.style.display="none",window.removeEventListener("keydown",runner._events._keyDownHandler),window.removeEventListener("keyup",runner._events._keyUpHandler),this._runScripts()}},{key:"_fontFamily",get:function get(){var t=this.vars.get("font_family");return"sans"===t?"sans-serif":"mono"===t?"monospace":t}},{key:"_padding",get:function get(){return void 0===this._cached_padding&&(this._cached_padding=String(this.vars.get("margins")).split(";").map(Number)),this._cached_padding}},{key:"_paddedWidth",get:function get(){if(void 0===this._width){var t=v()(this._padding,4),r=(t[0],t[1]),i=(t[2],t[3]);this._width=this.experiment._runner._renderer.view.clientWidth-r-i}return this._width}},{key:"_paddedHeight",get:function get(){if(void 0===this._height){var t=v()(this._padding,4),r=t[0],i=(t[1],t[2]);t[3];this._height=this.experiment._runner._renderer.view.clientHeight-r-i}return this._height}}]),FormHTML}(K);function form_consent_createSuper(t){var r=function form_consent_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var Ne=function(t){j()(FormConsent,t);var r=form_consent_createSuper(FormConsent);function FormConsent(){return c()(this,FormConsent),r.apply(this,arguments)}return p()(FormConsent,[{key:"onDecline",value:function onDecline(){alertify.error(this.vars.get("decline_message"))}},{key:"onAccept",value:function onAccept(){this._checkbox.checked?this.resumeOSWeb():this.onDecline()}},{key:"formElements",value:function formElements(){var t=this.element("h1",this.vars.get("form_title"),1/7),r=this.element("p",this.vars.get("form_text"),4/7);r.style.textAlign="left";var i=this.checkbox("checkbox",this.vars.get("checkbox_text"),1/7),o=v()(i,2),a=o[0],u=o[1];this._checkbox=u;var l=this.element("div",null,1/7),_=this.element("input",null,null,1/3);_.value=this.vars.get("accept_text"),_.type="button",_.onclick=this.onAccept.bind(this);var c=this.element("input",null,null,1/3);return c.value=this.vars.get("decline_text"),c.type="button",c.onclick=this.onDecline.bind(this),l.append(_),l.append(c),this.applyTheme(_,!0),this.applyTheme(c,!0),[t,r,a,l]}}]),FormConsent}(Le);function inline_html_createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function inline_html_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return inline_html_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return inline_html_arrayLikeToArray(t,r)}(t))){var r=0,i=function F(){};return{s:i,n:function n(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,u=!0,l=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return u=t.done,t},e:function e(t){l=!0,a=t},f:function f(){try{u||null==o.return||o.return()}finally{if(l)throw a}}}}function inline_html_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function inline_html_createSuper(t){var r=function inline_html_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var Ue=function(t){j()(InlineHTML,t);var r=inline_html_createSuper(InlineHTML);function InlineHTML(){return c()(this,InlineHTML),r.apply(this,arguments)}return p()(InlineHTML,[{key:"reset",value:function reset(){E()(O()(InlineHTML.prototype),"reset",this).call(this),this.vars.html=""}},{key:"formHTML",value:function formHTML(){return this.vars.get("html")}},{key:"_inputElements",value:function _inputElements(){return Array.from(document.getElementsByTagName("input")).concat(Array.from(document.getElementsByTagName("select"))).concat(Array.from(document.getElementsByTagName("textarea")))}},{key:"_submitForm",value:function _submitForm(){var t,r=inline_html_createForOfIteratorHelper(this._inputElements());try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.required&&(["checkbox","radio"].includes(i.type)&&!this._groupChecked(i)||!["checkbox","radio"].includes(i.type)&&""===i.value))return void alert("One or more required input fields are empty or have not been checked")}}catch(t){r.e(t)}finally{r.f()}var o,a=inline_html_createForOfIteratorHelper(this._inputElements());try{for(a.s();!(o=a.n()).done;){var u=o.value;["checkbox","radio"].includes(u.type)?u.checked&&this.experiment.vars.set(u.name,""!==u.id?u.id:u.value):this.experiment.vars.set(u.name,u.value)}}catch(t){a.e(t)}finally{a.f()}this.resumeOSWeb()}},{key:"_groupChecked",value:function _groupChecked(t){if(""===t.name)return t.checked;var r,i=inline_html_createForOfIteratorHelper(document.getElementsByName(t.name));try{for(i.s();!(r=i.n()).done;)if((t=r.value).checked)return!0}catch(t){i.e(t)}finally{i.f()}return!1}},{key:"run",value:function run(){E()(O()(InlineHTML.prototype),"run",this).call(this);var t,r=inline_html_createForOfIteratorHelper(document.getElementsByTagName("form"));try{for(r.s();!(t=r.n()).done;){t.value.onsubmit=function(){return!1}}}catch(t){r.e(t)}finally{r.f()}var i,o=inline_html_createForOfIteratorHelper(document.getElementsByTagName("input"));try{for(o.s();!(i=o.n()).done;){var a=i.value;"submit"===a.type&&(a.onclick=this._submitForm.bind(this))}}catch(t){o.e(t)}finally{o.f()}}}]),InlineHTML}(Le);function form_multiple_choice_createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function form_multiple_choice_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return form_multiple_choice_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return form_multiple_choice_arrayLikeToArray(t,r)}(t))){var r=0,i=function F(){};return{s:i,n:function n(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,u=!0,l=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return u=t.done,t},e:function e(t){l=!0,a=t},f:function f(){try{u||null==o.return||o.return()}finally{if(l)throw a}}}}function form_multiple_choice_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}function form_multiple_choice_createSuper(t){var r=function form_multiple_choice_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var He=function(t){j()(FormMultipleChoice,t);var r=form_multiple_choice_createSuper(FormMultipleChoice);function FormMultipleChoice(){return c()(this,FormMultipleChoice),r.apply(this,arguments)}return p()(FormMultipleChoice,[{key:"resumeOSWeb",value:function resumeOSWeb(){var t,r=[],i=form_multiple_choice_createForOfIteratorHelper(this._boxes);try{for(i.s();!(t=i.n()).done;){var o=t.value;o.checked&&r.push(o.value)}}catch(t){i.e(t)}finally{i.f()}this.experiment.vars.set(this.vars.form_var,r.length>0?r.join(";"):"no"),E()(O()(FormMultipleChoice.prototype),"resumeOSWeb",this).call(this)}},{key:"_boxClicked",value:function _boxClicked(){this._hasOkButton||setTimeout(this.resumeOSWeb.bind(this),100)}},{key:"formElements",value:function formElements(){this._hasOkButton="no"===this.vars.get("advance_immediately")||"checkbox"===i;var t=[];this._boxes=[];var r=String(this.vars.get("options")).split("\n").filter((function(t){return t.trim().length>0})),i="no"===this.vars.get("allow_multiple")?"radio":"checkbox",o=1/(r.length+(this._hasOkButton?3:2)),a=this.element("h1",this.vars.get("form_title"),o,1);t.push(a);var u=this.element("p",this.vars.get("question"),o,1);t.push(u);var l,_=form_multiple_choice_createForOfIteratorHelper(r);try{for(_.s();!(l=_.n()).done;){var c=l.value,h=this.checkbox(i,c,o),p=v()(h,2),d=p[0],m=p[1];m.name="options",m.onclick=this._boxClicked.bind(this),this._boxes.push(m),t.push(d)}}catch(t){_.e(t)}finally{_.f()}if(this._hasOkButton){var y=this.element("input",null,o,1/3);y.style.width="100%",this.applyTheme(y,!0),y.type="button",y.value=this.vars.get("button_text"),y.onclick=this.resumeOSWeb.bind(this),t.push(y)}return t}}]),FormMultipleChoice}(Le);function form_text_display_createSuper(t){var r=function form_text_display_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var Be=function(t){j()(FormTextDisplay,t);var r=form_text_display_createSuper(FormTextDisplay);function FormTextDisplay(){return c()(this,FormTextDisplay),r.apply(this,arguments)}return p()(FormTextDisplay,[{key:"formElements",value:function formElements(){var t=this.element("h1",this.vars.get("form_title"),1/6),r=this.element("p",this.vars.get("form_text"),4/6);r.style.textAlign="left";var i=this.element("input",null,1/6,1/3);return i.type="button",i.value=this.vars.get("ok_text"),i.onclick=this.resumeOSWeb.bind(this),this.applyTheme(i,!0),[t,r,i]}}]),FormTextDisplay}(Le);function form_text_input_createSuper(t){var r=function form_text_input_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var ze=function(t){j()(FormTextInput,t);var r=form_text_input_createSuper(FormTextInput);function FormTextInput(){return c()(this,FormTextInput),r.apply(this,arguments)}return p()(FormTextInput,[{key:"checkReturnPress",value:function checkReturnPress(t){13===t.keyCode&&(this.experiment.vars.set(this.vars.form_var,this._textArea.value),this.resumeOSWeb())}},{key:"formElements",value:function formElements(){var t=this.element("h1",this.vars.get("form_title"),1/8),r=this.element("p",this.vars.get("form_question"),1/8);return r.style.textAlign="left",this._textArea=this.element("textarea",null,6/8),this.applyTheme(this._textArea,!1),[t,r,this._textArea]}},{key:"_activateTextArea",value:function _activateTextArea(){this._textArea.focus(),this._textArea.onkeypress=this.checkReturnPress.bind(this)}},{key:"run",value:function run(){E()(O()(FormTextInput.prototype),"run",this).call(this),setTimeout(this._activateTextArea.bind(this),10)}}]),FormTextInput}(Le),Ke=function(){function Video(t,r){c()(this,Video),this._experiment=t,this.audio=!0,this.duration="keypress",this.full_screen=!1,this._playing=!1,this._script=null,null!==r&&(this._video=r.data,this._texture=d.e.from(r.data),this._videoSprite=new d.c(this._texture),this._video.pause(),this._video.onended=this._experiment._runner._events._videoEnded.bind(this),this._video.onplay=this._experiment._runner._events._videoPlay.bind(this))}return p()(Video,[{key:"_update",value:function _update(){!0===this._playing&&(this._experiment._runner._renderer.render(this._videoSprite),null!==this._script&&!0===this._event_handler_always&&this._experiment._runner._pythonParser._run(null,this._script))}},{key:"play",value:function play(){this._video.play(),this._video.volume=!0===this.audio?1:0,!0===this.full_screen&&(this._videoSprite.width=this._experiment._runner._renderer.width,this._videoSprite.height=this._experiment._runner._renderer.height),this._experiment._runner._renderer.render(this._videoSprite),this._playing=!0}},{key:"stop",value:function stop(){this._video.pause(),this._playing=!1}},{key:"wait",value:function wait(){this._experiment._runner._events._run(-1,Xe.RESPONSE_VIDEO,[])}}]),Video}();function media_player_createSuper(t){var r=function media_player_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var We=function(t){j()(MediaPlayer,t);var r=media_player_createSuper(MediaPlayer);function MediaPlayer(t,i,o){var a;return c()(this,MediaPlayer),(a=r.call(this,t,i,o)).description="A video player",a._script_executed=!1,a.from_string(o),a}return p()(MediaPlayer,[{key:"_complete",value:function _complete(){!1===this._script_executed?(this._video_player.stop(),null!==this._video_player._script&&"on keypress"===this.vars.get("event_handler_trigger")?(this._script_executed=!0,this._runner._pythonParser._run(this,this._video_player._script)):E()(O()(MediaPlayer.prototype),"_complete",this).call(this)):E()(O()(MediaPlayer.prototype),"_complete",this).call(this)}},{key:"_update",value:function _update(t){this._video_player._update()}},{key:"prepare",value:function prepare(){this._video=this.experiment.pool[this.vars.get("video_src")],this._video_player=new Ke(this.experiment,this._video),""!==this.vars.event_handler&&(this._video_player._script=this._runner._pythonParser._parse(this.vars.event_handler)),this._video_player._event_handler_always="after every frame"===this.vars.event_handler_trigger,this._video_player.audio="yes"===this.vars.get("playaudio"),this._video_player.full_screen="yes"===this.vars.get("resizeVideo"),"sound"===this.vars.duration&&(this.vars.duration="video"),this._video_player.duration=this.vars.duration,E()(O()(MediaPlayer.prototype),"prepare",this).call(this)}},{key:"run",value:function run(){this.set_item_onset(),this.set_sri(),this._video_player.play(),this.process_response()}}]),MediaPlayer}(K);function notepad_createSuper(t){var r=function notepad_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var qe=function(t){j()(Notepad,t);var r=notepad_createSuper(Notepad);function Notepad(t,i,o){var a;return c()(this,Notepad),(a=r.call(this,t,i,o)).description="A simple notepad to document your experiment. This plug-in does nothing.",a.from_string(o),a}return p()(Notepad,[{key:"_complete",value:function _complete(){this._status=Xe.STATUS_FINALIZE,E()(O()(Notepad.prototype),"_complete",this).call(this)}},{key:"run",value:function run(){E()(O()(Notepad.prototype),"run",this).call(this),this._complete()}}]),Notepad}(K);function repeat_cycle_createSuper(t){var r=function repeat_cycle_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var Ve=function(t){j()(RepeatCycle,t);var r=repeat_cycle_createSuper(RepeatCycle);function RepeatCycle(t,i,o){var a;return c()(this,RepeatCycle),(a=r.call(this,t,i,o)).description="Optionally repeat a cycle from a loop",a.from_string(o),a}return p()(RepeatCycle,[{key:"_complete",value:function _complete(){this._status=Xe.STATUS_FINALIZE,E()(O()(RepeatCycle.prototype),"_complete",this).call(this)}},{key:"prepare",value:function prepare(){E()(O()(RepeatCycle.prototype),"prepare",this).call(this)}},{key:"run",value:function run(){E()(O()(RepeatCycle.prototype),"run",this).call(this);var t=this.syntax.compile_cond(this.vars.get("condition",void 0,!1));this._status!==Xe.STATUS_FINALIZE&&(!0===this.experiment._runner._pythonWorkspace._eval(t)&&(this.experiment.vars.repeat_cycle=1),this._complete())}}]),RepeatCycle}(K);function reset_feedback_createSuper(t){var r=function reset_feedback_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var Ye=function(t){j()(ResetFeedback,t);var r=reset_feedback_createSuper(ResetFeedback);function ResetFeedback(t,i,o){var a;return c()(this,ResetFeedback),(a=r.call(this,t,i,o)).description='Resets the feedback variables, such as "avg_rt" and "acc"',a.from_string(o),a}return p()(ResetFeedback,[{key:"_complete",value:function _complete(){this._status=Xe.STATUS_FINALIZE,E()(O()(ResetFeedback.prototype),"_complete",this).call(this)}},{key:"run",value:function run(){E()(O()(ResetFeedback.prototype),"run",this).call(this),this._status!==Xe.STATUS_FINALIZE&&(this.experiment.reset_feedback(),this._complete())}}]),ResetFeedback}(K);function touch_response_createSuper(t){var r=function touch_response_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var Ge=function(t){j()(TouchResponse,t);var r=touch_response_createSuper(TouchResponse);function TouchResponse(t,i,o){var a;return c()(this,TouchResponse),(a=r.call(this,t,i,o)).description="A grid-based response item, convenient for touch screens",a}return p()(TouchResponse,[{key:"reset",value:function reset(){E()(O()(TouchResponse.prototype),"reset",this).call(this),this.vars.set("allowed_responses",null),this.vars._ncol=2,this.vars._nrow=1}},{key:"prepare",value:function prepare(){this.experiment.vars.correct=-1,E()(O()(TouchResponse.prototype),"prepare",this).call(this)}},{key:"process_response_mouseclick",value:function process_response_mouseclick(t){this.experiment._start_response_interval=this.sri,this.experiment._end_response_interval=t.rtTime,this.set_mouse_coordinates(t.event.clientX,t.event.clientY),this.col=Math.floor((this.experiment.vars.cursor_x+this.experiment.vars.width/2)/(this.experiment.vars.width/this.vars._ncol)),this.row=Math.floor((this.experiment.vars.cursor_y+this.experiment.vars.height/2)/(this.experiment.vars.height/this.vars._nrow)),this.cell=this.row*this.vars._ncol+this.col+1,this.experiment.vars.response=this.cell,this.synonyms=[this.experiment.vars.get("response").toString()],this.response_bookkeeping()}}]),TouchResponse}(Ie),$e=(i("./node_modules/core-js/modules/es.array.fill.js"),function(){function BaseElement(t,r,i){c()(this,BaseElement),this.canvas=t.canvas,this.defaults=i,this.defaults.show_if="always",this.defaults.z_index=0,this.experiment=t.experiment,this.fix_coordinates="yes"===t.vars.uniform_coordinates,this.name=t.name,this.only_keywords=!1,this.pool=t.experiment.pool,this.properties={},this.sketchpad=t,this.syntax=t.syntax,this.vars=t.vars,this._properties=null,this.from_string(r)}return p()(BaseElement,[{key:"from_string",value:function from_string(t){this.properties=this.sketchpad.syntax.parse_cmd(t)[2]}},{key:"z_index",value:function z_index(){return this.properties.z_index}},{key:"eval_properties",value:function eval_properties(){var t=this,r=this.experiment.vars.width/2,i=this.experiment.vars.height/2;this._properties=Object.entries(this.properties).reduce((function(o,a){var u=v()(a,2),l=u[0],_=u[1],c=t.syntax.eval_text(_,t.vars,!1);return["x","x1","x2"].includes(l)&&(c=Math.round(Number(c)+r)),["y","y1","y2"].includes(l)&&(c=Math.round(Number(c)+i)),o[l]=c,o}),{})}},{key:"is_shown",value:function is_shown(){return this.experiment.python_workspace.self=this.sketchpad,this.experiment.python_workspace._eval(this.experiment.syntax.compile_cond(this.properties.show_if))}},{key:"draw",value:function draw(){this.eval_properties()}}]),BaseElement}()),Je=i("./src/js/osweb/backends/styles.js");function arrow_createSuper(t){var r=function arrow_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}function circle_createSuper(t){var r=function circle_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}function ellipse_createSuper(t){var r=function ellipse_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}function fixdot_createSuper(t){var r=function fixdot_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}function gabor_createSuper(t){var r=function gabor_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}function image_createSuper(t){var r=function image_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}function line_createSuper(t){var r=function line_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}function noise_createSuper(t){var r=function noise_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}function rect_createSuper(t){var r=function rect_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}function textline_createSuper(t){var r=function textline_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var Ze={loop:de,sequence:ve,sketchpad:Ee,feedback:Re,inline_script:je,inline_javascript:Te,inline_html:Ue,keyboard_response:Ce,mouse_response:Ie,logger:Oe,sampler:Pe,synth:Fe,coroutines:be,advanced_delay:De,form_consent:Ne,form_multiple_choice:He,form_text_display:Be,form_text_input:ze,media_player_mpy:We,notepad:qe,repeat_cycle:Ve,reset_feedback:Ye,touch_response:Ge,arrow:function(t){j()(Arrow,t);var r=arrow_createSuper(Arrow);function Arrow(t,i){c()(this,Arrow);var o={arrow_body_length:.8,arrow_body_width:.5,arrow_head_width:30,fill:1};return o.color=t.vars.get("foreground"),o.penwidth=1,o.x1=null,o.y1=null,o.x2=null,o.y2=null,r.call(this,t,i,o)}return p()(Arrow,[{key:"draw",value:function draw(){E()(O()(Arrow.prototype),"draw",this).call(this);var t=new Je.a;t.background_color=this._properties.color,t.color=this._properties.color,t.fill=this._properties.fill,t.penwidth=this._properties.penwidth,this.sketchpad.canvas.arrow(this._properties.x1,this._properties.y1,this._properties.x2,this._properties.y2,this._properties.arrow_body_width,this._properties.arrow_body_length,this._properties.arrow_head_width,t)}}]),Arrow}($e),circle:function(t){j()(Circle,t);var r=circle_createSuper(Circle);function Circle(t,i){c()(this,Circle);var o={};return o.color=t.vars.get("foreground"),o.fill=0,o.penwidth=1,o.x=null,o.y=null,o.r=null,r.call(this,t,i,o)}return p()(Circle,[{key:"draw",value:function draw(){E()(O()(Circle.prototype),"draw",this).call(this);var t=new Je.a;t.color=this._properties.color,t.fill=this._properties.fill,t.penwidth=this._properties.penwidth,this.sketchpad.canvas.circle(this._properties.x,this._properties.y,this._properties.r,t)}}]),Circle}($e),ellipse:function(t){j()(Ellipse,t);var r=ellipse_createSuper(Ellipse);function Ellipse(t,i){c()(this,Ellipse);var o={fill:1,color:t.vars.get("foreground"),penwidth:1,x:null,y:null,w:null,h:null};return r.call(this,t,i,o)}return p()(Ellipse,[{key:"draw",value:function draw(){E()(O()(Ellipse.prototype),"draw",this).call(this);var t=new Je.a;t.background_color=this._properties.color,t.color=this._properties.color,t.fill=this._properties.fill,t.penwidth=this._properties.penwidth,this.sketchpad.canvas.ellipse(Number(this._properties.x),Number(this._properties.y),Number(this._properties.w),Number(this._properties.h),t)}}]),Ellipse}($e),fixdot:function(t){j()(Fixdot,t);var r=fixdot_createSuper(Fixdot);function Fixdot(t,i){c()(this,Fixdot);var o={};return o.color=t.vars.get("foreground"),o.style="default",o.x=null,o.y=null,r.call(this,t,i,o)}return p()(Fixdot,[{key:"draw",value:function draw(){E()(O()(Fixdot.prototype),"draw",this).call(this);var t=new Je.a(this.sketchpad);t.color=this._properties.color,this.sketchpad.canvas.fixdot(this._properties.x,this._properties.y,this._properties.style,t)}}]),Fixdot}($e),gabor:function(t){j()(Gabor,t);var r=gabor_createSuper(Gabor);function Gabor(t,i){c()(this,Gabor);var o={bgmode:"avg",color1:"white",color2:"black",env:"gaussian",freq:1,orient:0,phase:0,size:96,stdev:12,x:null,y:null};return r.call(this,t,i,o)}return p()(Gabor,[{key:"draw",value:function draw(){E()(O()(Gabor.prototype),"draw",this).call(this),this.sketchpad.canvas.gabor(this._properties.x,this._properties.y,this._properties.orient,this._properties.freq,this._properties.env,this._properties.size,this._properties.stdev,this._properties.phase,this._properties.color1,this._properties.color2,this._properties.bgmode)}}]),Gabor}($e),image:function(t){j()(ImageElement,t);var r=image_createSuper(ImageElement);function ImageElement(t,i){var o;c()(this,ImageElement);var a={center:1,file:null,scale:1,rotation:0,x:null,y:null};return(o=r.call(this,t,i,a))._file=null,o}return p()(ImageElement,[{key:"draw",value:function draw(){E()(O()(ImageElement.prototype),"draw",this).call(this),this.sketchpad.canvas.image(this._properties.file,this._properties.center,this._properties.x,this._properties.y,this._properties.scale,this._properties.rotation)}}]),ImageElement}($e),line:function(t){j()(Line,t);var r=line_createSuper(Line);function Line(t,i){c()(this,Line);var o={};return o.color=t.vars.get("foreground"),o.penwidth=1,o.x1=null,o.y1=null,o.x2=null,o.y2=null,r.call(this,t,i,o)}return p()(Line,[{key:"draw",value:function draw(){E()(O()(Line.prototype),"draw",this).call(this);var t=new Je.a;t.color=this._properties.color,t.penwidth=this._properties.penwidth,this.sketchpad.canvas.line(this._properties.x1,this._properties.y1,this._properties.x2,this._properties.y2,t)}}]),Line}($e),noise:function(t){j()(Noise,t);var r=noise_createSuper(Noise);function Noise(t,i){c()(this,Noise);var o={color1:"white",color2:"black",env:"gaussian",size:96,stdev:12,x:null,y:null,bgmode:"avg"};return r.call(this,t,i,o)}return p()(Noise,[{key:"draw",value:function draw(){E()(O()(Noise.prototype),"draw",this).call(this),this.sketchpad.canvas.noise(this._properties.x,this._properties.y,this._properties.env,this._properties.size,this._properties.stdev,this._properties.color1,this._properties.color2,this._properties.bgmode)}}]),Noise}($e),rect:function(t){j()(Rect,t);var r=rect_createSuper(Rect);function Rect(t,i){c()(this,Rect);var o={fill:1};return o.color=t.vars.get("foreground"),o.penwidth=1,o.x=null,o.y=null,o.w=null,o.h=null,r.call(this,t,i,o)}return p()(Rect,[{key:"draw",value:function draw(){E()(O()(Rect.prototype),"draw",this).call(this);var t=new Je.a;t.fill=this._properties.fill,t.color=this._properties.color,t.background_color=this._properties.color,t.penwidth=this._properties.penwidth,this.sketchpad.canvas.rect(this._properties.x,this._properties.y,this._properties.w,this._properties.h,t)}}]),Rect}($e),textline:function(t){j()(Textline,t);var r=textline_createSuper(Textline);function Textline(t,i){c()(this,Textline);var o={center:1};return o.color=t.vars.get("foreground"),o.font_family=t.vars.get("font_family"),o.font_size=t.vars.get("font_size"),o.font_bold=t.vars.get("font_bold"),o.font_italic=t.vars.get("font_italic"),o.html="yes",o.text=null,o.x=null,o.y=null,r.call(this,t,i,o)}return p()(Textline,[{key:"draw",value:function draw(){E()(O()(Textline.prototype),"draw",this).call(this);var t=this._properties.text,r=new Je.a;r.color=this._properties.color,r.font_family=this._properties.font_family,r.font_size=Number(this._properties.font_size),r.font_italic="yes"===this._properties.font_italic,r.font_bold="yes"===this._properties.font_bold,r.font_underline="yes"===this._properties.font_underline,this.sketchpad.canvas.text(t,this._properties.center,this._properties.x,this._properties.y,this._properties.html,r)}}]),Textline}($e)},Xe={PRESSES_ONLY:1,RELEASES_ONLY:2,PRESSES_AND_RELEASES:3,RESPONSE_NONE:0,RESPONSE_DURATION:1,RESPONSE_KEYBOARD:2,RESPONSE_MOUSE:3,RESPONSE_SOUND:4,RESPONSE_AUTOKEYBOARD:5,RESPONSE_AUTOMOUSE:6,STATUS_NONE:0,STATUS_BUILD:1,STATUS_INITIALIZE:2,STATUS_EXECUTE:3,STATUS_FINALIZE:4,TIMER_NONE:0,TIMER_WAIT:1,TIMER_EXIT:2,TIMER_PAUSE:3,TIMER_RESUME:4,TIMER_DONE:5,TIMER_BREAK:6,TIMER_ERROR:7,TIMER_FORM:8};function debugger_createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function debugger_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return debugger_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return debugger_arrayLikeToArray(t,r)}(t))){var r=0,i=function F(){};return{s:i,n:function n(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,u=!0,l=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return u=t.done,t},e:function e(t){l=!0,a=t},f:function f(){try{u||null==o.return||o.return()}finally{if(l)throw a}}}}function debugger_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var Qe=function(){function Debugger(t){c()(this,Debugger),this._runner=t,this.enabled=!0,this.error=!1,this.messageLog=[]}return p()(Debugger,[{key:"_initialize",value:function _initialize(){this.messageLog=[]}},{key:"_finalize",value:function _finalize(){!0===this.enabled&&console.log(this.messageLog),this.messageLog=[]}},{key:"addError",value:function addError(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.error=!0,this._runner._events.state=Xe.TIMER_ERROR,console.error("OSWeb has stopped running due to a fatal error."),ae()(r)&&!0===r.notify&&ge()(this._runner._onError)){var i=r.url||null;this._runner._onError(t,i)}var o,a=[],u=debugger_createForOfIteratorHelper(this._runner._itemStack._items);try{for(u.s();!(o=u.n()).done;){var l=o.value;a.push(l.item+"["+l.phase+"]")}}catch(t){u.e(t)}finally{u.f()}throw console.log("item-stack: "+a.join(".")),t}},{key:"addMessage",value:function addMessage(t){this.messageLog.push(t),!0===this.enabled&&console.log(t)}},{key:"msg",value:function msg(t){this.addMessage(t)}}]),Debugger}(),et=(i("./node_modules/core-js/modules/es.string.match.js"),function(){function Convertor(t){c()(this,Convertor),this.item=null,this.runner=t,this.variable=null,this.variabelName=""}return p()(Convertor,[{key:"parseValue",value:function parseValue(t){return t.length>=4&&'"'===t.substr(0,1)&&'"'===t.substr(t.length-1,1)?t.substr(1,t.length-2):t}},{key:"parseLine",value:function parseLine(t){var r=t.match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g);if(null===this.variable)if(null!==r)switch(r[0]){case"define":this.item=this.runner._itemStore.newItem(r[1],r[2],"");break;case"draw":for(var i=this.runner._itemStore._newElementClass(r[1],this.item,""),o=2;o<r.length;o++){var a=r[o].split("=",2);i.properties[a[0]]=a[1]}this.item.elements.push(i);break;case"run":"sequence"===this.item.type?this.item.items.push({item:r[1],cond:r[2]}):this.item.vars.item=r[1];break;case"set":this.item.vars[r[1]]=this.parseValue(r[2]);break;case"setcycle":var u=this.parseValue(r[3]);"="===u[0]?null!==(u=this.runner._pythonParser._prepare(u.slice(1)))&&(u=u.body[0]):u=H()(u)?Number(u):u,void 0===this.item.orig_matrix[r[1]]&&(this.item.orig_matrix[r[1]]={}),this.item.orig_matrix[r[1]][r[2]]=u;break;case"widget":r.shift(),this.item._widgets.push(r);break;default:r[0].length>5&&"__"===r[0].substr(0,2)&&"__"===r[0].substr(-2)&&(this.variableName=r[0].substr(2,r[0].length-4),this.variable=[])}else this.item=this.runner._experiment;else null!==r&&"__end__"===r[0]?(this.item.vars[this.variableName]=this.variable,this.variable=null):this.variable.push(t)}},{key:"parseScript",value:function parseScript(t){if(this.item=this.runner._experiment,null!==t)for(var r=t.split("\n"),i=0;i<r.length;i++)this.parseLine(r[i])}}]),Convertor}()),tt=(i("./node_modules/core-js/modules/es.array.index-of.js"),function(){function Events(t){c()(this,Events),this._currentItem=null,this._keyDownEvent=null,this._keyDownHandler=null,this._keyPressMode=Xe.PRESSES_ONLY,this._keyUpHandler=null,this._mouseDownEvent=null,this._mouseDownHandler=null,this._mouseMoveEvent=null,this._mouseMoveHandler=null,this._mousePressMode=Xe.PRESSES_ONLY,this._mouseUpHandler=null,this._runner=t,this._responseGiven=!1,this._responseList=null,this._responseType=Xe.RESPONSE_NONE,this._soundHasEnded=!1,this._state=Xe.TIMER_NONE,this._statePrevious=Xe.TIMER_NONE,this._timeHandler=null,this._timeOut=-1,this._timeStamp=-1,this._videoHasEnded=!1,this._KEY_CODES=["","","","","","","help","","backspace","tab","","","clear","enter","enter_special","","shift","ctrl","alt","pause","caps","","","","","","","escape","","","","","space","page up","page down","end","home","left","up","right","down","select","print","execute","print screen","insert","delete","","0","1","2","3","4","5","6","7","8","9",":",";","<","=",">","?","@","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","left meta","right meta","menu","","","kp0","kp1","kp2","kp3","kp4","kp5","kp6","kp7","kp8","kp9","kp_multiply","kp_plus","","kp_minus","kp_period","kp_divide","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","","","","","","","","","","","","","","","","","","","","","numlock","scrollock","","","","","","","","","","","","","","","^","!",'"',"#","$","%","&","_","(",")","*","+","|","_","{","}","~","","","","","","","","","",";","=",",","-",".","/","`","","","","","","","","","","","","","","","","","","","","","","","","","","","[","\\","]","'","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],this._KEY_SHIFTCODES=["","","","","","","","","","","","","","","","","","","","pause","","","","","","","","","","","","","","","","","","","","","","","","","","","","",")","!","@","#","$","%","^","&","*","(","",":","","+","","","","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","y","z","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","_","","","","","","","","","","","","","","","<","",">","?","~","","","","","","","","","","","","","","","","","","","","","","","","","","","{","|","}",'"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]}return p()(Events,[{key:"_initialize",value:function _initialize(){this._keyDownHandler=this._keyDown.bind(this),this._keyUpHandler=this._keyUp.bind(this),window.addEventListener("keydown",this._keyDownHandler),window.addEventListener("keyup",this._keyUpHandler),this._mouseDownHandler=this._mouseDown.bind(this),this._mouseMoveHandler=this._mouseMove.bind(this),this._mouseUpHandler=this._mouseUp.bind(this),this._touchStartHandler=this._touchStart.bind(this),this._runner._renderer.view.addEventListener("mousedown",this._mouseDownHandler),this._runner._renderer.view.addEventListener("mousemove",this._mouseMoveHandler),this._runner._renderer.view.addEventListener("mouseup",this._mouseUpHandler),this._runner._renderer.view.addEventListener("touchstart",this._touchStartHandler),this._currentItem=this._runner._experiment,this._state=Xe.TIMER_NONE,this._timeHandler=new d.f,this._timeHandler.add(this._time.bind(this)),this._timeHandler.start()}},{key:"_finalize",value:function _finalize(){window.removeEventListener("keydown",this._keyDownHandler),window.removeEventListener("keyup",this._keyUpHandler),this._runner._renderer.view.removeEventListener("mousedown",this._mouseDownHandler),this._runner._renderer.view.removeEventListener("mousemove",this._mouseMoveHandler),this._runner._renderer.view.removeEventListener("mouseup",this._mouseUpHandler),this._runner._renderer.view.removeEventListener("touchstart",this._touchStartHandler),this._timeHandler.stop(),this._timeHandler.remove(this._time),this._currentItem=null,this._mouseDownEvent=null,this._mouseMoveEvent=null,this._responseList=null,this._timeHandler=null}},{key:"_convertKeyCode",value:function _convertKeyCode(t){return!0===t.shiftKey&&16!==t.keyCode?this._KEY_SHIFTCODES[t.keyCode]:!0===t.shiftKey&&16===t.keyCode?1===t.location?"lshift":"rshift":!0===t.ctrlKey&&17===t.keyCode?1===t.location?"lctrl":"rctrl":!0===t.altKey&&18===t.keyCode?1===t.location?"lalt":"ralt":this._KEY_CODES[t.keyCode]}},{key:"_keyDown",value:function _keyDown(t){if(!t.repeat)if(this._keyDownEvent={event:t,rtTime:this._runner._experiment.clock.time()},27===t.keyCode&&this._state!==Xe.TIMER_PAUSE)this._statePrevious=this._state,this._state=Xe.TIMER_PAUSE,this._runner._screen._showPauseScreen();else if(this._state===Xe.TIMER_WAIT&&(this._keyPressMode===Xe.PRESSES_ONLY||this._keyPressMode===Xe.PRESSES_AND_RELEASES))return this._processKeyboardEvent(t,1)}},{key:"_keyUp",value:function _keyUp(t){if(!t.repeat)return this._state!==Xe.TIMER_WAIT||this._keyPressMode!==Xe.RELEASES_ONLY&&this._keyPressMode!==Xe.PRESSES_AND_RELEASES?void 0:this._processKeyboardEvent(t,0)}},{key:"_processKeyboardEvent",value:function _processKeyboardEvent(t,r){var i={event:t,rtTime:this._runner._experiment.clock.time(),state:r,type:Xe.RESPONSE_KEYBOARD};return i.resp=this._convertKeyCode(t),this._responseType===Xe.RESPONSE_KEYBOARD&&(null===this._responseList||this._responseList.indexOf(i.resp)>=0)&&(null!==this._currentItem&&this._currentItem._update(i),this._responseGiven=!0),i}},{key:"_mouseContext",value:function _mouseContext(t){return t.preventDefault(),!1}},{key:"_mouseMove",value:function _mouseMove(t){this._mouseMoveEvent={event:t,rtTime:this._runner._experiment.clock.time()}}},{key:"_touchStart",value:function _touchStart(t){t.button=0,t.clientX=t.changedTouches[0].clientX,t.clientY=t.changedTouches[0].clientY,this._mouseDown(t)}},{key:"_mouseDown",value:function _mouseDown(t){if(this._mouseDownEvent={event:t,rtTime:this._runner._experiment.clock.time()},this._state===Xe.TIMER_WAIT&&(this._mousePressMode===Xe.PRESSES_ONLY||this._mousePressMode===Xe.PRESSES_AND_RELEASES))return this._processMouseEvent(t,1)}},{key:"_mouseUp",value:function _mouseUp(t){this._state!==Xe.TIMER_WAIT||this._mousePressMode!==Xe.RELEASES_ONLY&&this._mousePressMode!==Xe.PRESSES_AND_RELEASES||this._processMouseEvent(t,0)}},{key:"_processMouseEvent",value:function _processMouseEvent(t,r){var i={event:t,rtTime:this._runner._experiment.clock.time(),state:r,type:Xe.RESPONSE_MOUSE};return i.resp=String(t.button+1),this._responseType===Xe.RESPONSE_MOUSE&&(null===this._responseList||this._responseList.indexOf(i.resp)>=0)&&(null!==this._currentItem&&this._currentItem._update(i),this._responseGiven=!0),i}},{key:"_audioEnded",value:function _audioEnded(t){"sound"===t.duration&&this.proceed()}},{key:"_videoEnded",value:function _videoEnded(t){"video"===this.duration&&(this._experiment._runner._events._videoHasEnded=!0)}},{key:"_videoPlay",value:function _videoPlay(t){}},{key:"_time",value:function _time(t){switch(this._state){case Xe.TIMER_NONE:break;case Xe.TIMER_WAIT:this._timeStamp=this._currentItem.clock.time(),-1===this._timeOut&&(!0===this._responseGiven||!0===this._videoHasEnded)||this._timeOut>0&&(this._responseType===Xe.RESPONSE_KEYBOARD||this._responseType===Xe.RESPONSE_MOUSE)&&!0===this._responseGiven||this._timeOut>0&&this._timeStamp-this._currentItem.experiment.vars.get("time_"+this._currentItem.name)>this._timeOut?this.proceed():this._currentItem._update(null);break;case Xe.TIMER_PAUSE:case Xe.TIMER_RESUME:break;case Xe.TIMER_BREAK:case Xe.TIMER_EXIT:this._state=Xe.TIMER_NONE,this._runner._finalize();break;case Xe.TIMER_FORM:this._currentItem._update(null)}}},{key:"_run",value:function _run(t,r,i){this._responseList=i,this._responseType=r,this._timeOut=t,this._responseGiven=!1,this._soundHasEnded=!1,this._state=Xe.TIMER_WAIT,this._videoHasEnded=!1}},{key:"proceed",value:function proceed(){this._state=Xe.TIMER_NONE,this._runner._itemStack.pop(),this._currentItem._complete()}}]),Events}()),rt=function(){function Parameters(t){c()(this,Parameters),this._itemCounter=0,this._parameters=[],this._runner=t}return p()(Parameters,[{key:"_initialize",value:function _initialize(){if(null!==this._runner._subject)this._runner._experiment.set_subject(this._runner._subject),this._runner._screen._setupClickScreen(this._runner._welcomeText);else{this._runner._screen._updateIntroScreen("Retrieving input parameters.");this._parameters.push({dataType:"number",defaultValue:"0",name:"subject_nr",title:"Starting the experiment",prompt:"Please enter the subject number",promptEnabled:!0}),this._processParameters()}}},{key:"_processParameters",value:function _processParameters(){this._itemCounter<this._parameters.length?this._processParameter(this._parameters[this._itemCounter]):this._transferParameters()}},{key:"_onParamConfirm",value:function _onParamConfirm(t,r){t.response=r,this._itemCounter++,this._processParameters()}},{key:"_onParamCancel",value:function _onParamCancel(){this._runner._exit()}},{key:"_processParameter",value:function _processParameter(t){if(!0===t.promptEnabled)if(ge()(this._runner._prompt))this._runner._prompt(t.title,t.prompt,t.defaultValue,t.dataType,this._onParamConfirm.bind(this,t),this._onParamCancel.bind(this));else{var r=window.prompt(t.prompt,t.defaultValue);null===r?this._onParamCancel():this._onParamConfirm(t,r)}else t.response=t.defaultValue,this._itemCounter++,this._processParameters()}},{key:"_transferParameters",value:function _transferParameters(){for(var t=0;t<this._parameters.length;t++)"subject_nr"===this._parameters[t].name?this._runner._experiment.set_subject(this._parameters[t].response):this._runner._experiment.vars.set(this._parameters[t].name,this._parameters[t].response);this._runner._screen._setupClickScreen(this._runner._welcomeText)}}]),Parameters}();function screen_createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function screen_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return screen_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return screen_arrayLikeToArray(t,r)}(t))){var r=0,i=function F(){};return{s:i,n:function n(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,u=!0,l=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return u=t.done,t},e:function e(t){l=!0,a=t},f:function f(){try{u||null==o.return||o.return()}finally{if(l)throw a}}}}function screen_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var nt=function(){function Screen(t){c()(this,Screen),this._runner=t,this._active=!0,this._click=!0,this._container=null,this._exit=!1}return p()(Screen,[{key:"screenCenter",value:function screenCenter(){return{x:this._runner._renderer.width/2,y:this._runner._renderer.height/2}}},{key:"_fullScreenInit",value:function _fullScreenInit(){var t=this;if(!0===this._runner._fullScreen){var r=this._runner._container;r.requestFullscreen?(document.addEventListener("fullscreenchange",(function(r){t._fullScreenChanged(r)})),document.addEventListener("fullscreenerror",(function(r){t._fullScreenError(r)})),r.requestFullscreen()):r.webkitRequestFullscreen?(document.addEventListener("webkitfullscreenchange",(function(r){t._fullScreenChanged(r)})),document.addEventListener("webkitfullscreenerror",(function(r){t._fullScreenError(r)})),r.webkitRequestFullscreen()):r.mozRequestFullScreen?(document.addEventListener("mozfullscreenchange",(function(r){t._fullScreenChanged(r)})),document.addEventListener("mozfullscreenerror",(function(r){t._fullScreenError(r)})),r.mozRequestFullScreen()):r.msRequestFullscreen&&(document.addEventListener("MSFullscreenChange",(function(r){t._fullScreenChanged(r)})),document.addEventListener("MSFullscreenError",(function(r){t._fullScreenError(r)})),r.msRequestFullscreen())}}},{key:"_fullScreenExit",value:function _fullScreenExit(){!0===this._runner._fullScreen&&(this._exit=!0,document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen())}},{key:"_fullScreenChanged",value:function _fullScreenChanged(){if(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)switch(this._runner._scaleMode){case"noScale":this._runner._renderer.view.style.top="0px",this._runner._renderer.view.style.bottom="0px",this._runner._renderer.view.style.left="0px",this._runner._renderer.view.style.right="0px",this._runner._renderer.view.style.right="0px",this._runner._renderer.view.style.margin="auto",this._runner._renderer.view.style.display="block",this._runner._renderer.view.style.position="absolute",this._runner._renderer.render(this._runner._experiment._currentCanvas._container);break;case"showAll":if(this._runner._renderer.view.style.top="0px",this._runner._renderer.view.style.bottom="0px",this._runner._renderer.view.style.left="0px",this._runner._renderer.view.style.right="0px",this._runner._renderer.view.style.right="0px",this._runner._renderer.view.style.margin="auto",this._runner._renderer.view.style.display="block",this._runner._renderer.view.style.position="absolute",this._runner._container.clientWidth-this._runner._experiment.vars.width>this._runner._container.clientHeight-this._runner._experiment.vars.height){var t=this._runner._container.clientHeight/this._runner._experiment.vars.height;this._runner._renderer.resize(Math.round(this._runner._experiment.vars.width*t),this._runner._container.clientHeight),this._runner._experiment._scale_x=Math.round(this._runner._experiment.vars.width*t)/this._runner._experiment.vars.width,this._runner._experiment._scale_y=this._runner._container.clientHeight/this._runner._experiment.vars.height}else{var r=this._runner._container.clientWidth/this._runner._experiment.vars.width;this._runner._renderer.resize(this._runner._container.clientWidth,Math.round(this._runner._experiment.vars.height*r)),this._runner._experiment._scale_x=this._runner._container.clientWidth/this._runner._experiment.vars.width,this._runner._experiment._scale_y=Math.round(this._runner._experiment.vars.height*r)/this._runner._experiment.vars.height}this._runner._experiment._currentCanvas._container.scale.x=this._runner._experiment._scale_x,this._runner._experiment._currentCanvas._container.scale.y=this._runner._experiment._scale_y,this._runner._renderer.render(this._runner._experiment._currentCanvas._container);break;case"exactFit":this._runner._experiment._scale_x=this._runner._container.clientWidth/this._runner._experiment.vars.width,this._runner._experiment._scale_y=this._runner._container.clientHeight/this._runner._experiment.vars.height,this._runner._renderer.resize(this._runner._container.clientWidth,this._runner._container.clientHeight),this._runner._experiment._currentCanvas._container.scale.x=this._runner._experiment._scale_x,this._runner._experiment._currentCanvas._container.scale.y=this._runner._experiment._scale_y,this._runner._renderer.render(this._runner._experiment._currentCanvas._container)}else!1===this._exit&&(this._runner._experiment._scale_x=1,this._runner._experiment._scale_y=1,this._runner._renderer.resize(this._runner._experiment.vars.width,this._runner._experiment.vars.height),this._runner._experiment._currentCanvas._container.scale.x=1,this._runner._experiment._currentCanvas._container.scale.y=1,this._runner._renderer.render(this._runner._experiment._currentCanvas._container),ge()(this._runner._confirm)&&this._runner._confirm("Leaving full-screen mode, pausing experiment.","Please press ok the resume the experiment otherwise cancel to stop.",this._onFullScreenConfirm.bind(this),this._onFullScreenCancel.bind(this)))}},{key:"_fullScreenError",value:function _fullScreenError(){this._runner.debugger.addError("Could not start full-screen mode, experiment stopped.")}},{key:"_onFullScreenConfirm",value:function _onFullScreenConfirm(){var t=this._runner._container;t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen()}},{key:"_onFullScreenCancel",value:function _onFullScreenCancel(){this._runner._finalize()}},{key:"_setupIntroScreen",value:function _setupIntroScreen(t){if(!0===this._active){this._introScreen=new d.a;var r=this.screenCenter(),i=void 0===t?"img/opensesame.png":t,o=d.c.from(i),a=new d.d("OSWeb",{fontFamily:"Arial",fontSize:26,fill:"#FFFFFF"}),u=new d.d(Ht,{fontFamily:"Arial",fontSize:16,fill:"#FFFFFF"}),l=new d.d("Copyright Jaap Bos, Daniel Schreij & Sebastiaan Mathot, 2016 - ".concat((new Date).getFullYear()),{fontFamily:"Arial",fontSize:12,fill:"#FFFFFF"});o.width=o.height=150,o.position.set(r.x-o.width/2,50),a.position.set(r.x-a.width/2,215),u.position.set(r.x-u.width/2,250),l.position.set(r.x-l.width/2,2*r.y-2*l.height),this._statusText=new d.d("",{fontFamily:"Arial",fontSize:18,fill:"#FFFFFF"}),this._statusText.position.set(r.x-this._statusText.width/2,r.y),this._introScreen.addChild(o,a,u,l,this._statusText),this._runner._renderer.render(this._introScreen)}}},{key:"_setupClickScreen",value:function _setupClickScreen(t){if(!0===this._click){void 0!==t&&0!==t.length||(t="\n    Your participation in this experiment should be anonymous.\n        Never provide any personal or sensitive information\n            (e.g. credit card or social security numbers).\n\n                    Click here with the mouse to begin."),this._updateIntroScreen(t);var r=function(t){var i,o=screen_createForOfIteratorHelper(this._runner._experiment.pool._items);try{for(o.s();!(i=o.n()).done;){var a=i.value;"audio"===a.type&&(a.data.volume=0,a.data.play(),a.data.pause(),a.data.currentTime=0,a.data.volume=1)}}catch(t){o.e(t)}finally{o.f()}this._runner._renderer.view.removeEventListener("click",r),this._runner._renderer.view.removeEventListener("touchstart",r),this._clearIntroScreen(),this._runner._initialize()}.bind(this);this._runner._renderer.view.addEventListener("click",r,!1),this._runner._renderer.view.addEventListener("touchstart",r,!1)}else this._clearIntroScreen(),this._runner._initialize()}},{key:"_clearIntroScreen",value:function _clearIntroScreen(){if(!0===this._active){for(var t=this._introScreen.children.length-1;t>=0;t--)this._introScreen.removeChild(this._introScreen.children[t]);this._runner._renderer.render(this._introScreen)}}},{key:"_updateProgressBar",value:function _updateProgressBar(t){var r=this.screenCenter().y+40;if(!0===this._active)switch(t){case-1:this._progressBarOuter=new d.b,this._progressBarOuter.lineStyle(1,16777215,1),this._progressBarOuter.drawRect(200,r,400,20),this._progressBarOuter.x=0,this._progressBarOuter.y=0,this._progressBarInner=new d.b,this._progressBarInner.lineStyle(1,16777215,1),this._progressBarInner.drawRect(202,r+2,1,16),this._progressBarInner.x=0,this._progressBarInner.y=0,this._introScreen.addChild(this._progressBarInner),this._introScreen.addChild(this._progressBarOuter),this._runner._renderer.render(this._introScreen);break;case 100:this._introScreen.removeChild(this._progressBarInner),this._introScreen.removeChild(this._progressBarOuter),this._runner._renderer.render(this._introScreen);break;default:this._progressBarOuter.beginFill(16777215),this._progressBarOuter.drawRect(202,r+2,Math.round(396*t),16),this._progressBarOuter.endFill(),this._runner._renderer.render(this._introScreen)}}},{key:"_updateIntroScreen",value:function _updateIntroScreen(t){if(!0===this._active){var r=this.screenCenter();this._statusText.text=t.replace(/<br \/>/g,"\n").replace(/&#39;/g,"'").replace(/&#34;/g,'"'),this._statusText.position.set(r.x-this._statusText.width/2,r.y),this._runner._renderer.render(this._introScreen)}}},{key:"_showPauseScreen",value:function _showPauseScreen(){ge()(this._runner._confirm)&&this._runner._confirm("Esc key pressed, pausing experiment.","Please press ok the resume the experiment otherwise cancel to stop.",this._onPauseScreenConfirm.bind(this),this._onPauseScreenCancel.bind(this))}},{key:"_onPauseScreenConfirm",value:function _onPauseScreenConfirm(){this._runner._events._state=this._runner._events._statePrevious}},{key:"_onPauseScreenCancel",value:function _onPauseScreenCancel(){this._runner._finalize()}}]),Screen}(),st=function(){function Session(t){c()(this,Session),this._date=null,this._runner=t,this._session=null}return p()(Session,[{key:"_initialize",value:function _initialize(){this._runner._screen._updateIntroScreen("Retrieving session information."),this._getSessionInformation()}},{key:"_getSessionInformation",value:function _getSessionInformation(){this._date=new Date,this._session={browser:{codename:navigator.appCodeName,name:navigator.appName,version:navigator.appVersion},date:{startdate:("0"+this._date.getDate()).slice(-2)+"-"+("0"+this._date.getMonth()).slice(-2)+"-"+("0"+this._date.getFullYear()).slice(-2),starttime:("0"+this._date.getHours()).slice(-2)+":"+("0"+this._date.getMinutes()).slice(-2)+":"+("0"+this._date.getSeconds()).slice(-2),startdateUTC:("0"+this._date.getUTCDate()).slice(-2)+"-"+("0"+this._date.getUTCMonth()).slice(-2)+"-"+("0"+this._date.getUTCFullYear()).slice(-2)},experiment:{debug:0,parameters:0,pilot:0,taskname:0,taskversion:0},screen:{availableHeight:screen.availHeight,availableWidth:screen.availWidth,colorDepth:screen.colorDepth,height:screen.height,outerheight:window.outerheight,outerwidth:window.outerwidth,pixelDepth:screen.pixelDepth,screenX:window.screenX,screenY:window.screenY,width:screen.width},system:{os:navigator.platform}}}}]),Session}(),it=(i("./node_modules/core-js/modules/es.symbol.async-iterator.js"),i("./node_modules/core-js/modules/es.array.find-index.js"),i("./node_modules/core-js/modules/es.array.last-index-of.js"),i("./node_modules/core-js/modules/es.promise.js"),i("./node_modules/@babel/runtime/helpers/asyncIterator.js")),ot=i.n(it),at=i("./node_modules/webfontloader/webfontloader.js"),ut=i.n(at),lt=(i("./node_modules/core-js/modules/web.url.js"),i("./node_modules/pako/index.js")),_t=i.n(lt),ct=i("./node_modules/js-untar/build/dist/untar.js"),ht=i.n(ct),pt=function(){function FileStreamer(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:65536;c()(this,FileStreamer),this.file=t,this.offset=0,this.chunkSize=r,this.rewind()}return p()(FileStreamer,[{key:"rewind",value:function rewind(){this.offset=0}},{key:"isEndOfFile",value:function isEndOfFile(){return this.offset>=this.getFileSize()}},{key:"readBlock",value:function readBlock(){var t=this,r=new FileReader,i=this.file.slice(this.offset,this.offset+this.chunkSize);return new Promise((function(o,a){r.onloadend=function(r){var i=r.target;if(i.error)return a(i.error);t.offset+=i.result.byteLength,o({data:i.result,progress:Math.min(t.offset/t.file.size,1)})},r.readAsArrayBuffer(i)}))}},{key:"getFileSize",value:function getFileSize(){return this.file.size}}]),FileStreamer}();function decompress(t,r){return _decompress.apply(this,arguments)}function _decompress(){return(_decompress=l()(a.a.mark((function _callee(t,r){var i,o,u;return a.a.wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:i=new pt(t),o=new _t.a.Inflate;case 2:if(i.isEndOfFile()){a.next=12;break}return a.next=5,i.readBlock();case 5:if(u=a.sent,o.push(u.data,i.isEndOfFile()),!o.err){a.next=9;break}throw o.msg;case 9:ge()(r)&&r(u.progress),a.next=2;break;case 12:return a.abrupt("return",ht()(o.result.buffer));case 13:case"end":return a.stop()}}),_callee)})))).apply(this,arguments)}function readFileAsText(t){var r=new FileReader;return new Promise((function(i,o){r.onerror=function(){r.abort(),o(new DOMException("Problem parsing input file."))},r.onload=function(){i(r.result)},r.readAsText(t)}))}function parseUrl(t){try{var r=function getHost(){return"null"!==window.location.origin?window.location.origin:"http://nodejs.test"}();return new URL(t,r)}catch(t){return!1}}var dt=i("./node_modules/lodash/isObject.js"),ft=i.n(dt),mt=i("./node_modules/axios/index.js"),vt=i.n(mt),yt=function(){function Transfer(t){c()(this,Transfer),this._runner=t}var t,r,i,o,u,_;return p()(Transfer,[{key:"_readSource",value:(_=l()(a.a.mark((function _callee(t){var r,i,o;return a.a.wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:if(ie()(t)||ft()(t)&&t.constructor===File){a.next=2;break}throw new Error("No osexp source file defined.");case 2:if(t.constructor!==File){a.next=14;break}return a.prev=3,a.next=6,this._readOsexpFromFile(t);case 6:r=a.sent,a.next=12;break;case 9:throw a.prev=9,a.t0=a.catch(3),new Error("Could not read local osexp, ".concat(a.t0));case 12:a.next=38;break;case 14:if(!ie()(t)){a.next=38;break}if(!1===(i=parseUrl(t))){a.next=31;break}return a.prev=17,a.next=20,this.fetch(i.href);case 20:return o=a.sent,a.next=23,this._readOsexpFromFile(o);case 23:r=a.sent,a.next=29;break;case 26:throw a.prev=26,a.t1=a.catch(17),new Error("Could not read remote osexp, ".concat(a.t1));case 29:a.next=38;break;case 31:a.prev=31,r=this._processScript(t),a.next=38;break;case 35:throw a.prev=35,a.t2=a.catch(31),new Error("Could not read source string, ".concat(a.t2,"\n\n").concat(t));case 38:return a.next=40,this._readWebFonts();case 40:return a.abrupt("return",r);case 41:case"end":return a.stop()}}),_callee,this,[[3,9],[17,26],[31,35]])}))),function _readSource(t){return _.apply(this,arguments)})},{key:"_readExpFile",value:(u=l()(a.a.mark((function _callee2(t){return a.a.wrap((function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:if(![File,Blob].includes(t.constructor)){r.next=4;break}return r.next=3,readFileAsText(t);case 3:t=r.sent;case 4:return r.abrupt("return",this._processScript(t));case 5:case"end":return r.stop()}}),_callee2,this)}))),function _readExpFile(t){return u.apply(this,arguments)})},{key:"_readOsexpFromFile",value:(o=l()(a.a.mark((function _callee3(t){var r,i,o,u,l,_=this;return a.a.wrap((function _callee3$(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,this._readExpFile(t);case 3:return a.abrupt("return",a.sent);case 6:a.prev=6,a.t0=a.catch(0),this._runner._debugger.addMessage("Could not read osexp file as plain text: ".concat(a.t0.message,".\nFile is probably binary"));case 9:return a.next=11,decompress(t,(function(t){return _._runner._screen._updateProgressBar(t)}));case 11:if(r=a.sent,-1!==(i=r.findIndex((function(t){return"script.opensesame"===t.name})))){a.next=15;break}throw new Error("Could not locate experiment script");case 15:return o=r.splice(i,1)[0],a.next=18,this._readExpFile(o.blob);case 18:return u=a.sent,l=r.filter((function(t){return"0"===t.type})),a.next=22,this._processOsexpPoolItems(l);case 22:return a.abrupt("return",u);case 23:case"end":return a.stop()}}),_callee3,this,[[0,6]])}))),function _readOsexpFromFile(t){return o.apply(this,arguments)})},{key:"fetch",value:(i=l()(a.a.mark((function _callee4(t){var r,i,o=this;return a.a.wrap((function _callee4$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,vt.a.get(t,{responseType:"blob",onDownloadProgress:function onDownloadProgress(t){t.lengthComputable&&o._runner._screen._updateProgressBar(t.loaded/t.total)}});case 2:return r=a.sent,/Edge/.test(navigator.userAgent)?(i=new Blob([r.data])).name="downloaded.osexp":i=new File([r.data],"downloaded.osexp"),a.abrupt("return",i);case 5:case"end":return a.stop()}}),_callee4)}))),function fetch(t){return i.apply(this,arguments)})},{key:"_processScript",value:function _processScript(t){if("---"!==t.substr(0,3))throw new Error("Specified script file is not valid OpenSesame script");return this._runner._screen._updateProgressBar(100),t}},{key:"_processOsexpPoolItems",value:(r=l()(a.a.mark((function _callee5(t){var r,i,o,u,l,_,c,h;return a.a.wrap((function _callee5$(a){for(;;)switch(a.prev=a.next){case 0:r=q()({currentIndex:0,next:function next(){var r=t[this.currentIndex];if(!r)return{value:void 0,done:!0};var i={data:null,folder:r.name.match(/(.*)[/\\]/)[1]||"",name:r.name.replace(/^.*[\\/]/,"").replace(/U\+([0-9A-F]{4})/g,(function(t,r){return String.fromCharCode(parseInt(r,16))})),ext:r.name.substr(r.name.lastIndexOf(".")+1).toLowerCase(),size:r.size,type:"undefined"};if(["jpg","jpeg","png","bmp"].includes(i.ext)){var o=new Image;o.src=r.getBlobUrl(),i.data=o,i.type="image"}else if(["wav","ogg","mp3"].includes(i.ext)){i.data=new Audio,i.type="audio";var a=new FileReader;a.onload=function(t){i.data.src=t.target.result.replace("data:application/octet-stream","data:audio/"+i.ext)},a.readAsDataURL(r.blob)}else if(["ogv","mp4","m4v"].includes(i.ext)){var u=document.createElement("VIDEO");u.src=r.getBlobUrl(),i.data=u,i.type="video"}else["csv","txt","md"].includes(i.ext)&&(i.type="text",r.blob.text().then((function(t){return i.data=t})));return this.currentIndex++,{value:i,done:!1}}},Symbol.asyncIterator,(function(){return this})),i=!0,o=!1,a.prev=3,l=ot()(r);case 5:return a.next=7,l.next();case 7:return _=a.sent,i=_.done,a.next=11,_.value;case 11:if(c=a.sent,i){a.next=19;break}h=c,this._runner._pool.add(h),this._runner._screen._updateProgressBar(r.currentIndex/t.length);case 16:i=!0,a.next=5;break;case 19:a.next=25;break;case 21:a.prev=21,a.t0=a.catch(3),o=!0,u=a.t0;case 25:if(a.prev=25,a.prev=26,i||null==l.return){a.next=30;break}return a.next=30,l.return();case 30:if(a.prev=30,!o){a.next=33;break}throw u;case 33:return a.finish(30);case 34:return a.finish(25);case 35:return a.abrupt("return",!0);case 36:case"end":return a.stop()}}),_callee5,this,[[3,21,25,35],[26,,30,34]])}))),function _processOsexpPoolItems(t){return r.apply(this,arguments)})},{key:"_readWebFonts",value:(t=l()(a.a.mark((function _callee6(){return a.a.wrap((function _callee6$(t){for(;;)switch(t.prev=t.next){case 0:return this._runner._screen._updateProgressBar(100),this._runner._screen._updateIntroScreen("Retrieving required webfonts."),t.abrupt("return",new Promise((function(t,r){ut.a.load({google:{families:["Droid Sans","Droid Serif","Droid Sans Mono"],urls:["//fonts.googleapis.com/css?family=Droid Sans","//fonts.googleapis.com/css?family=Droid Serif","//fonts.googleapis.com/css?family=Droid Sans Mono"]},active:function active(){return t()},inactive:function inactive(){return r(new Error("Could not load webfonts"))}})})));case 3:case"end":return t.stop()}}),_callee6,this)}))),function _readWebFonts(){return t.apply(this,arguments)})},{key:"_writeDataFile",value:function _writeDataFile(t,r){if(null!==t&&null!==r){var i=new FormData;i.append("data",r.toString());var o=new XMLHttpRequest;return o.open("post",t+"?file=subject-"+this._runner._experiment.vars.subject_nr,!0),o.send(i)}}}]),Transfer}(),gt=function(){function ItemStack(t){c()(this,ItemStack),this._items=[],this._runner=t}return p()(ItemStack,[{key:"clear",value:function clear(){this._items=[]}},{key:"push",value:function push(t,r){var i={item:t,phase:r};this._items.push(i)}},{key:"pop",value:function pop(){return this._items.pop()}}]),ItemStack}(),bt=function(){function ItemStore(t){c()(this,ItemStore),this._items={},this._runner=t}return p()(ItemStore,[{key:"_clean_up",value:function _clean_up(){this._items={}}},{key:"_isClass",value:function _isClass(t){return t in Ze}},{key:"_newElementClass",value:function _newElementClass(t,r,i){return new Ze[t](r,i)}},{key:"_newItemClass",value:function _newItemClass(t,r,i,o){var a=new Ze[t](r,i,o);return a.type=t,a}},{key:"_newWidgetClass",value:function _newWidgetClass(t,r,i){return new Ze[t+"_widget"](r,i)}},{key:"execute",value:function execute(t,r){this.prepare(t,r),this._runner._itemStack.pop(),this.run(t,r)}},{key:"items",value:function items(){var items=[];for(var t in this._items)items.push([t,this._items[t]]);return items}},{key:"keys",value:function keys(){var keys=[];for(var t in this._items)keys.push(t);return keys}},{key:"newItem",value:function newItem(t,r,i){if(!0===this._isClass(t))return this._items[r]=this._newItemClass(t,this._runner._experiment,r,i),this._items[r];this._runner._debugger.addError('The item "'+t+'" is not yet supported by osweb',{notify:!0,url:"https://osdoc.cogsci.nl/manual/osweb/osweb/#supported-functionality"}),this._runner.exit()}},{key:"prepare",value:function prepare(t,r){this._runner._itemStack.push(t,"prepare"),this._items[t]._parent=r,this._items[t].prepare()}},{key:"run",value:function run(t,r){this._runner._events._currentItem=this._items[t],this._runner._events._currentItem._parent=r,this._runner._itemStack.push(t,"run"),this._items[t].run()}},{key:"valid_name",value:function valid_name(t,r){for(var i,o=1,a=i=null===(r=void 0===r?null:r)?"new_"+t:this._runner._experiment.syntax.sanitize(r,!0,!1);!0===Object.prototype.hasOwnProperty.call(this._items,a);)a=i+"_"+String(o),o++;return a}},{key:"values",value:function values(){var values=[];for(var t in this._items)values.push(this._items[t]);return values}}]),ItemStore}(),kt=i("./src/js/osweb/classes/python_workspace.js"),xt=function(){function FilePoolStore(t){c()(this,FilePoolStore),this._items=[],this._runner=t}return p()(FilePoolStore,[{key:"_clean_up",value:function _clean_up(){this._items=[]}},{key:"add",value:function add(t,r){null!==(r=void 0===r?null:r)&&(t.name=r),this._items.push(t),this[t.name]=t}},{key:"fallback_folder",value:function fallback_folder(){return null}},{key:"files",value:function files(){for(var files=[],t=0;t<this._items.length;t++)files.push(this._items[t]);return files}},{key:"rename",value:function rename(t,r){for(var i=0;i<this._items.length;i++)this._items[i].name===t&&(this[r]=this._items[i],delete this[t],this._items[i].name=r)}},{key:"size",value:function size(){for(var size=0,t=0;t<this._items.length;t++)size+=this._items[t].size;return size}}]),FilePoolStore}(),wt=(i("./node_modules/core-js/modules/es.number.is-nan.js"),i("./node_modules/core-js/modules/es.string.search.js"),i("./node_modules/core-js/modules/es.string.starts-with.js"),i("./node_modules/lodash/toNumber.js")),St=i.n(wt);function syntax_createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function syntax_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return syntax_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return syntax_arrayLikeToArray(t,r)}(t))){var r=0,i=function F(){};return{s:i,n:function n(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,u=!0,l=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return u=t.done,t},e:function e(t){l=!0,a=t},f:function f(){try{u||null==o.return||o.return()}finally{if(l)throw a}}}}function syntax_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var Et=function(){function Syntax(t){c()(this,Syntax),this._runner=t,this.isNumber=H.a}return p()(Syntax,[{key:"compile_cond",value:function compile_cond(t,r){var i=this;return r=void 0===r||r,"always"===t.toLowerCase()||"never"!==t.toLowerCase()&&(t="="===t[0]?t.substr(1):(t=(t=this.remove_quotes(t)).replace(/(?!(?:and|or|not)\b)(?:".*?"|'.*?'|\[(?:\w+?|=.+)\]|\b\w+\b)/g,(function(t,r,o){if("["===o[r]&&"]"===o[r+t.length-1]){if("\\"===o[r-1]&&"\\"!==o[r-2])return'"'.concat(t,'"');if("="===t[1]){var a=t.substring(2,t.length-1),u=i._runner._pythonParser._parse(a);return i._runner._pythonParser._run_statement(u)}var l=t.substring(1,t.length-1);return"var.".concat(l)}return['"',"'"].includes(o[r])&&o[r]===o[r+t.length-1]?t:Number.isNaN(Number(t))?'"'.concat(t,'"'):Number(t)}))).replace(/([^!<>=\-+*])(=)([^=])/g,"$1==$3"),!0===r?this._runner._pythonParser._parse(t):t)}},{key:"convert_if_numeric",value:function convert_if_numeric(t){if(""===t)return t;var r=Number(t);return Number.isNaN(r)?t:r}},{key:"count_quotes",value:function count_quotes(t){for(var r=0,i=!1,o=0;o<t.length;o++)"\\"===t[o]&&!i||i?i=!i:'"'!==t[o]||i||(r+=1);return r}},{key:"eval_text",value:function eval_text(t,r){var i=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(ft()(t))return this._runner._pythonParser._run_statement(t);if(H()(t))return t;if(""!==t&&!isNaN(St()(t)))return St()(t);t=this.escapeBrackets(t);for(var a=/\[(?!=)(\w+?)\]/g;t.search(a)>=0;)t=t.replace(a,(function(t,a,u,l){var _;a=i.unescapeBrackets(a);try{if(void 0===(_=null==r||void 0===r[a]?i._runner._experiment.vars[a]:r[a]))throw new ReferenceError("Variable '".concat(a,"' not present in var store"));ie()(_)&&""!==_&&(_=i.eval_text(_,r,o))}catch(t){throw i._runner._debugger.addError("Could not resolve variable '".concat(a,"': ").concat(t.message)),t}return!0===o&&ie()(_)?'"'.concat(_,'"'):_}));var u=/\[=(.+?)\]/g;if(""!==(t=t.replace(u,(function(t,r,o,a){r=i.unescapeBrackets(r);var u=i._runner._pythonParser._parse(r);return i._runner._pythonParser._run_statement(u)})))){var l=St()(t);if(!isNaN(l))return l}return this.strip_slashes(this.unescapeBrackets(t))}},{key:"safe_wrap",value:function safe_wrap(t){return H()(t)?t=Number(t):/[^a-z0-9_]/i.test(t)&&(t='"'+this.add_slashes(t)+'"'),t}},{key:"add_slashes",value:function add_slashes(t){return t.replace(/\\/g,"\\\\").replace(/\u0008/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/'/g,"\\'").replace(/"/g,'\\"')}},{key:"strip_slashes",value:function strip_slashes(t){return t.replace(/\\(?=['"])/gm,"").replace(/\\\\/gm,"\\")}},{key:"dedent",value:function dedent(t){var r,i=[],o=syntax_createForOfIteratorHelper(t.split("\n"));try{for(o.s();!(r=o.n()).done;){var a=r.value;if("\t"!==a[0])return t;i.push(a.slice(1))}}catch(t){o.e(t)}finally{o.f()}return i.join("\n")}},{key:"parse_multiline_vars",value:function parse_multiline_vars(t){for(var r,i=/__([0-9A-Z_a-z]+)__\n([\s\S]*?)\n__end__/gm,o=[];null!==(r=i.exec(t));)o[r[1]]=r[2];return o}},{key:"parse_cmd",value:function parse_cmd(t){this.count_quotes(t)%2!=0&&this._runner._debugger.addError("Invalid script definition, parsing error:  '"+t+"'");for(var r=this.split(t),i=r.shift(),o=[],a={},u=0;u<r.length;u++){var l=r[u].split(/(?:("[^"\\]*(?:\\.[^"\\]*)*"))|(?:(\w+)=(?:(?:(-?\d+(?:\.\d*)?(?:[eE][+-]?\d+)?)|(\w+))|("[^"\\]*(?:\\.[^"\\]*)*")))/gm).filter(Boolean);1===l.length&&l[0].startsWith("text=")&&(l=["text",l[0].slice(5)]),l.length<2?o.push(this.convert_if_numeric(this.sanitize(l[0]))):a[l[0]]=this.convert_if_numeric(this.sanitize(l[1]))}return[i,o,a]}},{key:"create_cmd",value:function create_cmd(t,r,i){var o=t;if(void 0!==r&&r instanceof Array&&r.length>0)for(var a=0;a<r.length;a++)o+=" "+this.safe_wrap(r[a]);if(void 0!==i&&r instanceof Object)for(var u in i)o+=" "+u+"="+this.safe_wrap(i[u]);return o}},{key:"remove_quotes",value:function remove_quotes(t){return'""'===t?"":'"'===t[0]&&'"'===t[t.length-1]||"'"===t[0]&&"'"===t[t.length-1]?t.slice(1,t.length-1):t}},{key:"sanitize",value:function sanitize(t,r,i){return t=t.replace(/^"(.*(?="$))"$/,"$1"),this.strip_slashes(t)}},{key:"split",value:function split(t){var r=t.match(/(?:[^\s"]+|"[^"]*")+/g);return null!==r?r:[]}},{key:"escapeBrackets",value:function escapeBrackets(t){return t.replace(/\\+[[\]]/g,(function(t,r,i,o){var a=t.length-1;if(a%2==1){var u="["===t[t.length-1]?"OPEN":"CLOSE";return"%%".concat(u,":").concat(a,":%%")}return t}))}},{key:"unescapeBrackets",value:function unescapeBrackets(t){return t.replace(/%%(OPEN|CLOSE):\d+:%%/g,(function(t,r,i,o){var a="OPEN"===t.substr(2,4)?"[":"]",u=t.indexOf(":")+1,l=t.lastIndexOf(":"),_=parseInt(t.substr(u,l-u));return Array(_).join("\\")+a}))}}]),Syntax}(),Rt=i("./node_modules/filbert/filbert.js"),jt=i.n(Rt),Tt=function(){function PythonMath(t){c()(this,PythonMath),this._runner=t,this.e=Math.E,this.pi=Math.PI}return p()(PythonMath,[{key:"_initialize",value:function _initialize(){jt.a.pythonRuntime.imports.math={},jt.a.pythonRuntime.imports.math.ceil=this.ceil,jt.a.pythonRuntime.imports.math.copysign=this.copysign,jt.a.pythonRuntime.imports.math.fabs=this.fabs,jt.a.pythonRuntime.imports.math.factorial=this.factorial,jt.a.pythonRuntime.imports.math.floor=this.floor,jt.a.pythonRuntime.imports.math.fmod=this.fmod,jt.a.pythonRuntime.imports.math.frexp=this.frexp,jt.a.pythonRuntime.imports.math.fsum=this.fsum,jt.a.pythonRuntime.imports.math.acos=this.acos,jt.a.pythonRuntime.imports.math.asin=this.asin,jt.a.pythonRuntime.imports.math.atan=this.atan,jt.a.pythonRuntime.imports.math.atan2=this.atan2,jt.a.pythonRuntime.imports.math.cos=this.cos,jt.a.pythonRuntime.imports.math.hypot=this.hypot,jt.a.pythonRuntime.imports.math.sin=this.sin,jt.a.pythonRuntime.imports.math.tan=this.tan,jt.a.pythonRuntime.imports.math.e=this.e,jt.a.pythonRuntime.imports.math.pi=this.pi}},{key:"ceil",value:function ceil(t){}},{key:"copysign",value:function copysign(t,r){}},{key:"fabs",value:function fabs(t){}},{key:"factorial",value:function factorial(t){}},{key:"floor",value:function floor(t){return Math.floor(t)}},{key:"fmod",value:function fmod(t,r){}},{key:"frexp",value:function frexp(t){}},{key:"fsum",value:function fsum(t){}},{key:"acos",value:function acos(t){return Math.acos(t)}},{key:"asin",value:function asin(t){return Math.asin(t)}},{key:"atan",value:function atan(t){return Math.atan(t)}},{key:"atan2",value:function atan2(t,r){return Math.atan2(t,r)}},{key:"cos",value:function cos(t){return Math.cos(t)}},{key:"hypot",value:function hypot(t,r){}},{key:"sin",value:function sin(t){return Math.sin(t)}},{key:"tan",value:function tan(t){return Math.tan(t)}}]),PythonMath}(),Ct=function(){function PythonOpenSesame(t){c()(this,PythonOpenSesame),this._runner=t}return p()(PythonOpenSesame,[{key:"_initialize",value:function _initialize(){this._objects={},jt.a.pythonRuntime.imports.clock={},jt.a.pythonRuntime.imports.clock.sleep=this._runner._experiment.clock.sleep,jt.a.pythonRuntime.imports.clock.time=this._runner._experiment.clock.time,jt.a.pythonRuntime.imports.log={},jt.a.pythonRuntime.imports.log.close=this._runner._experiment._log.close,jt.a.pythonRuntime.imports.log.open=this._runner._experiment._log.open,jt.a.pythonRuntime.imports.log.write=this._runner._experiment._log.write,jt.a.pythonRuntime.imports.log.write_vars=this._runner._experiment._log.write_vars,jt.a.pythonRuntime.imports.var=this._runner._experiment.vars,jt.a.pythonRuntime.imports.var.get=this._runner._experiment.vars.get,jt.a.pythonRuntime.imports.var.has=this._runner._experiment.vars.has,jt.a.pythonRuntime.imports.var.set=this._runner._experiment.vars.set,jt.a.pythonRuntime.imports.var.unset=this._runner._experiment.vars.unset,jt.a.pythonRuntime.functions.reset_feedback=this._runner._experiment.reset_feedback,jt.a.pythonRuntime.functions.set_subject_nr=this._runner._experiment.set_subject,jt.a.pythonRuntime.functions.canvas=this.canvas,jt.a.pythonRuntime.functions.copy_sketchpad=this.copy_sketchpad,jt.a.pythonRuntime.functions.keyboard=this.keyboard,jt.a.pythonRuntime.functions.mouse=this.mouse,jt.a.pythonRuntime.functions.pause=this.pause,jt.a.pythonRuntime.functions.set_subject_nr=this.set_subject_nr,jt.a.pythonRuntime.functions.sometimes=this.sometimes,jt.a.pythonRuntime.functions.synth=this.synth,jt.a.pythonRuntime.functions.xy_circle=this.xy_circle,jt.a.pythonRuntime.functions.xy_distance=this.xy_distance,jt.a.pythonRuntime.functions.xy_from_polar=this.xy_from_polar,jt.a.pythonRuntime.functions.xy_grid=this.xy_grid,jt.a.pythonRuntime.functions.xy_random=this.xy_random,jt.a.pythonRuntime.functions.xy_to_polar=this.xy_to_polar}},{key:"canvas",value:function canvas(t,r){return new Se.a(this._runner._experiment,t,r)}},{key:"copy_sketchpad",value:function copy_sketchpad(t){}},{key:"keyboard",value:function keyboard(t){}},{key:"mouse",value:function mouse(t){}},{key:"pause",value:function pause(t){}},{key:"sampler",value:function sampler(t,r){}},{key:"set_response",value:function set_response(t,r,i){}},{key:"sometimes",value:function sometimes(t){}},{key:"synth",value:function synth(t,r,i,o,a){}},{key:"xy_circle",value:function xy_circle(t,r,i,o){}},{key:"xy_distance",value:function xy_distance(t,r,i,o){}},{key:"xy_from_polar",value:function xy_from_polar(t,r,i){}},{key:"xy_grid",value:function xy_grid(t,r,i){}},{key:"xy_random",value:function xy_random(t,r,i,o,a){}},{key:"xy_to_polar",value:function xy_to_polar(t,r,i){}}]),PythonOpenSesame}(),It=function(){function PythonRandom(t){c()(this,PythonRandom),this._runner=t}return p()(PythonRandom,[{key:"_initialize",value:function _initialize(){jt.a.pythonRuntime.imports.random={},jt.a.pythonRuntime.imports.random.random=this.random,jt.a.pythonRuntime.imports.random.shuffle=this.shuffle}},{key:"random",value:function random(){return Math.random()}},{key:"shuffle",value:function shuffle(t,r){for(var i,o,a=t.length;0!==a;)o=Math.floor(Math.random()*a),i=t[a-=1],t[a]=t[o],t[o]=i;return t}}]),PythonRandom}(),Ot=function(){function PythonString(t){c()(this,PythonString),this._runner=t}return p()(PythonString,[{key:"_initialize",value:function _initialize(){}},{key:"capitalize",value:function capitalize(){}},{key:"center",value:function center(t,r){}},{key:"upper",value:function upper(){}}]),PythonString}(),At=function(){function PythonParser(t){c()(this,PythonParser),this._runner=t,this.python_math=new Tt(this._runner),this.python_opensesame=new Ct(this._runner),this.python_random=new It(this._runner),this.python_string=new Ot(this._runner),this._classes={},this._function_stack=[],this._global_return_value=null,this._inline_script=null,this._node=null,this._onConsole=null,this._stack=0,this._statement=null,this._status=0,this._variables={}}return p()(PythonParser,[{key:"_initialize",value:function _initialize(){this._variables.clock=this._runner._experiment.clock,this._variables.exp=this._runner._experiment,this._variables.items=this._runner._itemStore,this._variables.pool=this._runner._pool,this._variables.var=this._runner._experiment.vars,null!==this._runner._onConsole&&(this._onConsole=this._runner._onConsole),this.python_math._initialize(),this.python_opensesame._initialize(),this.python_random._initialize(),this.python_string._initialize()}},{key:"_parse",value:function _parse(t){if('""'===t)return null;var r=jt.a.parse;try{return r(t,{locations:!1,ranges:!1})}catch(t){return this._runner._debugger.addError("Script parsing error: "+t.message),null}}},{key:"_get_context",value:function _get_context(t){var r=t.value.split(".");return"__pythonRuntime"===r[0]&&"imports"===r[1]?this._variables[r[2]]:void 0!==this._variables[r[0]]?this._variables[r[0]]:window[r[0]]}},{key:"_get_element",value:function _get_element(t){var r=t.value.split(".");if("__pythonRuntime"===r[0]){if("imports"===r[1]){var i=jt.a.pythonRuntime.imports[r[2]][r[3]];return isNaN(St()(i))?i:St()(i)}return jt.a.pythonRuntime[r[1]][r[2]]}return void 0!==this._variables[r[0]]?1===r.length?this._variables[r[0]]:this._variables[r[0]][r[1]]:void 0!==window[r[0]]?1===r.length?window[r[0]]:window[r[0]][r[1]]:void 0}},{key:"_get_element_value",value:function _get_element_value(t){switch(t.type){case"identifier":var r=t.value.split(".");if(1===r.length)return void 0!==this._variables[r[0]]?this._variables[r[0]]:window[r[0]];if(-1!==r[0].indexOf("__filbertRight"))return-1!==r[1].indexOf("__filbertIndex")?this._variables[r[0]][this._variables[r[1]]]:void 0!==this._variables[r[0]]?this._variables[r[0]][r[1]]:window[r[0]][r[1]];if("__pythonRuntime"===r[0]){if("imports"===r[1]){var i=jt.a.pythonRuntime.imports[r[2]][r[3]];return isNaN(St()(i))?i:St()(i)}return jt.a.pythonRuntime[r[1]][r[2]]}return void 0!==this._variables[r[0]]?this._variables[r[0]][r[1]]:window[r[0]][r[1]];case"literal":return t.value}}},{key:"_set_element_value",value:function _set_element_value(t,r){var i=t.value.split(".");1===i.length?void 0!==window[i[0]]?window[i[0]]=r:this._variables[i[0]]=r:void 0!==window[i[0]]?window[i[0]][i[1]]=r:this._variables[i[0]][i[1]]=r}},{key:"_set_node",value:function _set_node(t){t.parent=this._node,this._node=t}},{key:"_set_return_value",value:function _set_return_value(t){this._node.parent.return_values=void 0===this._node.parent.return_values?[]:this._node.parent.return_values,this._node.parent.return_values.push(t)}},{key:"_array_expression",value:function _array_expression(){if(this._node.index=void 0===this._node.index?0:this._node.index,this._node.index<this._node.elements.length)this._node.index++,this._set_node(this._node.elements[this._node.index-1]),this._process_nodes();else{for(var t=0;t<this._node.return_values.length;t++)this._node.return_values[t]=this._get_element_value(this._node.return_values[t]);var r={type:"literal",value:this._node.return_values};this._set_return_value(r),this._node.index=0,this._node.return_values=[],this._node=this._node.parent,this._process_nodes()}}},{key:"_assignment_expression",value:function _assignment_expression(){switch(this._node.status=void 0===this._node.status?0:this._node.status,this._node.status){case 0:this._node.status=1,this._set_node(this._node.left),this._process_nodes();break;case 1:this._node.status=2,this._set_node(this._node.right),this._process_nodes();break;case 2:var t;switch(this._node.operator){case"=":this._set_element_value(this._node.return_values[0],this._get_element_value(this._node.return_values[1]));break;case"-=":t=this._get_element_value(this._node.return_values[0]),this._set_element_value(this._node.return_values[0],t-this._get_element_value(this._node.return_values[1]));break;case"/=":t=this._get_element_value(this._node.return_values[0]),this._set_element_value(this._node.return_values[0],t/this._get_element_value(this._node.return_values[1]));break;case"%=":t=this._get_element_value(this._node.return_values[0]),this._set_element_value(this._node.return_values[0],t%this._get_element_value(this._node.return_values[1]))}this._node.status=0,this._node.return_values=[],this._node=this._node.parent,this._process_nodes()}}},{key:"_binary_expression",value:function _binary_expression(){switch(this._node.status=void 0===this._node.status?0:this._node.status,this._node.status){case 0:this._node.status=1,this._set_node(this._node.left),this._process_nodes();break;case 1:this._node.status=2,this._set_node(this._node.right),this._process_nodes();break;case 2:var t=this._get_element_value(this._node.return_values[0]),r=this._get_element_value(this._node.return_values[1]),i={type:"literal"};switch(this._node.operator){case"-":i.value=t-r;break;case"/":i.value=t/r;break;case"==":i.value=t===r;break;case"!=":i.value=t!==r;break;case">":i.value=t>r;break;case"<":i.value=t<r;break;case">=":i.value=t>=r;break;case"<=":i.value=t<=r;break;case"%":i.value="number"==typeof t&&"number"==typeof r?t%r:t.replace(/%s/g,r);break;case"instanceof":i.value=t instanceof r}this._set_return_value(i),this._node.status=0,this._node.return_values=[],this._node=this._node.parent,this._process_nodes()}}},{key:"_block_statement",value:function _block_statement(){this._node.break=void 0!==this._node.break&&this._node.break,this._node.index=void 0===this._node.index?0:this._node.index,this._node.index<this._node.body.length&&!1===this._node.break?(this._node.index++,this._set_node(this._node.body[this._node.index-1]),this._process_nodes()):(!0===this._node.break&&(this._node.break=!1,this._node.parent.break=!0),this._node.index=0,this._node=this._node.parent,this._process_nodes())}},{key:"_break_statement",value:function _break_statement(){this._node.parent.break=!0,this._node=this._node.parent,this._process_nodes()}},{key:"_call_expression",value:function _call_expression(){switch(this._node.arguments=void 0===this._node.arguments?[]:this._node.arguments,this._node.index=void 0===this._node.index?0:this._node.index,this._node.status=void 0===this._node.status?0:this._node.status,this._node.status){case 0:this._node.index<this._node.arguments.length?(this._node.index++,this._set_node(this._node.arguments[this._node.index-1]),this._process_nodes()):(this._node.status=1,this._set_node(this._node.callee),this._process_nodes());break;case 1:for(var t=this._node.return_values.pop(),r=[],i=0;i<this._node.return_values.length;i++)r.push(this._get_element_value(this._node.return_values[i]));var o=this._get_element(t),a=this._get_context(t);"sleep"===t.value||"__pythonRuntime.imports.clock.sleep"===t.value?(this._node.status=2,void 0===a&&(a=this),o.apply(a,r)):(void 0===a&&(a=this),t="FunctionExpression"===this._node.callee.type?{type:"literal",value:o}:{type:"literal",value:o.apply(a,r)},this._set_return_value(t),this._node.index=0,this._node.status=0,this._node.return_values=[],this._node=this._node.parent,this._process_nodes());break;case 2:this._set_return_value(this.global_return_value),this._node.index=0,this._node.status=0,this._node.return_values=[],this._node=this._node.parent,this._process_nodes()}}},{key:"_empty_statement",value:function _empty_statement(){this._node=this._node.parent,this._process_nodes()}},{key:"_expression_statement",value:function _expression_statement(){this._node.status=void 0===this._node.status?0:this._node.status,0===this._node.status?(this._node.status=1,this._set_node(this._node.expression),this._process_nodes()):(this._node.status=0,this._node=this._node.parent,this._process_nodes())}},{key:"_for_statement",value:function _for_statement(){switch(this._node.status=void 0===this._node.status?0:this._node.status,this._node.status){case 0:this._node.status=1,this._set_node(this._node.init),this._process_nodes();break;case 1:this._node.status=2,this._set_node(this._node.test),this._process_nodes();break;case 2:!0===this._node.return_values[0].value?(this._node.status=3,this._node.return_values=[],this._set_node(this._node.body),this._process_nodes()):(this._node.status=0,this._node.return_values=[],this._node=this._node.parent,this._process_nodes());break;case 3:this._node.status=1,this._set_node(this._node.update),this._process_nodes()}}},{key:"_for_in_statement",value:function _for_in_statement(){switch(this._node.index=void 0===this._node.index?0:this._node.index,this._node.status=void 0===this._node.status?0:this._node.status,this._node.status){case 0:this._node.status=1,this._set_node(this._node.left),this._process_nodes();break;case 1:this._node.status=2,this._set_node(this._node.right),this._process_nodes();break;case 2:var t=this._get_element_value(this._node.return_values[1]);this._node.index<t.length?(this._set_element_value(this._node.return_values[0],t[this._node.index]),this._node.index++,this._set_node(this._node.body),this._process_nodes()):(this._node.index=0,this._node.status=0,this._node.return_values=[],this._node=this._node.parent,this._process_nodes())}}},{key:"_function_expression",value:function _function_expression(){switch(this._node.status=void 0===this._node.status?0:this._node.status,this._node.status){case 0:this._node.status=1,this._set_node(this._node.body),this._process_nodes();break;case 1:var t=this._function_stack.pop();this._set_return_value(t),this._node.status=0,this._node.return_values=[],this._node=this._node.parent,this._process_nodes()}}},{key:"_identifier",value:function _identifier(){var t={type:"identifier",value:this._node.name};this._set_return_value(t),this._node=this._node.parent,this._process_nodes()}},{key:"_if_statement",value:function _if_statement(){switch(this._node.break=void 0!==this._node.break&&this._node.break,this._node.status=void 0===this._node.status?0:this._node.status,this._node.status){case 0:this._node.status=1,this._set_node(this._node.test),this._process_nodes();break;case 1:!0===this._node.return_values[0].value?(this._node.status=2,this._set_node(this._node.consequent),this._process_nodes()):null!==this._node.alternate?(this._node.status=2,this._set_node(this._node.alternate),this._process_nodes()):(this._node.status=2,this._process_nodes());break;case 2:!0===this._node.break&&(this._node.break=!1,this._node.parent.break=!0),this._node.status=0,this._node.return_values=[],this._node=this._node.parent,this._process_nodes()}}},{key:"_literal",value:function _literal(){var t={type:"literal",value:this._node.value};this._set_return_value(t),this._node=this._node.parent,this._process_nodes()}},{key:"_logical_expression",value:function _logical_expression(){switch(this._node.status=void 0===this._node.status?0:this._node.status,this._node.status){case 0:this._node.status=1,this._set_node(this._node.left),this._process_nodes();break;case 1:this._node.status=2,this._set_node(this._node.right),this._process_nodes();break;case 2:var t=this._get_element_value(this._node.return_values[0]),r=this._get_element_value(this._node.return_values[1]),i={type:"literal"};switch(this._node.operator){case"&&":i.value=t&&r;break;case"||":i.value=t||r}this._set_return_value(i),this._node.status=0,this._node.return_values=[],this._node=this._node.parent,this._process_nodes()}}},{key:"_member_expression",value:function _member_expression(){switch(this._node.status=void 0===this._node.status?0:this._node.status,this._node.status){case 0:this._node.status=1,this._set_node(this._node.object),this._process_nodes();break;case 1:this._node.status=2,this._set_node(this._node.property),this._process_nodes();break;case 2:var t={type:"identifier",value:this._node.return_values[0].value+"."+this._node.return_values[1].value};this._set_return_value(t),this._node.status=0,this._node.return_values=[],this._node=this._node.parent,this._process_nodes()}}},{key:"_new_expression",value:function _new_expression(){if(this._node.arguments=void 0===this._node.arguments?[]:this._node.arguments,this._node.index=void 0===this._node.index?0:this._node.index,this._node.status=void 0===this._node.status?0:this._node.status,0===this._node.status)this._node.index<this._node.arguments.length?(this._node.index++,this._set_node(this._node.arguments[this._node.index-1]),this._process_nodes()):(this._node.status=1,this._set_node(this._node.callee),this._process_nodes());else{for(var t=this._node.return_values.pop(),r=this._get_element(t),i=this._get_context(t),o=[],a=0;a<this._node.return_values.length;a++)o.push(this._get_element_value(this._node.return_values[a]));t={type:"literal",value:r.apply(i,o)},this._set_return_value(t),this._node.index=0,this._node.status=0,this._node.return_values=[],this._node=this._node.parent,this._process_nodes()}}},{key:"_program",value:function _program(){this._node.index=void 0===this._node.index?0:this._node.index,this._node.index<this._node.body.length?(this._node.index++,this._set_node(this._node.body[this._node.index-1]),this._process_nodes()):(this._node.index=0,this._status=2,null!==this._inline_script&&this._inline_script._complete())}},{key:"_return_statement",value:function _return_statement(){var t;switch(this._node.status=void 0===this._node.status?0:this._node.status,this._node.status){case 0:this._node.status=1,this._set_node(this._node.argument),this._process_nodes();break;case 1:t={type:"identifier",value:this._node.return_values[0].value},this._function_stack.push(t),this._node.status=0,this._node.return_values=[],this._node=this._node.parent,this._process_nodes()}}},{key:"_unary_expression",value:function _unary_expression(){if(this._node.status=void 0===this._node.status?0:this._node.status,0===this._node.status)this._node.status=1,this._set_node(this._node.argument),this._process_nodes();else{var t={type:"literal"};switch(this._node.operator){case"!":t.value=!this._node.return_values[0].value;break;case"-":t.value=-this._node.return_values[0].value}this._set_return_value(t),this._node.status=0,this._node.return_values=[],this._node=this._node.parent,this._process_nodes()}}},{key:"_update_expression",value:function _update_expression(){if(this._node.status=void 0===this._node.status?0:this._node.status,0===this._node.status)this._node.status=1,this._set_node(this._node.argument),this._process_nodes();else{switch(this._node.operator){case"++":this._set_element_value(this._node.return_values[0],this._get_element_value(this._node.return_values[0])+1)}this._node.status=0,this._node.return_values=[],this._node=this._node.parent,this._process_nodes()}}},{key:"_variable_declaration",value:function _variable_declaration(){this._node.index=void 0===this._node.index?0:this._node.index,this._node.index<this._node.declarations.length?(this._node.index++,this._set_node(this._node.declarations[this._node.index-1]),this._process_nodes()):(this._node.index=0,this._node=this._node.parent,this._process_nodes())}},{key:"_variable_declarator",value:function _variable_declarator(){switch(this._node.status=void 0===this._node.status?0:this._node.status,this._node.status){case 0:this._node.status=1,this._set_node(this._node.id),this._process_nodes();break;case 1:this._node.status=2,this._set_node(this._node.init),this._process_nodes();break;case 2:this._set_element_value(this._node.return_values[0],this._get_element_value(this._node.return_values[1])),this._node.status=0,this._node.return_values=[],this._node=this._node.parent,this._process_nodes()}}},{key:"_while_statement",value:function _while_statement(){switch(this._node.break=void 0!==this._node.break&&this._node.break,this._node.status=void 0===this._node.status?0:this._node.status,this._node.status){case 0:!0===this._node.break?(this._node.break=!1,this._node.status=0,this._node.return_values=[],this._node=this._node.parent,this._process_nodes()):(this._node.status=1,this._set_node(this._node.test),this._process_nodes());break;case 1:!0===this._node.return_values[0].value?(this._node.status=0,this._node.return_values=[],this._set_node(this._node.body),this._process_nodes()):(this._node.status=0,this._node.return_values=[],this._node=this._node.parent,this._process_nodes())}}},{key:"_process_nodes",value:function _process_nodes(){if(null===this._statement)this._process_nodes_jump();else{if(this._node===this._statement)return this._node.body[0].return_values[0].value;this._process_nodes_timeout()}}},{key:"_process_nodes_jump",value:function _process_nodes_jump(){this._stack++,this._stack>500?(this._stack=0,setTimeout(function(){this._process_nodes_timeout()}.bind(this),1)):this._process_nodes_timeout()}},{key:"_process_nodes_timeout",value:function _process_nodes_timeout(){switch(this._node.type){case"ArrayExpression":this._array_expression();break;case"AssignmentExpression":this._assignment_expression();break;case"BinaryExpression":this._binary_expression();break;case"BlockStatement":this._block_statement();break;case"BreakStatement":this._break_statement();break;case"CallExpression":this._call_expression();break;case"EmptyStatement":this._empty_statement();break;case"ExpressionStatement":this._expression_statement();break;case"ForStatement":this._for_statement();break;case"ForInStatement":this._for_in_statement();break;case"FunctionExpression":this._function_expression();break;case"Identifier":this._identifier();break;case"IfStatement":this._if_statement();break;case"Literal":this._literal();break;case"LogicalExpression":this._logical_expression();break;case"MemberExpression":this._member_expression();break;case"NewExpression":this._new_expression();break;case"Program":this._program();break;case"ReturnStatement":this._return_statement();break;case"UnaryExpression":this._unary_expression();break;case"UpdateExpression":this._update_expression();break;case"VariableDeclaration":this._variable_declaration();break;case"VariableDeclarator":this._variable_declarator();break;case"WhileStatement":this._while_statement();break;default:this._runner._debugger.addError("Invalid node type to process: "+this._node.type)}}},{key:"_run_statement",value:function _run_statement(t){var r;return this._node=t.body[0],this._node.parent=t,this._statement=t,this._status=1,this._process_nodes(),r="identifier"===t.body[0].return_values[0].type?this._get_element_value(t.body[0].return_values[0]):t.body[0].return_values[0].value,t.body[0].return_values=[],r}},{key:"_run",value:function _run(t,r){this._inline_script=t,this._variables.self=t,this._node=r,this._node.parent=null,this._statement=null,this._status=1,this._process_nodes()}}]),PythonParser}(),Mt=i("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),Pt=i.n(Mt),Ft=i("./src/js/osweb/classes/javascript_workspace.js");function log_createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function log_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return log_arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return log_arrayLikeToArray(t,r)}(t))){var r=0,i=function F(){};return{s:i,n:function n(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,u=!0,l=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return u=t.done,t},e:function e(t){l=!0,a=t},f:function f(){try{u||null==o.return||o.return()}finally{if(l)throw a}}}}function log_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var Dt=function(){function Log(t){c()(this,Log),this._experiment=t}return p()(Log,[{key:"write_vars",value:function write_vars(t){var r,i={},o=log_createForOfIteratorHelper(t);try{for(o.s();!(r=o.n()).done;){var a=r.value,u=this._experiment.vars.get(a,"NA",!1);ge()(u)||(i[a]=u)}}catch(t){o.e(t)}finally{o.f()}ge()(this._experiment.onLog)&&this._experiment.onLog(i),this._experiment._runner._data.push(i)}}]),Log}();function experiment_createSuper(t){var r=function experiment_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=O()(t);if(r){var a=O()(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return C()(this,i)}}var Lt=function(t){j()(Experiment,t);var r=experiment_createSuper(Experiment);function Experiment(t,i,o){var a;return c()(this,Experiment),(a=r.call(this,t,i,o))._canvas=new Se.a(Pt()(a)),a._currentCanvas=a._canvas,a._log=new Dt(Pt()(a)),a._scale_x=1,a._scale_y=1,a._javascriptWorkspace=new Ft.a(Pt()(a)),a.debug=a._runner._debugger.enabled,a.items=a._runner._itemStore,a.pool=a._runner._pool,a.vars.start="experiment",a.vars.title="My Experiment",a.vars.bidi="no",a.vars.round_decimals=2,a.vars.form_clicks="no",a.vars.uniform_coordinates="no",a.vars.sessionid=(new Date).valueOf()+Math.floor(1e5*Math.random()),a.vars.sound_freq=48e3,a.vars.sound_sample_size=-16,a.vars.sound_channels=2,a.vars.sound_buf_size=1024,a.vars.canvas_backend="xpyriment",a.vars.width=1024,a.vars.height=768,a.vars.background=0,a.vars.foreground=16777215,a.vars.penwidth=1,a.vars.font_size=18,a.vars.font_family="mono",a.vars.font_italic="no",a.vars.font_bold="no",a.vars.font_underline="no",a}return p()(Experiment,[{key:"reset_feedback",value:function reset_feedback(){this.vars.total_responses=0,this.vars.total_correct=0,this.vars.total_response_time=0,this.vars.avg_rt="undefined",this.vars.average_response_time="undefined",this.vars.accuracy="undefined",this.vars.acc="undefined"}},{key:"set_subject",value:function set_subject(t){this.vars.subject_nr=t,this.vars.subject_parity=t%2==0?"even":"odd"}},{key:"read_definition",value:function read_definition(t){for(var r=t.shift(),i="";null!==r&&r.length>0&&"\t"===r.charAt(0);)i=i+r.substring(1)+"\n",r=t.shift();return i}},{key:"from_string",value:function from_string(t){if(null!==t){t=t.replace(/\r\n|\r|\n/g,"\n"),this._source=t.split("\n");for(var r=this._source.shift();null!=r;){var i=void 0,o=void 0;try{var a=this._runner._syntax.parse_cmd(r),u=v()(a,3);i=u[0],o=u[1],u[2]}catch(t){this._runner._debugger.addError("Failed to parse script. Maybe it contains illegal characters or unclosed quotes: "+t.message)}if(null!==i&&o.length>0&&!1===this.parse_variable(r)&&"define"===i)if(2===o.length){var l=o[0],_=this._runner._syntax.sanitize(o[1]),c=this.read_definition(this._source);this._runner._itemStore.newItem(l,_,c)}else this._runner._debugger.addError("Failed to parse definition: "+r);r=this._source.shift()}}}},{key:"init_clock",value:function init_clock(){this.clock._initialize()}},{key:"init_display",value:function init_display(){this._canvas.init_display(this)}},{key:"onLog",value:function onLog(t){}},{key:"run",value:function run(){switch(E()(O()(Experiment.prototype),"run",this).call(this),this._status){case Xe.STATUS_INITIALIZE:this._status=Xe.STATUS_FINALIZE,this.vars.datetime=(new Date).toString(),this.vars.opensesame_version=Ht,this.vars.opensesame_codename=Ut,this.init_clock(),this.init_display(),this.reset_feedback(),this._runner._debugger.addMessage("experiment.run(): experiment started at "+(new Date).toUTCString()),null!==this._runner._itemStore._items[this.vars.start]?(this._runner._itemStack.clear(),this._runner._itemStore.prepare(this.vars.start,this)):this._runner._debugger.addError("Could not find the item that is the entry point of the experiment: "+this.vars.start);break;case Xe.STATUS_FINALIZE:this._runner._debugger.addMessage("experiment.run(): experiment finished at "+(new Date).toUTCString()),this.end()}}},{key:"end",value:function end(){this._runner._finalize()}}]),Experiment}(K),Nt=function(){function Runner(t){c()(this,Runner),this._confirm=null,this._container=null,this._data=[],this._experiment=null,this._fullScreen=!1,this._mimetype=null,this._name="noname.exp",this._onConsole=null,this._onFinished=null,this._onLog=null,this._onError=null,this._prompt=null,this._renderer=null,this._scaleMode="noScale",this._script=null,this._source=null,this._subject=null,this._target=null,this._debugger=new Qe(this),this._convertor=new et(this),this._events=new tt(this),this._itemStack=new gt(this),this._itemStore=new bt(this),this._parameters=new rt(this),this._pool=new xt(this),this._pythonParser=new At(this),this._pythonWorkspace=new kt.a(this),this._screen=new nt(this),this._session=new st(this),this._syntax=new Et(this),this._transfer=new yt(this),this._setupContent(t)}var t;return p()(Runner,[{key:"_setupContent",value:function _setupContent(t){void 0!==t?(this._container="string"==typeof t?document.getElementById(t):t,this._renderer=Object(d.g)(800,600,{antialias:!0,transparent:!1,resolution:1}),this._renderer.backgroundColor=0,this._container.appendChild(this._renderer.view)):this._debugger.addError("No content parameter specified.")}},{key:"_setupContext",value:(t=l()(a.a.mark((function _callee(t){var r,i,o,u,l,_,c,h,p,d,m,v,y,g,b,k,x;return a.a.wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:if(void 0===t){a.next=54;break}return r=t.confirm,this._confirm=void 0===r?null:r,i=t.debug,this._debugger.enabled=void 0!==i&&i,o=t.fullScreen,this._fullScreen=void 0!==o&&o,u=t.introClick,this._screen._click=void 0===u||u,l=t.introScreen,this._screen._active=void 0===l||l,_=t.mimetype,this._mimetype=void 0===_?null:_,c=t.name,this._name=void 0===c?"noname.exp":c,h=t.onConsole,this._onConsole=void 0===h?null:h,p=t.onFinished,this._onFinished=void 0===p?null:p,d=t.onLog,this._onLog=void 0===d?null:d,m=t.onError,this._onError=void 0===m?null:m,v=t.prompt,this._prompt=void 0===v?null:v,y=t.scaleMode,this._scaleMode=void 0===y?"noScale":y,g=t.source,this._source=void 0===g?null:g,b=t.subject,this._subject=void 0===b?null:b,k=t.target,this._target=void 0===k?null:k,x=t.welcomeText,this._welcomeText=void 0===x?null:x,this._screen._setupIntroScreen(),this._screen._updateIntroScreen("Loading experiment."),this._screen._updateProgressBar(-1),a.prev=38,a.next=41,this._transfer._readSource(this._source);case 41:this._script=a.sent,a.next=49;break;case 44:return a.prev=44,a.t0=a.catch(38),this._debugger.addError("Error reading osexp: ".concat(a.t0)),this._exit(),a.abrupt("return");case 49:this._screen._updateIntroScreen("Building experiment structure."),this._build(),this._parameters._initialize(),a.next=55;break;case 54:this.debugger.addError("No context parameter specified.");case 55:case"end":return a.stop()}}),_callee,this,[[38,44]])}))),function _setupContext(r){return t.apply(this,arguments)})},{key:"_build",value:function _build(){this._experiment=new Lt(this,this._name,this._script),this._convertor.parseScript(this._script),this._experiment.from_string(this._script),this._onLog&&(this._experiment.onLog=this._onLog)}},{key:"_initialize",value:function _initialize(){this._debugger._initialize(),this._events._initialize(),this._pythonParser._initialize(),this._session._initialize(),this._experiment.prepare(),this._experiment.run()}},{key:"_finalize",value:function _finalize(){this._events._finalize(),this._debugger._finalize(),this._itemStore._clean_up(),this._pool._clean_up(),this._exit()}},{key:"_exit",value:function _exit(){this._screen._fullScreenExit(),this._experiment._canvas._exitDisplay(),this._experiment=null,this._onFinished&&this._onFinished(this._data,this._session._session)}},{key:"exit",value:function exit(){this._events._state=Xe.TIMER_BREAK}},{key:"run",value:function run(t){this._setupContext(t)}}]),Runner}(),Ut="osweb",Ht="1.4.13";String.prototype.replaceAll=function(t,r,i){return this.replace(new RegExp(t.replace(/([/,!\\^${}[]\(\)\.\*\+\?\|<>-&])/g,"\\$&"),i?"gi":"g"),"string"==typeof r?r.replace(/\$/g,"$$$$"):r)},String.prototype._pySlice=function(t,r,i){return null!==r?this.slice(t,r):this.slice(t)};var Bt={printVersionInfo:function printVersionInfo(){console.log("".concat(Ut," v").concat(Ht))},getRunner:function getRunner(t){return new Nt(t)}};"undefined"!=typeof window&&(window.alertify=i("./node_modules/alertifyjs/build/alertify.js"),i("./node_modules/alertifyjs/build/css/alertify.css"),i("./node_modules/alertifyjs/build/css/themes/default.css"),window.osweb=Bt,window.osweb.printVersionInfo())},"./src/js/osweb/backends/canvas.js":function(t,r,i){"use strict";i.d(r,"a",(function(){return h}));i("./node_modules/core-js/modules/es.symbol.js"),i("./node_modules/core-js/modules/es.symbol.description.js"),i("./node_modules/core-js/modules/es.symbol.iterator.js"),i("./node_modules/core-js/modules/es.array.concat.js"),i("./node_modules/core-js/modules/es.array.fill.js"),i("./node_modules/core-js/modules/es.array.from.js"),i("./node_modules/core-js/modules/es.array.includes.js"),i("./node_modules/core-js/modules/es.array.index-of.js"),i("./node_modules/core-js/modules/es.array.iterator.js"),i("./node_modules/core-js/modules/es.array.slice.js"),i("./node_modules/core-js/modules/es.array.some.js"),i("./node_modules/core-js/modules/es.function.name.js"),i("./node_modules/core-js/modules/es.object.assign.js"),i("./node_modules/core-js/modules/es.object.to-string.js"),i("./node_modules/core-js/modules/es.regexp.exec.js"),i("./node_modules/core-js/modules/es.regexp.to-string.js"),i("./node_modules/core-js/modules/es.string.iterator.js"),i("./node_modules/core-js/modules/es.string.replace.js"),i("./node_modules/core-js/modules/es.string.split.js"),i("./node_modules/core-js/modules/web.dom-collections.iterator.js");var o=i("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=i.n(o),u=i("./node_modules/@babel/runtime/helpers/createClass.js"),l=i.n(u),_=i("./node_modules/pixi.js/lib/pixi.es.js"),c=i("./src/js/osweb/backends/styles.js");function _createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function _unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return _arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _arrayLikeToArray(t,r)}(t))){var r=0,i=function F(){};return{s:i,n:function n(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,u=!0,l=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return u=t.done,t},e:function e(t){l=!0,a=t},f:function f(){try{u||null==o.return||o.return()}finally{if(l)throw a}}}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var h=function(){function Canvas(t,r){a()(this,Canvas),this.auto_prepare=void 0===r||r,this.experiment=t,this._container=new _.a,this._font_string="bold 18px Courier New",this._height=this.experiment._runner._renderer.height,this._styles=new c.a,this._width=this.experiment._runner._renderer.width,this._textures=[]}return l()(Canvas,[{key:"_arrow_shape",value:function _arrow_shape(t,r,i,o,a,u,l){var _=Math.sqrt(Math.pow(o-r,2)+Math.pow(t-i,2)),c=Math.atan2(o-r,i-t),h=(1-a)/2,p=[i,o],d=[t+(a/=2)*l*Math.cos(c-Math.PI/2),r+a*l*Math.sin(c-Math.PI/2)],m=[d[0]+u*Math.cos(c)*_,d[1]+u*Math.sin(c)*_],v=[m[0]+h*l*Math.cos(c-Math.PI/2),m[1]+h*l*Math.sin(c-Math.PI/2)],y=[t+a*l*Math.cos(c+Math.PI/2),r+a*l*Math.sin(c+Math.PI/2)],g=[y[0]+u*Math.cos(c)*_,y[1]+u*Math.sin(c)*_];return[d,m,v,p,[g[0]+h*l*Math.cos(c+Math.PI/2),g[1]+h*l*Math.sin(c+Math.PI/2)],g,y]}},{key:"_containsHTML",value:function _containsHTML(t){var r;try{return r=(new DOMParser).parseFromString(t,"text/html"),Array.from(r.childNodes).some((function(t){return 1===t.nodeType}))}catch(t){console.error("Could not parse DOM: "+t.message)}}},{key:"_exitDisplay",value:function _exitDisplay(){this.clear(),this.experiment._runner._renderer.view.style.cursor="default",this.experiment._runner._renderer.resize(800,600),this.experiment._runner._renderer.backgroundColor=0,this.experiment._runner._renderer.clear(),this.experiment._runner._renderer.render(this._container);try{document.body.style.backgroundColor="#FFFFFF"}catch(t){console.log("Could not reset body color to white",t)}}},{key:"_getStyle",value:function _getStyle(t){if(void 0===t)return this._styles;var r=new c.a;return Object.assign(r,t),r}},{key:"_getTextBaseline",value:function _getTextBaseline(t,r,i,o){var a=document.createElement("span");a.style.fontFamily=r||"Arial",a.style.fontWeight=!0===o?"bold":"normal",a.style.fontSize=String(i)+"px",a.innerHTML=t;var u=document.createElement("div");u.style.display="inline-block",u.style.lineHeight="normal";var l=document.createElement("div");l.append(a,u),document.body.appendChild(l);var _,c,h={};return u.style.verticalAlign="baseline",_=u.getBoundingClientRect().top+document.body.scrollTop,c=a.getBoundingClientRect().top+document.body.scrollTop,h.ascent=Math.round(_-c),u.style.verticalAlign="bottom",_=u.getBoundingClientRect().top+document.body.scrollTop,c=a.getBoundingClientRect().top+document.body.scrollTop,h.height=Math.round(_-c),h.descent=h.height-h.ascent,document.body.removeChild(l),h}},{key:"_match_env",value:function _match_env(t){return["c","circular","round"].includes(t)?"c":["g","gaussian","gauss","normal","rect","square"].includes(t)?"g":["rectangular","rectangle"].includes(t)?"r":["l","linear","lin","ln"].includes(t)?"l":"g"}},{key:"_parseHtmlNode",value:function _parseHtmlNode(t,r,i){var o=this._getStyle(i);switch(t.nodeType){case 1:switch(t.nodeName){case"B":o.font_bold=!0;break;case"BR":r.row.height=r.row.height>0?r.row.height:r.prev_height,r.row.width=r.x_pos>r.row.width?r.x_pos:r.row.width,r.width=r.width>r.row.width?r.width:r.row.width,r.y_pos=r.y_pos+r.row.height,r.x_pos=4,r.height=r.height+r.row.height,r.rows.push(r.row),r.row={ascent:0,width:0,height:0,text_elements:[],text_dimensions:[],text_underline:[]};break;case"I":o.font_italic=!0;break;case"SPAN":if(t.attributes.length>0)for(var a=t.attributes[0].value.split(";"),u=0;u<a.length;u++){var l=a[u].slice(0,a[u].indexOf(":")),c=a[u].slice(a[u].indexOf(":")+1,a[u].length);switch(l){case"color":o.color=c;break;case"font-size":o.font_size=c;break;case"font-family":o.font_family=c}}break;case"U":o.font_underline=!0}break;case 3:var h={fontFamily:o.font_family,fontStyle:!0===o.font_italic?"italic":"normal",fontWeight:!0===o.font_bold?"bold":"normal",fontSize:o.font_size,fill:o.color},p={},d=new _.d(t.textContent,h);this._textures.push(d),d.getBounds(!1,p);var m=this._getTextBaseline(t.textContent,o.font_family,o.font_size,o.font_bold);d.x=r.x_pos,d.y=r.y_pos,r.x_pos=r.x_pos+p.width,r.row.width=r.x_pos>r.row.width?r.x_pos:r.row.width,r.width=r.width>r.row.width?r.width:r.row.width,r.row.height=p.height+1>r.row.height?p.height+1:r.row.height,r.row.ascent=m.ascent>r.row.ascent?m.ascent:r.row.ascent,r.prev_height=r.row.height,r.row.text_elements.push(d),r.row.text_dimensions.push(m),r.row.text_underline.push(o.font_underline)}for(var v=0;v<t.childNodes.length;v++)this._parseHtmlNode(t.childNodes[v],r,o,v===t.childNodes.length-1)}},{key:"_resizeContainer",value:function _resizeContainer(t,r){this.experiment._runner._container.style.width=t+"px",this.experiment._runner._container.style.height=r+"px"}},{key:"arrow",value:function arrow(t,r,i,o,a,u,l,_){var c=this._arrow_shape(t,r,i,o,a,u,l);this.polygon(c,_)}},{key:"circle",value:function circle(t,r,i,o){var a=this._getStyle(o),circle=new _.b;circle.lineStyle(a.penwidth,a.color,1),!0===a.fill?(circle.beginFill(a.color),circle.drawCircle(0,0,i),circle.endFill()):circle.drawCircle(0,0,i),circle.x=t,circle.y=r,this._container.addChild(circle)}},{key:"clear",value:function clear(t,r){for(var i=this._container.children.length-1;i>=0;i--)this._container.removeChild(this._container.children[i]);for(;this._textures.length>0;)this._textures.pop().destroy(!0)}},{key:"copy",value:function copy(t){this.clear();var r,i=_createForOfIteratorHelper(t._container.children);try{for(i.s();!(r=i.n()).done;){var o=r.value;this._container.addChild(o.clone())}}catch(t){i.e(t)}finally{i.f()}}},{key:"ellipse",value:function ellipse(t,r,i,o,a){var u=this._getStyle(a),ellipse=new _.b;ellipse.lineStyle(u.penwidth,u.color,1),!0===u.fill?(ellipse.beginFill(u.color),ellipse.drawEllipse(0,0,i/2,o/2),ellipse.endFill()):ellipse.drawEllipse(0,0,i/2,o/2),ellipse.x=t+i/2,ellipse.y=r+o/2,this._container.addChild(ellipse)}},{key:"fixdot",value:function fixdot(t,r,i,o){i=void 0===i?"default":i;var a=this._getStyle(o);void 0===t&&(t=!0===this.uniform_coordinates?0:this._width/2),void 0===r&&(r=!0===this.uniform_coordinates?0:this._height/2);var u=4;-1!==i.indexOf("large")?u=16:-1!==i.indexOf("medium")||"default"===i?u=8:-1!==i.indexOf("small")?u=4:this.experiment._runner._debugger.addError("Unknown style: "+i);var l=new c.a;-1!==i.indexOf("open")||"default"===i?(l._fill=!0,l._background_color=a.color,l._color=a.color,this.ellipse(t-u,r-u,2*u,2*u,l),l._background_color=a.background_color,l._color=a.background_color,this.ellipse(t-2,r-2,4,4,l)):-1!==i.indexOf("filled")?(l._fill=!0,l._background_color=a.color,l._color=a.color,this.ellipse(t-u,r-u,2*u,2*u,l)):-1!==i.indexOf("cross")?(l._penwidth=1,l._color=a.color,this.line(t,r-u,t,r+u,l),this.line(t-u,r,t+u,r,l)):this.experiment._runner._debugger.addError("Unknown style: "+i)}},{key:"gabor",value:function gabor(t,r,i,o,a,u,l,c,h,p,d){a=this._match_env(a);var m=document.createElement("canvas");m.width=u,m.height=u;var v=m.getContext("2d"),y=v.getImageData(0,0,u,u);i=Math.PI*i/-180,h=this._styles._convertColorValueToRGB(h),p=this._styles._convertColorValueToRGB(p);for(var g=0;g<u;g++)for(var b=0;b<u;b++){var k=g-.5*u,x=b-.5*u,w=Math.atan2(x,k)+i,S=Math.sqrt(Math.pow(k,2)+Math.pow(x,2)),E=S*Math.cos(w),R=S*Math.sin(w),j=void 0,T=.5+.5*Math.cos(2*Math.PI*(E*o+c));j="g"===a?Math.exp(-.5*Math.pow(E/l,2)-.5*Math.pow(R/l,2)):"l"===a?Math.max(0,(.5*u-S)/(.5*u)):"c"===a&&S>.5*u?0:1,"avg"===d?T=T*j+.5*(1-j):T*=j;var C={r:h[0]*T+p[0]*(1-T),g:h[1]*T+p[1]*(1-T),b:h[2]*T+p[2]*(1-T)},I=4*g+b*u*4;y.data[I]=C.r,y.data[I+1]=C.g,y.data[I+2]=C.b,y.data[I+3]=255}v.putImageData(y,0,0);var O=_.e.from(m);this._textures.push(O);var A=new _.c(O);A.x=t-u/2,A.y=r-u/2,this._container.addChild(A)}},{key:"image",value:function image(t,r,i,o,a,u){var l=this.experiment._runner._syntax.remove_quotes(t),c=this.experiment._runner._pool[l];void 0===c&&this.experiment._runner._debugger.addError('"'.concat(t,'" does not exist in the file pool'));var h=c.data,p=document.createElement("canvas");p.width=h.width,p.height=h.height,p.getContext("2d").drawImage(h,0,0);var d=_.e.from(p);this._textures.push(d);var m=new _.c(d);void 0!==a&&(m.scale.x=a,m.scale.y=a),void 0!==u&&(m.angle=u),-1!==[1,"1",!0,"yes"].indexOf(r)?(m.x=Math.floor(i-m.width/2),m.y=Math.floor(o-m.height/2)):(m.x=i,m.y=o),console.log(m.x),this._container.addChild(m)}},{key:"init_display",value:function init_display(t){this._height=t.vars.height,this._width=t.vars.width,t._runner._renderer.resize(this._width,this._height),t._runner._renderer.clear(this._styles._convertColorValue(t.vars.background,"number")),t._runner._renderer.backgroundColor=this._styles._convertColorValue(t.vars.background,"number"),t._runner._renderer.view.style.cursor="none",t._runner._screen._fullScreenInit(),t._runner._renderer.view.focus()}},{key:"line",value:function line(t,r,i,o,a){var u=this._getStyle(a),line=new _.b;line.lineStyle(u.penwidth,u.color,1),line.moveTo(0,0),line.lineTo(i-t,o-r),line.x=t,line.y=r,this._container.addChild(line)}},{key:"noise",value:function noise(t,r,i,o,a,u,l,c){i=this._match_env(i);var h=document.createElement("canvas");h.width=o,h.height=o;var p=h.getContext("2d"),d=p.getImageData(0,0,o,o);u=this._styles._convertColorValueToRGB(u),l=this._styles._convertColorValueToRGB(l);for(var m=0;m<o;m++)for(var v=0;v<o;v++){var y=m-.5*o,g=v-.5*o,b=Math.sqrt(Math.pow(y,2)+Math.pow(g,2)),k=void 0,x=Math.random();k="g"===i?Math.exp(-.5*Math.pow(y/a,2)-.5*Math.pow(g/a,2)):"l"===i?Math.max(0,(.5*o-b)/(.5*o)):"c"===i&&b>.5*o?0:1,"avg"===c?x=x*k+.5*(1-k):x*=k;var w={r:u[0]*x+l[0]*(1-x),g:u[1]*x+l[1]*(1-x),b:u[2]*x+l[2]*(1-x)},S=4*m+v*o*4;d.data[S]=w.r,d.data[S+1]=w.g,d.data[S+2]=w.b,d.data[S+3]=255}p.putImageData(d,0,0);var E=_.e.from(h);this._textures.push(E);var R=new _.c(E);R.x=t-o/2,R.y=r-o/2,this._container.addChild(R)}},{key:"polygon",value:function polygon(t,r){for(var i=this._getStyle(r),o=[],a=0;a<t.length;a++)o.push(t[a][0]),o.push(t[a][1]);o.push(t[0][0]),o.push(t[0][1]);var polygon=new _.b;polygon.lineStyle(i.penwidth,i.color,1),!0===i.fill&&polygon.beginFill(i.color),polygon.drawPolygon(o),!0===i.fill&&polygon.endFill(),this._container.addChild(polygon)}},{key:"prepare",value:function prepare(){}},{key:"rect",value:function rect(t,r,i,o,a){var u=this._getStyle(a),l=new _.b;l.lineStyle(u.penwidth,u.color,1),!0===u.fill?(l.beginFill(u.color),l.drawRect(0,0,i,o),l.endFill()):l.drawRect(0,0,i,o),l.x=t,l.y=r,this._container.addChild(l)}},{key:"size",value:function size(){var size={width:this._width,height:this._height};return size}},{key:"show",value:function show(t){t=void 0!==t?t:this.experiment,this.experiment._currentCanvas=this,this._container.scale.x=this.experiment._scale_x,this._container.scale.y=this.experiment._scale_y,this.experiment._runner._renderer.backgroundColor=this._styles._background_color;try{var r=this._styles.rgb;document.body.style.backgroundColor="rgb(".concat(r.r,",").concat(r.g,",").concat(r.b,")")}catch(t){console.error(t)}return this.experiment._runner._renderer.render(this._container),null!=t?t.clock.time():null}},{key:"text",value:function text(t,r,i,o,a,u){t=t.toString().replace("\n","<br />");var l=this._getStyle(u);if("yes"===a&&this._containsHTML(t)){var c={element_style:l,height:0,prev_height:0,row:{ascent:0,height:0,text_elements:[],text_dimensions:[],text_underline:[],width:0},rows:[],styles:[],width:0,x_pos:4,y_pos:0},h=document.createElement("div");document.body.appendChild(h),h.style.fontFamily=l.font_family,h.style.fontSize=String(l.font_size)+"px",h.style.fontWeight=!0===l.font_bold?"bold":"normal",h.style.lineHeight="normal",h.style.display="inline-block",h.style.visibility="hidden",h.innerHTML=t,this._parseHtmlNode(h,c,l),document.body.removeChild(h),0!==c.row.text_elements.length&&(c.height=c.height+c.row.height,c.rows.push(c.row)),c.y_pos=0;for(var p=0;p<c.rows.length;p++){for(var d=0;d<c.rows[p].text_elements.length;d++){var m=c.rows[p].ascent-c.rows[p].text_dimensions[d].ascent;c.rows[p].text_elements[d].y=c.y_pos+m,-1!==[1,"1",!0,"yes"].indexOf(r)?(c.rows[p].text_elements[d].x=c.rows[p].text_elements[d].x+i-Math.floor(c.rows[p].width/2),c.rows[p].text_elements[d].y=c.rows[p].text_elements[d].y+o-Math.floor(c.height/2)):(c.rows[p].text_elements[d].x=c.rows[p].text_elements[d].x+i,c.rows[p].text_elements[d].y=c.rows[p].text_elements[d].y+o+6),!0===c.rows[p].text_underline[d]&&this.line(c.rows[p].text_elements[d].x,c.rows[p].text_elements[d].y+c.rows[p].text_dimensions[d].ascent+7,c.rows[p].text_elements[d].x+c.rows[p].text_elements[d].width,c.rows[p].text_elements[d].y+c.rows[p].text_dimensions[d].ascent+7,l),this._container.addChild(c.rows[p].text_elements[d])}c.y_pos=c.y_pos+c.rows[p].height}}else{var v={fontFamily:l.font_family,fontSize:l.font_size,fontWeight:!0===l.font_bold?"bold":"normal",fill:l.color},y=new _.d(t,v);this._textures.push(y),-1!==[1,"1",!0,"yes"].indexOf(r)?(y.x=Math.floor(i-y.width/2),y.y=Math.floor(o-y.height/2)):(y.x=i,y.y=o),console.log(y.x),this._container.addChild(y)}}},{key:"height",get:function get(){return this._height}},{key:"width",get:function get(){return this._width}}]),Canvas}()},"./src/js/osweb/backends/styles.js":function(t,r,i){"use strict";i.d(r,"a",(function(){return j}));i("./node_modules/core-js/modules/es.array.fill.js"),i("./node_modules/core-js/modules/es.array.index-of.js"),i("./node_modules/core-js/modules/es.array.map.js"),i("./node_modules/core-js/modules/es.array.slice.js"),i("./node_modules/core-js/modules/es.number.constructor.js"),i("./node_modules/core-js/modules/es.regexp.exec.js"),i("./node_modules/core-js/modules/es.string.match.js");var o=i("./node_modules/@babel/runtime/helpers/typeof.js"),a=i.n(o),u=i("./node_modules/@babel/runtime/helpers/slicedToArray.js"),l=i.n(u),_=i("./node_modules/@babel/runtime/helpers/classCallCheck.js"),c=i.n(_),h=i("./node_modules/@babel/runtime/helpers/createClass.js"),p=i.n(h),d=i("./node_modules/lodash/isInteger.js"),m=i.n(d),v=i("./node_modules/lodash/isArray.js"),y=i.n(v),g=i("./node_modules/color-convert/index.js"),b=i.n(g),k=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i,x=/rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/i,w=/rgb\(\s*([+-]?([0-9]+([.][0-9]*)?|[.][0-9]+))\s*%\s*,\s*([+-]?([0-9]+([.][0-9]*)?|[.][0-9]+))\s*%\s*,\s*([+-]?([0-9]+([.][0-9]*)?|[.][0-9]+))\s*%\s*\)/i,S=/hsv\(\s*([+-]?([0-9]+([.][0-9]*)?|[.][0-9]+))\s*\s*,\s*([+-]?([0-9]+([.][0-9]*)?|[.][0-9]+))\s*%\s*,\s*([+-]?([0-9]+([.][0-9]*)?|[.][0-9]+))\s*%\s*\)/i,E=/hsl\(\s*([+-]?([0-9]+([.][0-9]*)?|[.][0-9]+))\s*\s*,\s*([+-]?([0-9]+([.][0-9]*)?|[.][0-9]+))\s*%\s*,\s*([+-]?([0-9]+([.][0-9]*)?|[.][0-9]+))\s*%\s*\)/i,R=/lab\(\s*([+-]?([0-9]+([.][0-9]*)?|[.][0-9]+))\s*\s*,\s*([+-]?([0-9]+([.][0-9]*)?|[.][0-9]+))\s*\s*,\s*([+-]?([0-9]+([.][0-9]*)?|[.][0-9]+))\s*\s*\)/i,j=function(){function Styles(t){c()(this,Styles),this._initConstants(),void 0===t?(this._background_color=0,this._bidi=!1,this._color="white",this._fill=!1,this._font_bold=!1,this._font_family="Arial",this._font_italic=!1,this._font_size=24,this._font_underline=!1,this._html=!1,this._penwidth=1):(this.background_color=t.vars.get("background",0),this.bidi=t.vars.get("bidi","no"),this.color=t.vars.get("foreground","white"),this.fill="yes"===t.vars.get("fill","no"),this.font_bold=t.vars.get("font_bold","no"),this.font_family=t.vars.get("font_family","Arial"),this.font_italic=t.vars.get("font_italic","no"),this.font_size=t.vars.get("font_size",24),this.font_underline=t.vars.get("font_underline","no"),this.html=t.vars.get("html","no"),this.penwidth=t.vars.get("penwidth",1))}return p()(Styles,[{key:"_convertColorValue",value:function _convertColorValue(t){var r=this._convertColorValueToRGB(t).map(Math.round),i=l()(r,3);return 65536*i[0]+256*i[1]+i[2]}},{key:"_matchFloats",value:function _matchFloats(t,r){var i=t.match(r);return[i[1],i[4],i[7]].map(Number)}},{key:"_convertColorValueToRGB",value:function _convertColorValueToRGB(t){if("string"==typeof t){t=t.toLowerCase();var r=b.a.keyword.rgb(t);if(void 0!==r)return r;if(!0===k.test(t))return b.a.hex.rgb(t);if(!0===x.test(t))return t.match(x).slice(1,4).map(Number);if(!0===w.test(t))return this._matchFloats(t,w).map((function(t){return 2.55*t}));if(!0===S.test(t))return b.a.hsv.rgb(this._matchFloats(t,S));if(!0===E.test(t))return b.a.hsl.rgb(this._matchFloats(t,E));if(!0===R.test(t))return b.a.lab.rgb(this._matchFloats(t,R));isNaN(Number(t))||(t=Number(t))}if(m()(t))return[t,t,t];if(y()(t)&&3==t.length)return t.map(Number);throw"Invalid color specification: "+t+" ("+a()(t)+")"}},{key:"_isInt",value:function _isInt(t){return m()(t)}},{key:"_checkVal",value:function _checkVal(t){return-1!==[!0,"yes",1,"1"].indexOf(t)}},{key:"_initConstants",value:function _initConstants(){this._DEFAULT_FONTS={sans:"Droid Sans",serif:"Droid Serif",mono:"Droid Sans Mono","chinese-japanese-korean":"WenQuanYi Micro Hei",arabic:"Droid Arabic Naskh",hebrew:"Droid Sans Hebrew",hindi:"Lohit Hindi"}}},{key:"rgb",get:function get(){return this._convertColorValue(this._background_color)},set:function set(t){}},{key:"background_color",get:function get(){return this._background_color},set:function set(t){this._background_color=this._convertColorValue(t,"number")}},{key:"bidi",get:function get(){return this._bidi},set:function set(t){this._bidi=this._checkVal(t)}},{key:"color",get:function get(){return this._color},set:function set(t){this._color=this._convertColorValue(t,"number")}},{key:"fill",get:function get(){return this._fill},set:function set(t){this._fill=-1!==[1,"1",!0,"yes"].indexOf(t)}},{key:"font_bold",get:function get(){return this._font_bold},set:function set(t){this._font_bold=this._checkVal(t)}},{key:"font_family",get:function get(){return this._font_family},set:function set(t){t in this._DEFAULT_FONTS?this._font_family=this._DEFAULT_FONTS[t]:this._font_family=t}},{key:"font_italic",get:function get(){return this._font_italic},set:function set(t){this._font_italic=this._checkVal(t)}},{key:"font_size",get:function get(){return this._font_size},set:function set(t){this._isInt(t)?this._font_size=t:this._font_size=Number(t.slice(0,-2))}},{key:"font_underline",get:function get(){return this._font_underline},set:function set(t){this._font_underline=this._checkVal(t)}},{key:"html",get:function get(){return this._html},set:function set(t){this._html=this._checkVal(t)}},{key:"penwidth",get:function get(){return this._penwidth},set:function set(t){this._isInt(t)||(this._penwidth=1),this._penwidth=t}}]),Styles}()},"./src/js/osweb/classes/canvas_handler.js":function(t,r,i){"use strict";i.d(r,"a",(function(){return v}));i("./node_modules/core-js/modules/es.symbol.js"),i("./node_modules/core-js/modules/es.symbol.description.js"),i("./node_modules/core-js/modules/es.symbol.iterator.js"),i("./node_modules/core-js/modules/es.array.fill.js"),i("./node_modules/core-js/modules/es.array.from.js"),i("./node_modules/core-js/modules/es.array.iterator.js"),i("./node_modules/core-js/modules/es.array.slice.js"),i("./node_modules/core-js/modules/es.function.name.js"),i("./node_modules/core-js/modules/es.object.assign.js"),i("./node_modules/core-js/modules/es.object.to-string.js"),i("./node_modules/core-js/modules/es.regexp.to-string.js"),i("./node_modules/core-js/modules/es.string.iterator.js"),i("./node_modules/core-js/modules/web.dom-collections.iterator.js");var o=i("./node_modules/@babel/runtime/helpers/slicedToArray.js"),a=i.n(o),u=i("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),l=i.n(u),_=i("./node_modules/@babel/runtime/helpers/classCallCheck.js"),c=i.n(_),h=i("./node_modules/@babel/runtime/helpers/createClass.js"),p=i.n(h),d=i("./src/js/osweb/backends/styles.js"),m=i("./src/js/osweb/backends/canvas.js");function _createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function _unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return _arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _arrayLikeToArray(t,r)}(t))){var r=0,i=function F(){};return{s:i,n:function n(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,u=!0,l=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return u=t.done,t},e:function e(t){l=!0,a=t},f:function f(){try{u||null==o.return||o.return()}finally{if(l)throw a}}}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var v=function(){function CanvasHandler(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};c()(this,CanvasHandler),this._style=new d.a(t),this._canvas=new m.a(t),this._canvas._styles=this._style,Object.assign(this._style,r),this._xc=this._canvas.width/(2*t._scale_x),this._yc=this._canvas.height/(2*t._scale_y)}return p()(CanvasHandler,[{key:"_element_style",value:function _element_style(t){if(void 0===t)return this._style;var r=new d.a;return Object.assign(r,this._style),Object.assign(r,t),r}},{key:"arrow",value:function arrow(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.sx,i=void 0===r?0:r,o=t.sy,a=void 0===o?0:o,u=t.ex,_=void 0===u?50:u,c=t.ey,h=void 0===c?0:c,p=t.body_length,d=void 0===p?.8:p,m=t.body_width,v=void 0===m?.5:m,y=t.head_width,g=void 0===y?30:y,b=l()(t,["sx","sy","ex","ey","body_length","body_width","head_width"]);this._canvas.arrow(i+this._xc,a+this._yc,_+this._xc,h+this._yc,v,d,g,this._element_style(b))}},{key:"clear",value:function clear(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._canvas.clear(this._element_style(t).background_color)}},{key:"circle",value:function circle(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.x,i=void 0===r?0:r,o=t.y,a=void 0===o?0:o,u=t.r,_=void 0===u?50:u,c=l()(t,["x","y","r"]);this._canvas.circle(i+this._xc,a+this._yc,_,this._element_style(c))}},{key:"ellipse",value:function ellipse(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.x,i=void 0===r?-50:r,o=t.y,a=void 0===o?-25:o,u=t.w,_=void 0===u?100:u,c=t.h,h=void 0===c?50:c,p=l()(t,["x","y","w","h"]);this._canvas.ellipse(i+this._xc,a+this._yc,_,h,this._element_style(p))}},{key:"fixdot",value:function fixdot(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.x,i=void 0===r?0:r,o=t.y,a=void 0===o?0:o,u=t.style,_=void 0===u?"default":u,c=l()(t,["x","y","style"]);this._canvas.fixdot(i+this._xc,a+this._yc,_,this._element_style(c))}},{key:"gabor",value:function gabor(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.x,i=void 0===r?0:r,o=t.y,a=void 0===o?0:o,u=t.orient,l=void 0===u?0:u,_=t.freq,c=void 0===_?.1:_,h=t.env,p=void 0===h?"gaussian":h,d=t.size,m=void 0===d?96:d,v=t.stdev,y=void 0===v?12:v,g=t.phase,b=void 0===g?0:g,k=t.col1,x=void 0===k?"white":k,w=t.col2,S=void 0===w?"black":w,E=t.bgmode,R=void 0===E?"avg":E;this._canvas.gabor(i+this._xc,a+this._yc,l,c,p,m,y,b,x,S,R)}},{key:"image",value:function image(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.fname,i=t.center,o=void 0===i||i,a=t.x,u=void 0===a?0:a,l=t.y,_=void 0===l?0:l,c=t.scale,h=void 0===c?1:c,p=t.rotation,d=void 0===p?0:p;if(void 0===r)throw"fname is a required parameter for Canvas.image()";this._canvas.image(r,o,u+this._xc,_+this._yc,h,d)}},{key:"line",value:function line(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.sx,i=void 0===r?0:r,o=t.sy,a=void 0===o?0:o,u=t.ex,_=void 0===u?50:u,c=t.ey,h=void 0===c?0:c,p=l()(t,["sx","sy","ex","ey"]);this._canvas.line(i+this._xc,a+this._yc,_+this._xc,h+this._yc,this._element_style(p))}},{key:"noise_patch",value:function noise_patch(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.x,i=void 0===r?0:r,o=t.y,a=void 0===o?0:o,u=t.env,l=void 0===u?"gaussian":u,_=t.size,c=void 0===_?96:_,h=t.stdev,p=void 0===h?12:h,d=t.col1,m=void 0===d?"white":d,v=t.col2,y=void 0===v?"black":v,g=t.bgmode,b=void 0===g?"avg":g;this._canvas.noise(i+this._xc,a+this._yc,l,c,p,m,y,b)}},{key:"polygon",value:function polygon(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.vertices,i=l()(t,["vertices"]);if(void 0===r)throw"vertices is a required parameter for Canvas.polygon()";var o,u=[],_=_createForOfIteratorHelper(r);try{for(_.s();!(o=_.n()).done;){var c=a()(o.value,2),h=c[0],p=c[1];u.push([h+this._xc,p+this._yc])}}catch(t){_.e(t)}finally{_.f()}this._canvas.polygon(u,this._element_style(i))}},{key:"rect",value:function rect(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.x,i=void 0===r?-50:r,o=t.y,a=void 0===o?-25:o,u=t.w,_=void 0===u?100:u,c=t.h,h=void 0===c?50:c,p=l()(t,["x","y","w","h"]);this._canvas.rect(i+this._xc,a+this._yc,_,h,this._element_style(p))}},{key:"show",value:function show(){return this._canvas.show()}},{key:"text",value:function text(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.text,i=t.center,o=void 0===i||i,a=t.x,u=void 0===a?0:a,_=t.y,c=void 0===_?0:_,h=l()(t,["text","center","x","y"]);if(void 0===r)throw"text is a required parameter for Canvas.text()";var p=this._element_style(h);this._canvas.text(r,o,u+this._xc,c+this._yc,p.html,p)}},{key:"color",get:function get(){return this._style.color},set:function set(t){this._style.color=t}},{key:"background_color",get:function get(){return this._style.background_color},set:function set(t){this._style.background_color=t}},{key:"fill",get:function get(){return this._style.fill},set:function set(t){this._style.fill=t}},{key:"html",get:function get(){return this._style.html},set:function set(t){this._style.html=t}},{key:"font_family",get:function get(){return this._style.font_family},set:function set(t){this._style.font_family=t}},{key:"font_size",get:function get(){return this._style.font_size},set:function set(t){this._style.font_size=t}},{key:"font_italic",get:function get(){return this._style.font_italic},set:function set(t){this._style.font_italic=t}},{key:"font_bold",get:function get(){return this._style.font_bold},set:function set(t){this._style.font_bold=t}},{key:"font_underline",get:function get(){return this._style.font_underline},set:function set(t){this._style.font_underline=t}}]),CanvasHandler}()},"./src/js/osweb/classes/javascript_workspace.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return JavaScriptWorkspace}));var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),_classes_canvas_handler__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/js/osweb/classes/canvas_handler.js"),_classes_javascript_workspace_api__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/js/osweb/classes/javascript_workspace_api.js"),random_ext__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/random-ext/index.js"),random_ext__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(random_ext__WEBPACK_IMPORTED_MODULE_4__),color_convert__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/color-convert/index.js"),color_convert__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(color_convert__WEBPACK_IMPORTED_MODULE_5__),csv_parse_lib_sync__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/csv-parse/lib/sync.js"),csv_parse_lib_sync__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(csv_parse_lib_sync__WEBPACK_IMPORTED_MODULE_6__),pythonic__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/pythonic/index.js"),pythonic__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(pythonic__WEBPACK_IMPORTED_MODULE_7__),VarStoreHandler=function(){function VarStoreHandler(){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,VarStoreHandler)}return _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(VarStoreHandler,[{key:"get",value:function get(t,r){return!0===t._bypass_proxy?t[r]:"string"==typeof t[r]?t.get(r,null,!0,null,!1):t[r]}}]),VarStoreHandler}(),JavaScriptWorkspace=function(){function JavaScriptWorkspace(t){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,JavaScriptWorkspace),this.experiment=t,this.vars_proxy=new Proxy(this.experiment.vars,new VarStoreHandler),this.api=new _classes_javascript_workspace_api__WEBPACK_IMPORTED_MODULE_3__.a(this.experiment),this._persistent={}}return _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(JavaScriptWorkspace,[{key:"_eval",value:function _eval(js){var _this=this,vars=this.vars_proxy,Canvas=function Canvas(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new _classes_canvas_handler__WEBPACK_IMPORTED_MODULE_2__.a(_this.experiment,t)},pool=this.experiment.pool,persistent=this._persistent,reset_feedback=this.api.reset_feedback.bind(this.api),set_subject_nr=this.api.set_subject_nr.bind(this.api),sometimes=this.api.sometimes.bind(this.api),xy_from_polar=this.api.xy_from_polar.bind(this.api),xy_to_polar=this.api.xy_to_polar.bind(this.api),xy_distance=this.api.xy_distance.bind(this.api),xy_circle=this.api.xy_circle.bind(this.api),xy_grid=this.api.xy_grid.bind(this.api),xy_random=this.api.xy_random.bind(this.api),random=random_ext__WEBPACK_IMPORTED_MODULE_4___default.a,convert=color_convert__WEBPACK_IMPORTED_MODULE_5___default.a,csvParse=csv_parse_lib_sync__WEBPACK_IMPORTED_MODULE_6___default.a,range=pythonic__WEBPACK_IMPORTED_MODULE_7__.range,zip=pythonic__WEBPACK_IMPORTED_MODULE_7__.zip,zipLongest=pythonic__WEBPACK_IMPORTED_MODULE_7__.zipLongest,enumerate=pythonic__WEBPACK_IMPORTED_MODULE_7__.enumerate,items=pythonic__WEBPACK_IMPORTED_MODULE_7__.items;eval(js)}}]),JavaScriptWorkspace}()},"./src/js/osweb/classes/javascript_workspace_api.js":function(t,r,i){"use strict";i.d(r,"a",(function(){return m}));i("./node_modules/core-js/modules/es.symbol.js"),i("./node_modules/core-js/modules/es.symbol.description.js"),i("./node_modules/core-js/modules/es.symbol.iterator.js"),i("./node_modules/core-js/modules/es.array.from.js"),i("./node_modules/core-js/modules/es.array.iterator.js"),i("./node_modules/core-js/modules/es.array.slice.js"),i("./node_modules/core-js/modules/es.function.name.js"),i("./node_modules/core-js/modules/es.object.to-string.js"),i("./node_modules/core-js/modules/es.regexp.to-string.js"),i("./node_modules/core-js/modules/es.string.iterator.js"),i("./node_modules/core-js/modules/web.dom-collections.iterator.js");var o=i("./node_modules/@babel/runtime/helpers/typeof.js"),a=i.n(o),u=i("./node_modules/@babel/runtime/helpers/slicedToArray.js"),l=i.n(u),_=i("./node_modules/@babel/runtime/helpers/classCallCheck.js"),c=i.n(_),h=i("./node_modules/@babel/runtime/helpers/createClass.js"),p=i.n(h),d=i("./node_modules/pythonic/index.js");function _createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function _unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return _arrayLikeToArray(t,r);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _arrayLikeToArray(t,r)}(t))){var r=0,i=function F(){};return{s:i,n:function n(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function e(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,u=!0,l=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return u=t.done,t},e:function e(t){l=!0,a=t},f:function f(){try{u||null==o.return||o.return()}finally{if(l)throw a}}}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var i=0,o=new Array(r);i<r;i++)o[i]=t[i];return o}var m=function(){function JavaScriptWorkspaceAPI(t){c()(this,JavaScriptWorkspaceAPI),this._experiment=t}return p()(JavaScriptWorkspaceAPI,[{key:"reset_feedback",value:function reset_feedback(){this._experiment.reset_feedback()}},{key:"set_subject_nr",value:function set_subject_nr(t){this._experiment.set_subject(t)}},{key:"sometimes",value:function sometimes(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5;if("number"!=typeof t||t<0||t>1)throw"p should be a numeric value between 0 and 1";return Math.random()<t}},{key:"xy_from_polar",value:function xy_from_polar(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0];if("number"!=typeof t)throw"rho should be numeric in xy_from_polar()";if("number"!=typeof r)throw"phi should be numeric in xy_from_polar()";r=this._radians(r);var o=this._parse_pole(i),a=l()(o,2),u=a[0],_=a[1],c=t*Math.cos(r)+u,h=t*Math.sin(r)+_;return[c,h]}},{key:"xy_to_polar",value:function xy_to_polar(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0];if("number"!=typeof t)throw"x should be numeric in xy_to_polar()";if("number"!=typeof r)throw"y should be numeric in xy_to_polar()";var o=this._parse_pole(i),a=l()(o,2),u=a[0],_=a[1],c=t-u,h=r-_,p=Math.sqrt(Math.pow(c,2)+Math.pow(h,2)),d=this._degrees(Math.atan2(h,c));return[p,d]}},{key:"xy_distance",value:function xy_distance(t,r,i,o){if("number"!=typeof t||"number"!=typeof r||"number"!=typeof i||"number"!=typeof o)throw"Coordinates should be numeric in xy_distance()";return Math.sqrt(Math.pow(t-i,2)+Math.pow(r-o,2))}},{key:"xy_circle",value:function xy_circle(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0];if("number"!=typeof t||t<0)throw"n should be a non-negative integer in xy_circle()";if("number"!=typeof r||"number"!=typeof i)throw"rho and phi0 should be numeric in xy_circle()";var a,u=[],l=_createForOfIteratorHelper(Object(d.range)(t));try{for(l.s();!(a=l.n()).done;){a.value;u.push(this.xy_from_polar(r,i,o)),i+=360/t}}catch(t){l.e(t)}finally{l.f()}return u}},{key:"xy_grid",value:function xy_grid(t,r){var i,o,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],_="n should be a single non-negative number, or an array of two non-negative numbers in xy_grid()";if("object"===a()(t)){if(2!==t.length)throw _[o]=t}else i=t,o=t;if("number"!=typeof i||"number"!=typeof o)throw _;var c,h,p="spacing should be a single non-negative number, or an array of two non-negative numbers xy_grid()";if("object"===a()(r)){if(2!==r.length)throw p[h]=r}else c=r,h=r;if("number"!=typeof c||"number"!=typeof h)throw p;var m,v,y,g=this._parse_pole(u),b=l()(g,2),k=b[0],x=b[1],w=[],S=_createForOfIteratorHelper(Object(d.range)(o));try{for(S.s();!(y=S.n()).done;){var E=y.value;v=(E-(o-1)/2)*h+x;var R,j=_createForOfIteratorHelper(Object(d.range)(i));try{for(j.s();!(R=j.n()).done;){var T=R.value;m=(T-(i-1)/2)*c+k,w.push([m,v])}}catch(t){j.e(t)}finally{j.f()}}}catch(t){S.e(t)}finally{S.f()}return w}},{key:"xy_random",value:function xy_random(t,r,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[0,0];if("number"!=typeof t||t<0)throw"n should be a non-negative number in xy_circle()";if("number"!=typeof o||t<0)throw"min_dist should be a non-negative number in xy_circle()";if("number"!=typeof r||"number"!=typeof i)throw"width and height should be numeric in xy_circle()";var u,_,c,h,p,m,v,y=this._parse_pole(a),g=l()(y,2),b=g[0],k=g[1],x=1e3,w=_createForOfIteratorHelper(Object(d.range)(x));try{for(w.s();!(v=w.n()).done;){v.value;u=[];var S,E=_createForOfIteratorHelper(Object(d.range)(t));try{for(E.s();!(S=E.n()).done;){S.value;var R,j=_createForOfIteratorHelper(Object(d.range)(x));try{for(j.s();!(R=j.n()).done;){R.value,_=(Math.random()-.5)*r+b,c=(Math.random()-.5)*i+k,m=!1;var T,C=_createForOfIteratorHelper(u);try{for(C.s();!(T=C.n()).done;){var I=l()(T.value,2);if(h=I[0],p=I[1],this.xy_distance(_,c,h,p)<o){m=!0;break}}}catch(t){C.e(t)}finally{C.f()}if(!m){u.push([_,c]);break}}}catch(t){j.e(t)}finally{j.f()}}}catch(t){E.e(t)}finally{E.f()}if(u.length===t)return u}}catch(t){w.e(t)}finally{w.f()}throw"Failed to generate random coordinates in xy_random()"}},{key:"_radians",value:function _radians(t){return t/360*2*Math.PI}},{key:"_degrees",value:function _degrees(t){return t/(2*Math.PI)*360}},{key:"_parse_pole",value:function _parse_pole(t){if(2!==t.length)throw"pole should be an array of two numeric values";var r=l()(t,2),i=r[0],o=r[1];if("number"!=typeof i||"number"!=typeof o)throw"pole should be an array of two numeric values";return[i,o]}}]),JavaScriptWorkspaceAPI}()},"./src/js/osweb/classes/python_workspace.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return PythonWorkspace}));var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/helpers/classCallCheck.js"),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@babel/runtime/helpers/createClass.js"),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),lodash_isBoolean__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/lodash/isBoolean.js"),lodash_isBoolean__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(lodash_isBoolean__WEBPACK_IMPORTED_MODULE_2__),PythonWorkspace=function(){function PythonWorkspace(t){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,PythonWorkspace),this._runner=t}return _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(PythonWorkspace,[{key:"_eval",value:function _eval(bytecode){if(lodash_isBoolean__WEBPACK_IMPORTED_MODULE_2___default()(bytecode))return bytecode;if("string"==typeof bytecode){bytecode=this._runner._syntax.eval_text(bytecode,null,!0);var evalString=this._runner._syntax.remove_quotes(bytecode);return"always"===evalString||"never"!==evalString&&eval(evalString)}return this._runner._pythonParser._run_statement(bytecode)}}]),PythonWorkspace}()},"./src/scss/osweb.scss":function(t,r,i){},0:function(t,r,i){t.exports=i("./src/app.js")},1:function(t,r){},2:function(t,r){}});
//# sourceMappingURL=osweb.1.4.13.bundle.js.map